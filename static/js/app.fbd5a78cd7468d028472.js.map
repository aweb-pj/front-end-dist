{"version":3,"sources":["webpack:///static/js/app.fbd5a78cd7468d028472.js","webpack:///./src/components/MindMap/jsmind/js/jsmind.draggable.js","webpack:///./src/components/MindMap/jsmind/js/jsmind.js","webpack:///./src/main.js","webpack:///./src/vuex/store.js","webpack:///App.vue","webpack:///Barrage.vue","webpack:///Hello.vue","webpack:///MindMap.vue","webpack:///Sidebar.vue","webpack:///./src/components/Barrage.vue?2cfd","webpack:///./src/components/Hello.vue?3df0","webpack:///./src/components/MindMap.vue?5b34","webpack:///./src/components/Sidebar.vue?14a9","webpack:///./src/components/Sidebar.vue?cc71","webpack:///./src/components/Hello.vue?a54e","webpack:///./src/App.vue?a450","webpack:///./src/components/Barrage.vue?4d52","webpack:///./src/components/MindMap.vue?c9b5","webpack:///./src/router/index.js","webpack:///./src/App.vue?fc6a"],"names":["webpackJsonp","116","module","__webpack_exports__","__webpack_require__","jsMind","$w","window","$d","document","draggable","jdom","util","dom","jcanvas","canvas","clear_selection","getSelection","removeAllRanges","selection","empty","options","line_width","lookup_delay","lookup_interval","jm","this","e_canvas","canvas_ctx","shadow","shadow_w","shadow_h","active_node","target_node","target_direct","client_w","client_h","offset_x","offset_y","hlookup_delay","hlookup_timer","capture","moved","prototype","init","_create_canvas","_create_shadow","_event_bind","resize","view","e_nodes","appendChild","width","size","w","height","h","c","createElement","e_panel","ctx","getContext","s","style","visibility","zIndex","cursor","opacity","reset_shadow","el","innerHTML","left","top","backgroundImage","backgroundSize","transform","clientWidth","clientHeight","show_shadow","hide_shadow","clear_lines","clear","_magnet_shadow","node","lineWidth","strokeStyle","lineCap","lineto","sp","x","y","np","_lookup_close_node","ns","nl","root","get_root","root_location","get_location","root_size","get_size","root_x","sw","sh","sx","offsetLeft","sy","offsetTop","direct","direction","right","nodes","mind","min_distance","Number","MAX_VALUE","distance","closest_node","closest_p","shadow_p","nodeid","isroot","id","Math","abs","result_node","lookup_close_node","node_data","jd","container","add_event","e","evt","event","dragstart","call","drag","dragend","get_editable","jview","target","srcElement","tagName","toLowerCase","get_binded_nodeid","get_node","clientX","touches","clientY","client_hw","floor","client_hh","clearTimeout","clearInterval","setTimeout","setInterval","preventDefault","px","py","src_node","move_node","inherited","sibling_nodes","children","sc","length","delta_y","node_before","beforeid","dy","jm_event_handle","type","data","event_type","draggable_plugin","plugin","add_event_listener","register_plugin","117","$","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default","n","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof__","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default","_noop","logger","console","log","debug","error","warn","info","__name__","$g","getElementById","$c","tag","$t","t","hasChildNodes","firstChild","nodeValue","createTextNode","$h","$i","nodeType","ownerDocument","String","startsWith","p","slice","DEFAULT_OPTIONS","editable","theme","mode","support_html","hmargin","vmargin","line_color","layout","hspace","vspace","pspace","default_event_handle","enable_mousedown_handle","enable_click_handle","enable_dblclick_handle","enable_contextmenu_handle","shortcut","enable","handles","mapping","addchild","addbrother","editnode","delnode","toggle","up","down","current","version","opts","json","merge","inited","event_handles","center","show","edit","select","sId","iIndex","sTopic","oData","bIsRoot","oParent","eDirection","bExpanded","index","topic","parent","expanded","_data","compare","node1","node2","i1","i2","pnode","pid","vd","abs_x","abs_y","name","author","selected","set_root","_put_node","add_node","parent_node","idx","is_node","the_parent_node","nodeindex","d","isNaN","children_len","r","i","push","_reindex","insert_node_before","the_node_before","node_index","get_node_before","the_node","insert_node_after","node_after","the_node_after","get_node_after","parentid","_move_node","_flow_node_direction","len","_move_node_internal","sibling","si","splice","remove_node","ci","k","sort","format","node_tree","example","meta","get_mind","source","df","_parse","get_data","_buildnode","node_root","_extract_data","_extract_subnode","node_json","node_parent","o","node_array","_array","narray","reverse","root_id","_extract_root","root_json","extract_count","node_direction","sub_extract_count","_array_node","freemind","xml","xml_doc","_parse_xml","xml_root","_find_root","_load_node","xmllines","_buildmap","join","DOMParser","parseFromString","ActiveXObject","async","loadXML","childNodes","parent_id","xml_node","node_id","getAttribute","node_topic","topic_children","topic_child","textContent","_load_attributes","node_expanded","node_position","child","attr","attr_data","pos","ajax","_xhr","xhr","XMLHttpRequest","_eurl","url","encodeURIComponent","request","param","method","callback","fail_callback","a","tmp_param","onreadystatechange","readyState","status","string2json","responseText","open","setRequestHeader","send","get","post","addEventListener","attachEvent","bezierto","x1","y1","x2","y2","beginPath","moveTo","bezierCurveTo","stroke","lineTo","clearRect","file","read","file_data","fn_callback","reader","FileReader","onload","result","readAsText","save","blob","Blob","BlobBuilder","MozBlobBuilder","WebKitBlobBuilder","MSBlobBuilder","bb","append","getBlob","navigator","msSaveBlob","URL","webkitURL","bloburl","createObjectURL","anchor","href","download","body","createEvent","initEvent","dispatchEvent","removeChild","location","json2string","JSON","json_str","parse","b","Object","toString","uuid","newid","Date","getTime","random","substr","text","is_empty","replace","opts_layout","opts_view","data_provider","layout_provider","view_provider","shortcut_provider","init_plugins","enable_edit","disable_edit","enable_event_handle","event_handle","disable_event_handle","set_theme","theme_old","reset_theme","reset_custom_style","mousedown_handle","click_handle","dblclick_handle","contextmenu_handle","element","select_node","select_clear","$menu","is","hide","is_expander","toggle_node","begin_edit","stopPropagation","offsetX","offsetY","reOffset","BB","getBoundingClientRect","showContextMenu","css","z-index","onscroll","onresize","selected_node","parseInt","rect","rectRight","rectBottom","edit_node_begin","end_edit","edit_node_end","save_location","relayout","restore_location","expand_node","collapse_node","expand_all","collapse_all","expand_to_depth","depth","_reset","reset","_show","m","load","invoke_event_handle","get_meta","data_format","reset_node_custom_style","afterid","update_node","is_visible","get_selected_node","is_node_visible","find_node_before","prev","ni","find_node_after","getthis","set_node_color","bgcolor","fgcolor","set_node_font_style","weight","set_node_background_image","image","rotation","set_node_background_rotation","j","_invoke_event_handle","l","mind_data","isside","bounds","cache_valid","layout_direction","layout_offset","_layout_direction_root","layout_data","children_count","side_index","_layout_direction_side","subnode","outer_height","left_nodes","right_nodes","unshift","outer_height_left","_layout_offset_subnodes","outer_height_right","max","total_height","nodes_count","node_outer_height","base_y","pd","set_visible","middle_height","_layout_offset_subnodes_height","get_node_offset","offset_cache","_offset_","offset_p","get_node_point","view_data","get_node_point_in","get_node_point_out","pout_cache","_pout_","get_expander_point","ex_p","ceil","get_min_size","pout","part_layout","target_depth","curr_nodes","curr_depth","root_layout_data","visible","is_expand","editing_node","e_editor","className","actualZoom","zoomStep","minZoom","maxZoom","v","keyCode","init_canvas","obj","event_name","parentElement","clear_nodes","theme_name","init_nodes","expand_size","min_size","min_width","min_height","init_nodes_size","doc_frag","createDocumentFragment","create_node_element","d_e","setAttribute","expander","_reset_node_custom_style","clear_node_custom_style","get_editing_node","is_editing","ncs","getComputedStyle","value","getPropertyValue","focus","get_view_offset","show_nodes","show_lines","zoomIn","setZoom","zoomOut","zoom","_center_root","outer_w","outer_h","_offset","scrollLeft","scrollTop","keep_center","_saved_location","node_element","p_expander","expander_text","display","backgroundColor","color","fontSize","fontWeight","fontStyle","img","Image","drawImage","scaledImageData","toDataURL","src","pin","draw_line","offset","_mapping","handler","bind","handle_addchild","handle_addbrother","handle_editnode","handle_delnode","handle_toggle","handle_up","handle_down","handle_left","handle_right","handle","enable_shortcut","disable_shortcut","kc","_jm","up_node","down_node","_handle_direction","childrencount","plugins","sender","_init_plugins","fn_init","118","defineProperty","__WEBPACK_IMPORTED_MODULE_0_vue__","__WEBPACK_IMPORTED_MODULE_1_element_ui__","__WEBPACK_IMPORTED_MODULE_1_element_ui___default","__WEBPACK_IMPORTED_MODULE_2_element_ui_lib_theme_default_index_css__","__WEBPACK_IMPORTED_MODULE_3__App__","__WEBPACK_IMPORTED_MODULE_3__App___default","__WEBPACK_IMPORTED_MODULE_4__router__","config","productionTip","use","router","template","components","App","119","_mutations","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default","__WEBPACK_IMPORTED_MODULE_1_vue__","__WEBPACK_IMPORTED_MODULE_2_vuex__","__WEBPACK_IMPORTED_MODULE_3_socket_io_client__","__WEBPACK_IMPORTED_MODULE_3_socket_io_client___default","socket","state","username","connection_status","login_toggle","is_logged_in","localStorage","getItem","login_pending","token","account","message_history","mutations","TOGGLE_LOGIN_BOX","CHANGE_CONNECTION_STATUS","message","click","clicks","bg_color","actions","connect","_ref","commit","on","login","_ref2","_ref3","password","emit","setItem","logout","_ref4","removeItem","send_message","_ref5","content","complete_message","click_plus","_ref6","Store","getters","strict","120","__WEBPACK_IMPORTED_MODULE_0__vuex_store__","store","121","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default","__WEBPACK_IMPORTED_MODULE_1_vuex__","message_content","computed","methods","trim","$store","dispatch","clickPlusOne","mounted","122","msg","123","__WEBPACK_IMPORTED_MODULE_0__MindMap_jsmind_style_jsmind_css__","__WEBPACK_IMPORTED_MODULE_1__MindMap_jsmind_js_jsmind_js__","__WEBPACK_IMPORTED_MODULE_2__MindMap_jsmind_js_jsmind_draggable_js__","__WEBPACK_IMPORTED_MODULE_3__Sidebar_vue__","__WEBPACK_IMPORTED_MODULE_3__Sidebar_vue___default","__WEBPACK_IMPORTED_MODULE_4__Barrage_vue__","__WEBPACK_IMPORTED_MODULE_4__Barrage_vue___default","teacherList","studentList","Sidebar","Barrage","sidebarShow","isTeacher","that","124","195","exports","196","197","198","199","200","214","Component","215","216","217","218","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","default-active","slot","_v","title","staticRenderFns","219","_s","_m","220","221","_l","$event","action","directives","rawName","expression","placeholder","rows","domProps","keydown","_k","keyup","input","composing","222","span","227","88","__WEBPACK_IMPORTED_MODULE_1_vue_router__","__WEBPACK_IMPORTED_MODULE_2__components_Hello__","__WEBPACK_IMPORTED_MODULE_2__components_Hello___default","__WEBPACK_IMPORTED_MODULE_3__components_MindMap__","__WEBPACK_IMPORTED_MODULE_3__components_MindMap___default","routes","path","component","90","91"],"mappings":"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","file":"static/js/app.fbd5a78cd7468d028472.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ 116:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (function (jsMind) {\n    'use strict';\n\n    var $w = window;\n\n    var $d = $w.document;\n    var __name__ = 'jsMind';\n\n    if (!jsMind) {\n        return;\n    }\n    if (typeof jsMind.draggable != 'undefined') {\n        return;\n    }\n\n    var jdom = jsMind.util.dom;\n    var jcanvas = jsMind.util.canvas;\n\n    var clear_selection = 'getSelection' in $w ? function () {\n        $w.getSelection().removeAllRanges();\n    } : function () {\n        $d.selection.empty();\n    };\n\n    var options = {\n        line_width: 5,\n        lookup_delay: 500,\n        lookup_interval: 80\n    };\n\n    jsMind.draggable = function (jm) {\n        this.jm = jm;\n        this.e_canvas = null;\n        this.canvas_ctx = null;\n        this.shadow = null;\n        this.shadow_w = 0;\n        this.shadow_h = 0;\n        this.active_node = null;\n        this.target_node = null;\n        this.target_direct = null;\n        this.client_w = 0;\n        this.client_h = 0;\n        this.offset_x = 0;\n        this.offset_y = 0;\n        this.hlookup_delay = 0;\n        this.hlookup_timer = 0;\n        this.capture = false;\n        this.moved = false;\n    };\n\n    jsMind.draggable.prototype = {\n        init: function init() {\n            this._create_canvas();\n            this._create_shadow();\n            this._event_bind();\n        },\n\n        resize: function resize() {\n            this.jm.view.e_nodes.appendChild(this.shadow);\n            this.e_canvas.width = this.jm.view.size.w;\n            this.e_canvas.height = this.jm.view.size.h;\n        },\n\n        _create_canvas: function _create_canvas() {\n            var c = $d.createElement('canvas');\n            this.jm.view.e_panel.appendChild(c);\n            var ctx = c.getContext('2d');\n            this.e_canvas = c;\n            this.canvas_ctx = ctx;\n        },\n\n        _create_shadow: function _create_shadow() {\n            var s = $d.createElement('jmnode');\n            s.style.visibility = 'hidden';\n            s.style.zIndex = '3';\n            s.style.cursor = 'move';\n            s.style.opacity = '0.7';\n            this.shadow = s;\n        },\n\n        reset_shadow: function reset_shadow(el) {\n            var s = this.shadow.style;\n            this.shadow.innerHTML = el.innerHTML;\n            s.left = el.style.left;\n            s.top = el.style.top;\n            s.width = el.style.width;\n            s.height = el.style.height;\n            s.backgroundImage = el.style.backgroundImage;\n            s.backgroundSize = el.style.backgroundSize;\n            s.transform = el.style.transform;\n            this.shadow_w = this.shadow.clientWidth;\n            this.shadow_h = this.shadow.clientHeight;\n        },\n\n        show_shadow: function show_shadow() {\n            if (!this.moved) {\n                this.shadow.style.visibility = 'visible';\n            }\n        },\n\n        hide_shadow: function hide_shadow() {\n            this.shadow.style.visibility = 'hidden';\n        },\n\n        clear_lines: function clear_lines() {\n            jcanvas.clear(this.canvas_ctx, 0, 0, this.jm.view.size.w, this.jm.view.size.h);\n        },\n\n        _magnet_shadow: function _magnet_shadow(node) {\n            if (!!node) {\n                this.canvas_ctx.lineWidth = options.line_width;\n                this.canvas_ctx.strokeStyle = 'rgba(0,0,0,0.3)';\n                this.canvas_ctx.lineCap = 'round';\n                this.clear_lines();\n                jcanvas.lineto(this.canvas_ctx, node.sp.x, node.sp.y, node.np.x, node.np.y);\n            }\n        },\n\n        _lookup_close_node: function _lookup_close_node() {\n            var root = this.jm.get_root();\n            var root_location = root.get_location();\n            var root_size = root.get_size();\n            var root_x = root_location.x + root_size.w / 2;\n\n            var sw = this.shadow_w;\n            var sh = this.shadow_h;\n            var sx = this.shadow.offsetLeft;\n            var sy = this.shadow.offsetTop;\n\n            var ns, nl;\n\n            var direct = sx + sw / 2 >= root_x ? jsMind.direction.right : jsMind.direction.left;\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var min_distance = Number.MAX_VALUE;\n            var distance = 0;\n            var closest_node = null;\n            var closest_p = null;\n            var shadow_p = null;\n            for (var nodeid in nodes) {\n                var np, sp;\n                node = nodes[nodeid];\n                if (node.isroot || node.direction == direct) {\n                    if (node.id == this.active_node.id) {\n                        continue;\n                    }\n                    ns = node.get_size();\n                    nl = node.get_location();\n                    if (direct == jsMind.direction.right) {\n                        if (sx - nl.x - ns.w <= 0) {\n                            continue;\n                        }\n                        distance = Math.abs(sx - nl.x - ns.w) + Math.abs(sy + sh / 2 - nl.y - ns.h / 2);\n                        np = { x: nl.x + ns.w - options.line_width, y: nl.y + ns.h / 2 };\n                        sp = { x: sx + options.line_width, y: sy + sh / 2 };\n                    } else {\n                        if (nl.x - sx - sw <= 0) {\n                            continue;\n                        }\n                        distance = Math.abs(sx + sw - nl.x) + Math.abs(sy + sh / 2 - nl.y - ns.h / 2);\n                        np = { x: nl.x + options.line_width, y: nl.y + ns.h / 2 };\n                        sp = { x: sx + sw - options.line_width, y: sy + sh / 2 };\n                    }\n                    if (distance < min_distance) {\n                        closest_node = node;\n                        closest_p = np;\n                        shadow_p = sp;\n                        min_distance = distance;\n                    }\n                }\n            }\n            var result_node = null;\n            if (!!closest_node) {\n                result_node = {\n                    node: closest_node,\n                    direction: direct,\n                    sp: shadow_p,\n                    np: closest_p\n                };\n            }\n            return result_node;\n        },\n\n        lookup_close_node: function lookup_close_node() {\n            var node_data = this._lookup_close_node();\n            if (!!node_data) {\n                this._magnet_shadow(node_data);\n                this.target_node = node_data.node;\n                this.target_direct = node_data.direction;\n            }\n        },\n\n        _event_bind: function _event_bind() {\n            var jd = this;\n            var container = this.jm.view.container;\n            jdom.add_event(container, 'mousedown', function (e) {\n                var evt = e || event;\n                jd.dragstart.call(jd, evt);\n            });\n            jdom.add_event(container, 'mousemove', function (e) {\n                var evt = e || event;\n                jd.drag.call(jd, evt);\n            });\n            jdom.add_event(container, 'mouseup', function (e) {\n                var evt = e || event;\n                jd.dragend.call(jd, evt);\n            });\n            jdom.add_event(container, 'touchstart', function (e) {\n                var evt = e || event;\n                jd.dragstart.call(jd, evt);\n            });\n            jdom.add_event(container, 'touchmove', function (e) {\n                var evt = e || event;\n                jd.drag.call(jd, evt);\n            });\n            jdom.add_event(container, 'touchend', function (e) {\n                var evt = e || event;\n                jd.dragend.call(jd, evt);\n            });\n        },\n\n        dragstart: function dragstart(e) {\n            if (!this.jm.get_editable()) {\n                return;\n            }\n            if (this.capture) {\n                return;\n            }\n            this.active_node = null;\n\n            var jview = this.jm.view;\n            var el = e.target || event.srcElement;\n            if (el.tagName.toLowerCase() != 'jmnode') {\n                return;\n            }\n            var nodeid = jview.get_binded_nodeid(el);\n            if (!!nodeid) {\n                var node = this.jm.get_node(nodeid);\n                if (!node.isroot) {\n                    this.reset_shadow(el);\n                    this.active_node = node;\n                    this.offset_x = (e.clientX || e.touches[0].clientX) - el.offsetLeft;\n                    this.offset_y = (e.clientY || e.touches[0].clientY) - el.offsetTop;\n                    this.client_hw = Math.floor(el.clientWidth / 2);\n                    this.client_hh = Math.floor(el.clientHeight / 2);\n                    if (this.hlookup_delay != 0) {\n                        $w.clearTimeout(this.hlookup_delay);\n                    }\n                    if (this.hlookup_timer != 0) {\n                        $w.clearInterval(this.hlookup_timer);\n                    }\n                    var jd = this;\n                    this.hlookup_delay = $w.setTimeout(function () {\n                        jd.hlookup_delay = 0;\n                        jd.hlookup_timer = $w.setInterval(function () {\n                            jd.lookup_close_node.call(jd);\n                        }, options.lookup_interval);\n                    }, options.lookup_delay);\n                    this.capture = true;\n                }\n            }\n        },\n\n        drag: function drag(e) {\n            if (!this.jm.get_editable()) {\n                return;\n            }\n            if (this.capture) {\n                e.preventDefault();\n                this.show_shadow();\n                this.moved = true;\n                clear_selection();\n                var px = (e.clientX || e.touches[0].clientX) - this.offset_x;\n                var py = (e.clientY || e.touches[0].clientY) - this.offset_y;\n                var cx = px + this.client_hw;\n                var cy = py + this.client_hh;\n                this.shadow.style.left = px + 'px';\n                this.shadow.style.top = py + 'px';\n                clear_selection();\n            }\n        },\n\n        dragend: function dragend(e) {\n            if (!this.jm.get_editable()) {\n                return;\n            }\n            if (this.capture) {\n                if (this.hlookup_delay != 0) {\n                    $w.clearTimeout(this.hlookup_delay);\n                    this.hlookup_delay = 0;\n                    this.clear_lines();\n                }\n                if (this.hlookup_timer != 0) {\n                    $w.clearInterval(this.hlookup_timer);\n                    this.hlookup_timer = 0;\n                    this.clear_lines();\n                }\n                if (this.moved) {\n                    var src_node = this.active_node;\n                    var target_node = this.target_node;\n                    var target_direct = this.target_direct;\n                    this.move_node(src_node, target_node, target_direct);\n                }\n                this.hide_shadow();\n            }\n            this.moved = false;\n            this.capture = false;\n        },\n\n        move_node: function move_node(src_node, target_node, target_direct) {\n            var shadow_h = this.shadow.offsetTop;\n            if (!!target_node && !!src_node && !jsMind.node.inherited(src_node, target_node)) {\n                var sibling_nodes = target_node.children;\n                var sc = sibling_nodes.length;\n                var node = null;\n                var delta_y = Number.MAX_VALUE;\n                var node_before = null;\n                var beforeid = '_last_';\n                while (sc--) {\n                    node = sibling_nodes[sc];\n                    if (node.direction == target_direct && node.id != src_node.id) {\n                        var dy = node.get_location().y - shadow_h;\n                        if (dy > 0 && dy < delta_y) {\n                            delta_y = dy;\n                            node_before = node;\n                            beforeid = '_first_';\n                        }\n                    }\n                }\n                if (!!node_before) {\n                    beforeid = node_before.id;\n                }\n                this.jm.move_node(src_node.id, beforeid, target_node.id, target_direct);\n            }\n            this.active_node = null;\n            this.target_node = null;\n            this.target_direct = null;\n        },\n\n        jm_event_handle: function jm_event_handle(type, data) {\n            if (type === jsMind.event_type.resize) {\n                this.resize();\n            }\n        }\n    };\n\n    var draggable_plugin = new jsMind.plugin('draggable', function (jm) {\n        var jd = new jsMind.draggable(jm);\n        jd.init();\n        jm.add_event_listener(function (type, data) {\n            jd.jm_event_handle.call(jd, type, data);\n        });\n    });\n\n    jsMind.register_plugin(draggable_plugin);\n});;\n\n/***/ }),\n\n/***/ 117:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function($) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__ = __webpack_require__(125);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof__ = __webpack_require__(132);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof__);\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ((function () {\n    'use strict';\n\n    var $w = window;\n\n    var __name__ = 'jsMind';\n\n    var __version__ = '0.4.3';\n\n    var __author__ = 'hizzgdev@163.com';\n\n    var _noop = function _noop() {};\n    var logger = typeof console === 'undefined' ? {\n        log: _noop, debug: _noop, error: _noop, warn: _noop, info: _noop\n    } : console;\n\n    if (typeof $w[__name__] != 'undefined') {\n        logger.log(__name__ + ' has been already exist.');\n        return;\n    }\n\n    var $d = $w.document;\n    var $g = function $g(id) {\n        return $d.getElementById(id);\n    };\n    var $c = function $c(tag) {\n        return $d.createElement(tag);\n    };\n    var $t = function $t(n, t) {\n        if (n.hasChildNodes()) {\n            n.firstChild.nodeValue = t;\n        } else {\n            n.appendChild($d.createTextNode(t));\n        }\n    };\n    var $h = function $h(n, t) {\n        n.innerHTML = t;\n    };\n\n    var $i = function $i(el) {\n        return !!el && (typeof el === 'undefined' ? 'undefined' : __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(el)) === 'object' && el.nodeType === 1 && __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(el.style) === 'object' && __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(el.ownerDocument) === 'object';\n    };\n    if (typeof String.prototype.startsWith != 'function') {\n        String.prototype.startsWith = function (p) {\n            return this.slice(0, p.length) === p;\n        };\n    }\n\n    var DEFAULT_OPTIONS = {\n        container: '',\n        editable: false,\n        theme: null,\n        mode: 'full',\n        support_html: true,\n\n        view: {\n            hmargin: 100,\n            vmargin: 50,\n            line_width: 2,\n            line_color: '#555'\n        },\n        layout: {\n            hspace: 30,\n            vspace: 20,\n            pspace: 13\n        },\n        default_event_handle: {\n            enable_mousedown_handle: true,\n            enable_click_handle: true,\n            enable_dblclick_handle: true,\n            enable_contextmenu_handle: true\n        },\n        shortcut: {\n            enable: true,\n            handles: {},\n            mapping: {\n                addchild: 45,\n                addbrother: 13,\n                editnode: 113,\n                delnode: 46,\n                toggle: 32,\n                left: 37,\n                up: 38,\n                right: 39,\n                down: 40 }\n        }\n    };\n\n    var jm = function jm(options) {\n        jm.current = this;\n\n        this.version = __version__;\n        var opts = {};\n        jm.util.json.merge(opts, DEFAULT_OPTIONS);\n        jm.util.json.merge(opts, options);\n\n        if (!opts.container) {\n            logger.error('the options.container should not be null or empty.');\n            return;\n        }\n        this.options = opts;\n        this.inited = false;\n        this.mind = null;\n        this.event_handles = [];\n        this.init();\n    };\n\n    jm.direction = { left: -1, center: 0, right: 1 };\n    jm.event_type = { show: 1, resize: 2, edit: 3, select: 4 };\n\n    jm.node = function (sId, iIndex, sTopic, oData, bIsRoot, oParent, eDirection, bExpanded) {\n        if (!sId) {\n            logger.error('invalid nodeid');return;\n        }\n        if (typeof iIndex != 'number') {\n            logger.error('invalid node index');return;\n        }\n        if (typeof bExpanded === 'undefined') {\n            bExpanded = true;\n        }\n        this.id = sId;\n        this.index = iIndex;\n        this.topic = sTopic;\n        this.data = oData || {};\n        this.isroot = bIsRoot;\n        this.parent = oParent;\n        this.direction = eDirection;\n        this.expanded = !!bExpanded;\n        this.children = [];\n        this._data = {};\n    };\n\n    jm.node.compare = function (node1, node2) {\n        var r = 0;\n        var i1 = node1.index;\n        var i2 = node2.index;\n        if (i1 >= 0 && i2 >= 0) {\n            r = i1 - i2;\n        } else if (i1 == -1 && i2 == -1) {\n            r = 0;\n        } else if (i1 == -1) {\n            r = 1;\n        } else if (i2 == -1) {\n            r = -1;\n        } else {\n            r = 0;\n        }\n\n        return r;\n    };\n\n    jm.node.inherited = function (pnode, node) {\n        if (!!pnode && !!node) {\n            if (pnode.id === node.id) {\n                return true;\n            }\n            if (pnode.isroot) {\n                return true;\n            }\n            var pid = pnode.id;\n            var p = node;\n            while (!p.isroot) {\n                p = p.parent;\n                if (p.id === pid) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    jm.node.prototype = {\n        get_location: function get_location() {\n            var vd = this._data.view;\n            return {\n                x: vd.abs_x,\n                y: vd.abs_y\n            };\n        },\n        get_size: function get_size() {\n            var vd = this._data.view;\n            return {\n                w: vd.width,\n                h: vd.height\n            };\n        }\n    };\n\n    jm.mind = function () {\n        this.name = null;\n        this.author = null;\n        this.version = null;\n        this.root = null;\n        this.selected = null;\n        this.nodes = {};\n    };\n\n    jm.mind.prototype = {\n        get_node: function get_node(nodeid) {\n            if (nodeid in this.nodes) {\n                return this.nodes[nodeid];\n            } else {\n                logger.warn('the node[id=' + nodeid + '] can not be found');\n                return null;\n            }\n        },\n\n        set_root: function set_root(nodeid, topic, data) {\n            if (this.root == null) {\n                this.root = new jm.node(nodeid, 0, topic, data, true);\n                this._put_node(this.root);\n            } else {\n                logger.error('root node is already exist');\n            }\n        },\n\n        add_node: function add_node(parent_node, nodeid, topic, data, idx, direction, expanded) {\n            if (!jm.util.is_node(parent_node)) {\n                var the_parent_node = this.get_node(parent_node);\n                if (!the_parent_node) {\n                    logger.error('the parent_node[id=' + parent_node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.add_node(the_parent_node, nodeid, topic, data, idx, direction, expanded);\n                }\n            }\n            var nodeindex = idx || -1;\n            var node = null;\n            if (parent_node.isroot) {\n                var d = jm.direction.right;\n                if (isNaN(direction)) {\n                    var children = parent_node.children;\n                    var children_len = children.length;\n                    var r = 0;\n                    for (var i = 0; i < children_len; i++) {\n                        if (children[i].direction === jm.direction.left) {\n                            r--;\n                        } else {\n                            r++;\n                        }\n                    }\n                    d = children_len > 1 && r > 0 ? jm.direction.left : jm.direction.right;\n                } else {\n                    d = direction != jm.direction.left ? jm.direction.right : jm.direction.left;\n                }\n                node = new jm.node(nodeid, nodeindex, topic, data, false, parent_node, d, expanded);\n            } else {\n                node = new jm.node(nodeid, nodeindex, topic, data, false, parent_node, parent_node.direction, expanded);\n            }\n            if (this._put_node(node)) {\n                parent_node.children.push(node);\n                this._reindex(parent_node);\n            } else {\n                logger.error('fail, the nodeid \\'' + node.id + '\\' has been already exist.');\n                node = null;\n            }\n            return node;\n        },\n\n        insert_node_before: function insert_node_before(node_before, nodeid, topic, data) {\n            if (!jm.util.is_node(node_before)) {\n                var the_node_before = this.get_node(node_before);\n                if (!the_node_before) {\n                    logger.error('the node_before[id=' + node_before + '] can not be found.');\n                    return null;\n                } else {\n                    return this.insert_node_before(the_node_before, nodeid, topic, data);\n                }\n            }\n            var node_index = node_before.index - 0.5;\n            return this.add_node(node_before.parent, nodeid, topic, data, node_index);\n        },\n\n        get_node_before: function get_node_before(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_before(the_node);\n                }\n            }\n            if (node.isroot) {\n                return null;\n            }\n            var idx = node.index - 2;\n            if (idx >= 0) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        insert_node_after: function insert_node_after(node_after, nodeid, topic, data) {\n            if (!jm.util.is_node(node_after)) {\n                var the_node_after = this.get_node(node_before);\n                if (!the_node_after) {\n                    logger.error('the node_after[id=' + node_after + '] can not be found.');\n                    return null;\n                } else {\n                    return this.insert_node_after(the_node_after, nodeid, topic, data);\n                }\n            }\n            var node_index = node_after.index + 0.5;\n            return this.add_node(node_after.parent, nodeid, topic, data, node_index);\n        },\n\n        get_node_after: function get_node_after(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_after(the_node);\n                }\n            }\n            if (node.isroot) {\n                return null;\n            }\n            var idx = node.index;\n            var brothers = node.parent.children;\n            if (brothers.length >= idx) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        move_node: function move_node(node, beforeid, parentid, direction) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.move_node(the_node, beforeid, parentid, direction);\n                }\n            }\n            if (!parentid) {\n                parentid = node.parent.id;\n            }\n            return this._move_node(node, beforeid, parentid, direction);\n        },\n\n        _flow_node_direction: function _flow_node_direction(node, direction) {\n            if (typeof direction === 'undefined') {\n                direction = node.direction;\n            } else {\n                node.direction = direction;\n            }\n            var len = node.children.length;\n            while (len--) {\n                this._flow_node_direction(node.children[len], direction);\n            }\n        },\n\n        _move_node_internal: function _move_node_internal(node, beforeid) {\n            if (!!node && !!beforeid) {\n                if (beforeid == '_last_') {\n                    node.index = -1;\n                    this._reindex(node.parent);\n                } else if (beforeid == '_first_') {\n                    node.index = 0;\n                    this._reindex(node.parent);\n                } else {\n                    var node_before = !!beforeid ? this.get_node(beforeid) : null;\n                    if (node_before != null && node_before.parent != null && node_before.parent.id == node.parent.id) {\n                        node.index = node_before.index - 0.5;\n                        this._reindex(node.parent);\n                    }\n                }\n            }\n            return node;\n        },\n\n        _move_node: function _move_node(node, beforeid, parentid, direction) {\n            if (!!node && !!parentid) {\n                if (node.parent.id != parentid) {\n                    var sibling = node.parent.children;\n                    var si = sibling.length;\n                    while (si--) {\n                        if (sibling[si].id == node.id) {\n                            sibling.splice(si, 1);\n                            break;\n                        }\n                    }\n                    node.parent = this.get_node(parentid);\n                    node.parent.children.push(node);\n                }\n\n                if (node.parent.isroot) {\n                    if (direction == jm.direction.left) {\n                        node.direction = direction;\n                    } else {\n                        node.direction = jm.direction.right;\n                    }\n                } else {\n                    node.direction = node.parent.direction;\n                }\n                this._move_node_internal(node, beforeid);\n                this._flow_node_direction(node);\n            }\n            return node;\n        },\n\n        remove_node: function remove_node(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.remove_node(the_node);\n                }\n            }\n            if (!node) {\n                logger.error('fail, the node can not be found');\n                return false;\n            }\n            if (node.isroot) {\n                logger.error('fail, can not remove root node');\n                return false;\n            }\n            if (this.selected != null && this.selected.id == node.id) {\n                this.selected = null;\n            }\n\n            var children = node.children;\n            var ci = children.length;\n            while (ci--) {\n                this.remove_node(children[ci]);\n            }\n\n            children.length = 0;\n\n            var sibling = node.parent.children;\n            var si = sibling.length;\n            while (si--) {\n                if (sibling[si].id == node.id) {\n                    sibling.splice(si, 1);\n                    break;\n                }\n            }\n\n            delete this.nodes[node.id];\n\n            for (var k in node) {\n                delete node[k];\n            }\n\n            node = null;\n\n            return true;\n        },\n\n        _put_node: function _put_node(node) {\n            if (node.id in this.nodes) {\n                logger.warn('the nodeid \\'' + node.id + '\\' has been already exist.');\n                return false;\n            } else {\n                this.nodes[node.id] = node;\n                return true;\n            }\n        },\n\n        _reindex: function _reindex(node) {\n            if (node instanceof jm.node) {\n                node.children.sort(jm.node.compare);\n                for (var i = 0; i < node.children.length; i++) {\n                    node.children[i].index = i + 1;\n                }\n            }\n        }\n    };\n\n    jm.format = {\n        node_tree: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_tree\",\n                \"data\": { \"id\": \"root\", \"topic\": \"jsMind Example\" }\n            },\n            get_mind: function get_mind(source) {\n                var df = jm.format.node_tree;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n            get_data: function get_data(mind) {\n                var df = jm.format.node_tree;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_tree';\n                json.data = df._buildnode(mind.root);\n                return json;\n            },\n\n            _parse: function _parse(mind, node_root) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_root);\n                mind.set_root(node_root.id, node_root.topic, data);\n                if ('children' in node_root) {\n                    var children = node_root.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, mind.root, children[i]);\n                    }\n                }\n            },\n\n            _extract_data: function _extract_data(node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'children' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _extract_subnode: function _extract_subnode(mind, node_parent, node_json) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_json);\n                var d = null;\n                if (node_parent.isroot) {\n                    d = node_json.direction == 'left' ? jm.direction.left : jm.direction.right;\n                }\n                var node = mind.add_node(node_parent, node_json.id, node_json.topic, data, null, d, node_json.expanded);\n                if ('children' in node_json) {\n                    var children = node_json.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, node, children[i]);\n                    }\n                }\n            },\n\n            _buildnode: function _buildnode(node) {\n                var df = jm.format.node_tree;\n                if (!(node instanceof jm.node)) {\n                    return;\n                }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                var children = node.children;\n                if (children.length > 0) {\n                    o.children = [];\n                    for (var i = 0; i < children.length; i++) {\n                        o.children.push(df._buildnode(children[i]));\n                    }\n                }\n                return o;\n            }\n        },\n\n        node_array: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_array\",\n                \"data\": [{ \"id\": \"root\", \"topic\": \"jsMind Example\", \"isroot\": true }]\n            },\n\n            get_mind: function get_mind(source) {\n                var df = jm.format.node_array;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n\n            get_data: function get_data(mind) {\n                var df = jm.format.node_array;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_array';\n                json.data = [];\n                df._array(mind, json.data);\n                return json;\n            },\n\n            _parse: function _parse(mind, node_array) {\n                var df = jm.format.node_array;\n                var narray = node_array.slice(0);\n\n                narray.reverse();\n                var root_id = df._extract_root(mind, narray);\n                if (!!root_id) {\n                    df._extract_subnode(mind, root_id, narray);\n                } else {\n                    logger.error('root node can not be found');\n                }\n            },\n\n            _extract_root: function _extract_root(mind, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                while (i--) {\n                    if ('isroot' in node_array[i] && node_array[i].isroot) {\n                        var root_json = node_array[i];\n                        var data = df._extract_data(root_json);\n                        mind.set_root(root_json.id, root_json.topic, data);\n                        node_array.splice(i, 1);\n                        return root_json.id;\n                    }\n                }\n                return null;\n            },\n\n            _extract_subnode: function _extract_subnode(mind, parentid, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                var node_json = null;\n                var data = null;\n                var extract_count = 0;\n                while (i--) {\n                    node_json = node_array[i];\n                    if (node_json.parentid == parentid) {\n                        data = df._extract_data(node_json);\n                        var d = null;\n                        var node_direction = node_json.direction;\n                        if (!!node_direction) {\n                            d = node_direction == 'left' ? jm.direction.left : jm.direction.right;\n                        }\n                        mind.add_node(parentid, node_json.id, node_json.topic, data, null, d, node_json.expanded);\n                        node_array.splice(i, 1);\n                        extract_count++;\n                        var sub_extract_count = df._extract_subnode(mind, node_json.id, node_array);\n                        if (sub_extract_count > 0) {\n                            i = node_array.length;\n                            extract_count += sub_extract_count;\n                        }\n                    }\n                }\n                return extract_count;\n            },\n\n            _extract_data: function _extract_data(node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'parentid' || k == 'isroot' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _array: function _array(mind, node_array) {\n                var df = jm.format.node_array;\n                df._array_node(mind.root, node_array);\n            },\n\n            _array_node: function _array_node(node, node_array) {\n                var df = jm.format.node_array;\n                if (!(node instanceof jm.node)) {\n                    return;\n                }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent) {\n                    o.parentid = node.parent.id;\n                }\n                if (node.isroot) {\n                    o.isroot = true;\n                }\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                node_array.push(o);\n                var ci = node.children.length;\n                for (var i = 0; i < ci; i++) {\n                    df._array_node(node.children[i], node_array);\n                }\n            }\n        },\n\n        freemind: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"freemind\",\n                \"data\": \"<map version=\\\"1.0.1\\\"><node ID=\\\"root\\\" TEXT=\\\"freemind Example\\\"/></map>\"\n            },\n            get_mind: function get_mind(source) {\n                var df = jm.format.freemind;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                var xml = source.data;\n                var xml_doc = df._parse_xml(xml);\n                var xml_root = df._find_root(xml_doc);\n                df._load_node(mind, null, xml_root);\n                return mind;\n            },\n\n            get_data: function get_data(mind) {\n                var df = jm.format.freemind;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'freemind';\n                var xmllines = [];\n                xmllines.push('<map version=\\\"1.0.1\\\">');\n                df._buildmap(mind.root, xmllines);\n                xmllines.push('</map>');\n                json.data = xmllines.join(' ');\n                return json;\n            },\n\n            _parse_xml: function _parse_xml(xml) {\n                var xml_doc = null;\n                if (window.DOMParser) {\n                    var parser = new DOMParser();\n                    xml_doc = parser.parseFromString(xml, 'text/xml');\n                } else {\n                    xml_doc = new ActiveXObject('Microsoft.XMLDOM');\n                    xml_doc.async = false;\n                    xml_doc.loadXML(xml);\n                }\n                return xml_doc;\n            },\n\n            _find_root: function _find_root(xml_doc) {\n                var nodes = xml_doc.childNodes;\n                var node = null;\n                var root = null;\n                var n = null;\n                for (var i = 0; i < nodes.length; i++) {\n                    n = nodes[i];\n                    if (n.nodeType == 1 && n.tagName == 'map') {\n                        node = n;\n                        break;\n                    }\n                }\n                if (!!node) {\n                    var ns = node.childNodes;\n                    node = null;\n                    for (var i = 0; i < ns.length; i++) {\n                        n = ns[i];\n                        if (n.nodeType == 1 && n.tagName == 'node') {\n                            node = n;\n                            break;\n                        }\n                    }\n                }\n                return node;\n            },\n\n            _load_node: function _load_node(mind, parent_id, xml_node) {\n                var df = jm.format.freemind;\n                var node_id = xml_node.getAttribute('ID');\n                var node_topic = xml_node.getAttribute('TEXT');\n\n                if (node_topic == null) {\n                    var topic_children = xml_node.childNodes;\n                    var topic_child = null;\n                    for (var i = 0; i < topic_children.length; i++) {\n                        topic_child = topic_children[i];\n\n                        if (topic_child.nodeType == 1 && topic_child.tagName === 'richcontent') {\n                            node_topic = topic_child.textContent;\n                            break;\n                        }\n                    }\n                }\n                var node_data = df._load_attributes(xml_node);\n                var node_expanded = 'expanded' in node_data ? node_data.expanded == 'true' : true;\n                delete node_data.expanded;\n\n                var node_position = xml_node.getAttribute('POSITION');\n                var node_direction = null;\n                if (!!node_position) {\n                    node_direction = node_position == 'left' ? jm.direction.left : jm.direction.right;\n                }\n\n                if (!!parent_id) {\n                    mind.add_node(parent_id, node_id, node_topic, node_data, null, node_direction, node_expanded);\n                } else {\n                    mind.set_root(node_id, node_topic, node_data);\n                }\n                var children = xml_node.childNodes;\n                var child = null;\n                for (var i = 0; i < children.length; i++) {\n                    child = children[i];\n                    if (child.nodeType == 1 && child.tagName == 'node') {\n                        df._load_node(mind, node_id, child);\n                    }\n                }\n            },\n\n            _load_attributes: function _load_attributes(xml_node) {\n                var children = xml_node.childNodes;\n                var attr = null;\n                var attr_data = {};\n                for (var i = 0; i < children.length; i++) {\n                    attr = children[i];\n                    if (attr.nodeType == 1 && attr.tagName === 'attribute') {\n                        attr_data[attr.getAttribute('NAME')] = attr.getAttribute('VALUE');\n                    }\n                }\n                return attr_data;\n            },\n\n            _buildmap: function _buildmap(node, xmllines) {\n                var df = jm.format.freemind;\n                var pos = null;\n                if (!!node.parent && node.parent.isroot) {\n                    pos = node.direction === jm.direction.left ? 'left' : 'right';\n                }\n                xmllines.push('<node');\n                xmllines.push('ID=\\\"' + node.id + '\\\"');\n                if (!!pos) {\n                    xmllines.push('POSITION=\\\"' + pos + '\\\"');\n                }\n                xmllines.push('TEXT=\\\"' + node.topic + '\\\">');\n\n                xmllines.push('<attribute NAME=\\\"expanded\\\" VALUE=\\\"' + node.expanded + '\\\"/>');\n\n                var node_data = node.data;\n                if (node_data != null) {\n                    for (var k in node_data) {\n                        xmllines.push('<attribute NAME=\\\"' + k + '\\\" VALUE=\\\"' + node_data[k] + '\\\"/>');\n                    }\n                }\n\n                var children = node.children;\n                for (var i = 0; i < children.length; i++) {\n                    df._buildmap(children[i], xmllines);\n                }\n\n                xmllines.push('</node>');\n            }\n        }\n    };\n\n    jm.util = {\n        is_node: function is_node(node) {\n            return !!node && node instanceof jm.node;\n        },\n        ajax: {\n            _xhr: function _xhr() {\n                var xhr = null;\n                if (window.XMLHttpRequest) {\n                    xhr = new XMLHttpRequest();\n                } else {\n                    try {\n                        xhr = new ActiveXObject('Microsoft.XMLHTTP');\n                    } catch (e) {}\n                }\n                return xhr;\n            },\n            _eurl: function _eurl(url) {\n                return encodeURIComponent(url);\n            },\n            request: function request(url, param, method, callback, fail_callback) {\n                var a = jm.util.ajax;\n                var p = null;\n                var tmp_param = [];\n                for (var k in param) {\n                    tmp_param.push(a._eurl(k) + '=' + a._eurl(param[k]));\n                }\n                if (tmp_param.length > 0) {\n                    p = tmp_param.join('&');\n                }\n                var xhr = a._xhr();\n                if (!xhr) {\n                    return;\n                }\n                xhr.onreadystatechange = function () {\n                    if (xhr.readyState == 4) {\n                        if (xhr.status == 200 || xhr.status == 0) {\n                            if (typeof callback === 'function') {\n                                var data = jm.util.json.string2json(xhr.responseText);\n                                if (data != null) {\n                                    callback(data);\n                                } else {\n                                    callback(xhr.responseText);\n                                }\n                            }\n                        } else {\n                            if (typeof fail_callback === 'function') {\n                                fail_callback(xhr);\n                            } else {\n                                logger.error('xhr request failed.', xhr);\n                            }\n                        }\n                    }\n                };\n                method = method || 'GET';\n                xhr.open(method, url, true);\n                xhr.setRequestHeader('If-Modified-Since', '0');\n                if (method == 'POST') {\n                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=utf-8');\n                    xhr.send(p);\n                } else {\n                    xhr.send();\n                }\n            },\n            get: function get(url, callback) {\n                return jm.util.ajax.request(url, {}, 'GET', callback);\n            },\n            post: function post(url, param, callback) {\n                return jm.util.ajax.request(url, param, 'POST', callback);\n            }\n        },\n\n        dom: {\n            add_event: function add_event(t, e, h) {\n                if (!!t.addEventListener) {\n                    t.addEventListener(e, h, false);\n                } else {\n                    t.attachEvent('on' + e, h);\n                }\n            }\n        },\n\n        canvas: {\n            bezierto: function bezierto(ctx, x1, y1, x2, y2) {\n                ctx.beginPath();\n                ctx.moveTo(x1, y1);\n                ctx.bezierCurveTo(x1 + (x2 - x1) * 2 / 3, y1, x1, y2, x2, y2);\n                ctx.stroke();\n            },\n            lineto: function lineto(ctx, x1, y1, x2, y2) {\n                ctx.beginPath();\n                ctx.moveTo(x1, y1);\n                ctx.lineTo(x2, y2);\n                ctx.stroke();\n            },\n            clear: function clear(ctx, x, y, w, h) {\n                ctx.clearRect(x, y, w, h);\n            }\n        },\n\n        file: {\n            read: function read(file_data, fn_callback) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    if (typeof fn_callback === 'function') {\n                        fn_callback(this.result, file_data.name);\n                    }\n                };\n                reader.readAsText(file_data);\n            },\n\n            save: function save(file_data, type, name) {\n                var blob;\n                if (typeof $w.Blob === 'function') {\n                    blob = new Blob([file_data], { type: type });\n                } else {\n                    var BlobBuilder = $w.BlobBuilder || $w.MozBlobBuilder || $w.WebKitBlobBuilder || $w.MSBlobBuilder;\n                    var bb = new BlobBuilder();\n                    bb.append(file_data);\n                    blob = bb.getBlob(type);\n                }\n                if (navigator.msSaveBlob) {\n                    navigator.msSaveBlob(blob, name);\n                } else {\n                    var URL = $w.URL || $w.webkitURL;\n                    var bloburl = URL.createObjectURL(blob);\n                    var anchor = $c('a');\n                    if ('download' in anchor) {\n                        anchor.style.visibility = 'hidden';\n                        anchor.href = bloburl;\n                        anchor.download = name;\n                        $d.body.appendChild(anchor);\n                        var evt = $d.createEvent('MouseEvents');\n                        evt.initEvent('click', true, true);\n                        anchor.dispatchEvent(evt);\n                        $d.body.removeChild(anchor);\n                    } else {\n                        location.href = bloburl;\n                    }\n                }\n            }\n        },\n\n        json: {\n            json2string: function json2string(json) {\n                if (!!JSON) {\n                    try {\n                        var json_str = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(json);\n                        return json_str;\n                    } catch (e) {\n                        logger.warn(e);\n                        logger.warn('can not convert to string');\n                        return null;\n                    }\n                }\n            },\n            string2json: function string2json(json_str) {\n                if (!!JSON) {\n                    try {\n                        var json = JSON.parse(json_str);\n                        return json;\n                    } catch (e) {\n                        logger.warn(e);\n                        logger.warn('can not parse to json');\n                        return null;\n                    }\n                }\n            },\n            merge: function merge(b, a) {\n                for (var o in a) {\n                    if (o in b) {\n                        if (__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(b[o]) === 'object' && Object.prototype.toString.call(b[o]).toLowerCase() == '[object object]' && !b[o].length) {\n                            jm.util.json.merge(b[o], a[o]);\n                        } else {\n                            b[o] = a[o];\n                        }\n                    } else {\n                        b[o] = a[o];\n                    }\n                }\n                return b;\n            }\n        },\n\n        uuid: {\n            newid: function newid() {\n                return (new Date().getTime().toString(16) + Math.random().toString(16).substr(2)).substr(2, 16);\n            }\n        },\n\n        text: {\n            is_empty: function is_empty(s) {\n                if (!s) {\n                    return true;\n                }\n                return s.replace(/\\s*/, '').length == 0;\n            }\n        }\n    };\n\n    jm.prototype = {\n        init: function init() {\n            if (this.inited) {\n                return;\n            }\n            this.inited = true;\n\n            var opts = this.options;\n\n            var opts_layout = {\n                mode: opts.mode,\n                hspace: opts.layout.hspace,\n                vspace: opts.layout.vspace,\n                pspace: opts.layout.pspace\n            };\n            var opts_view = {\n                container: opts.container,\n                support_html: opts.support_html,\n                hmargin: opts.view.hmargin,\n                vmargin: opts.view.vmargin,\n                line_width: opts.view.line_width,\n                line_color: opts.view.line_color\n            };\n\n            this.data = new jm.data_provider(this);\n            this.layout = new jm.layout_provider(this, opts_layout);\n            this.view = new jm.view_provider(this, opts_view);\n            this.shortcut = new jm.shortcut_provider(this, opts.shortcut);\n\n            this.data.init();\n            this.layout.init();\n            this.view.init();\n            this.shortcut.init();\n\n            this._event_bind();\n\n            jm.init_plugins(this);\n        },\n\n        enable_edit: function enable_edit() {\n            this.options.editable = true;\n        },\n\n        disable_edit: function disable_edit() {\n            this.options.editable = false;\n        },\n\n        enable_event_handle: function enable_event_handle(event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = true;\n        },\n\n        disable_event_handle: function disable_event_handle(event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = false;\n        },\n\n        get_editable: function get_editable() {\n            return this.options.editable;\n        },\n\n        set_theme: function set_theme(theme) {\n            var theme_old = this.options.theme;\n            this.options.theme = !!theme ? theme : null;\n            if (theme_old != this.options.theme) {\n                this.view.reset_theme();\n                this.view.reset_custom_style();\n            }\n        },\n        _event_bind: function _event_bind() {\n            this.view.add_event(this, 'mousedown', this.mousedown_handle);\n            this.view.add_event(this, 'click', this.click_handle);\n            this.view.add_event(this, 'dblclick', this.dblclick_handle);\n            this.view.add_event(this, 'contextmenu', this.contextmenu_handle);\n        },\n\n        mousedown_handle: function mousedown_handle(e) {\n            if (!this.options.default_event_handle['enable_mousedown_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var nodeid = this.view.get_binded_nodeid(element);\n            if (!!nodeid) {\n                this.select_node(nodeid);\n            } else {\n                this.select_clear();\n\n                var $menu = $('#contextMenu');\n                if ($menu.is(\":visible\")) {\n                    $menu.hide();\n                }\n            }\n        },\n\n        click_handle: function click_handle(e) {\n            if (!this.options.default_event_handle['enable_click_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var isexpander = this.view.is_expander(element);\n            if (isexpander) {\n                var nodeid = this.view.get_binded_nodeid(element);\n                if (!!nodeid) {\n                    this.toggle_node(nodeid);\n                }\n            }\n        },\n\n        dblclick_handle: function dblclick_handle(e) {\n            if (!this.options.default_event_handle['enable_dblclick_handle']) {\n                return;\n            }\n            if (this.get_editable()) {\n                var element = e.target || event.srcElement;\n                var nodeid = this.view.get_binded_nodeid(element);\n                if (!!nodeid) {\n                    this.begin_edit(nodeid);\n                }\n            }\n        },\n\n        contextmenu_handle: function contextmenu_handle(e) {\n\n            if (!this.options.default_event_handle['enable_contextmenu_handle']) {\n                return;\n            }\n\n            e.preventDefault();\n            e.stopPropagation();\n\n            var element = e.target || event.srcElement;\n            var nodeid = this.view.get_binded_nodeid(element);\n\n            var offsetX = 0;\n            var offsetY = 0;\n            var canvas = this.view.e_canvas;\n\n            if (!!nodeid) {\n\n                var reOffset = function reOffset() {\n                    var BB = canvas.getBoundingClientRect();\n                    offsetX = BB.left;\n                    offsetY = BB.top;\n                };\n\n                var showContextMenu = function showContextMenu(r, x, y) {\n                    var $menu = $('#contextMenu');\n                    if (!r) {\n                        $menu.hide();return;\n                    }\n                    $menu.show();\n\n                    $menu.css({ left: x, top: y, 'z-index': 99999 });\n                };\n\n                reOffset();\n\n                window.onscroll = function (e) {\n                    reOffset();\n                };\n                window.onresize = function (e) {\n                    reOffset();\n                };\n\n                this.select_node(nodeid);\n\n                var selected_node = this.get_node(nodeid);\n\n                var x = parseInt(e.clientX - offsetX);\n                var y = parseInt(e.clientY - offsetY);\n\n                showContextMenu();\n\n                var rect = selected_node;\n                var rectRight = rect.get_location().x + rect.get_size().w;\n                var rectBottom = rect.get_location().y + rect.get_size().h;\n\n                if (x >= rect.get_location().x && x <= rectRight && y >= rect.get_location().y && y <= rectBottom) {\n                    showContextMenu(rect, x, y);\n                }\n\n                return false;\n            } else {\n                this.select_clear();\n                $('#contextMenu').hide();\n            }\n        },\n\n        begin_edit: function begin_edit(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.begin_edit(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                this.view.edit_node_begin(node);\n            } else {\n                logger.error('fail, this mind map is not editable.');\n                return;\n            }\n        },\n\n        end_edit: function end_edit() {\n            this.view.edit_node_end();\n        },\n\n        toggle_node: function toggle_node(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.toggle_node(the_node);\n                }\n            }\n            if (node.isroot) {\n                return;\n            }\n            this.view.save_location(node);\n            this.layout.toggle_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_node: function expand_node(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.expand_node(the_node);\n                }\n            }\n            if (node.isroot) {\n                return;\n            }\n            this.view.save_location(node);\n            this.layout.expand_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        collapse_node: function collapse_node(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.collapse_node(the_node);\n                }\n            }\n            if (node.isroot) {\n                return;\n            }\n            this.view.save_location(node);\n            this.layout.collapse_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_all: function expand_all() {\n            this.layout.expand_all();\n            this.view.relayout();\n        },\n\n        collapse_all: function collapse_all() {\n            this.layout.collapse_all();\n            this.view.relayout();\n        },\n\n        expand_to_depth: function expand_to_depth(depth) {\n            this.layout.expand_to_depth(depth);\n            this.view.relayout();\n        },\n\n        _reset: function _reset() {\n            this.view.reset();\n            this.layout.reset();\n            this.data.reset();\n        },\n\n        _show: function _show(mind) {\n            var m = mind || jm.format.node_array.example;\n\n            this.mind = this.data.load(m);\n            if (!this.mind) {\n                logger.error('data.load error');\n                return;\n            } else {\n                logger.debug('data.load ok');\n            }\n\n            this.view.load();\n            logger.debug('view.load ok');\n\n            this.layout.layout();\n            logger.debug('layout.layout ok');\n\n            this.view.show(true);\n            logger.debug('view.show ok');\n\n            this.invoke_event_handle(jm.event_type.show, { data: [mind] });\n        },\n\n        show: function show(mind) {\n            this._reset();\n            this._show(mind);\n        },\n\n        get_meta: function get_meta() {\n            return {\n                name: this.mind.name,\n                author: this.mind.author,\n                version: this.mind.version\n            };\n        },\n\n        get_data: function get_data(data_format) {\n            var df = data_format || 'node_tree';\n            return this.data.get_data(df);\n        },\n\n        get_root: function get_root() {\n            return this.mind.root;\n        },\n\n        get_node: function get_node(nodeid) {\n            return this.mind.get_node(nodeid);\n        },\n\n        add_node: function add_node(parent_node, nodeid, topic, data) {\n            if (this.get_editable()) {\n                var node = this.mind.add_node(parent_node, nodeid, topic, data);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.view.reset_node_custom_style(node);\n                    this.expand_node(parent_node);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'add_node', data: [parent_node.id, nodeid, topic, data], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_before: function insert_node_before(node_before, nodeid, topic, data) {\n            if (this.get_editable()) {\n                var beforeid = jm.util.is_node(node_before) ? node_before.id : node_before;\n                var node = this.mind.insert_node_before(node_before, nodeid, topic, data);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_before', data: [beforeid, nodeid, topic, data], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_after: function insert_node_after(node_after, nodeid, topic, data) {\n            if (this.get_editable()) {\n                var afterid = jm.util.is_node(node_after) ? node_after.id : node_after;\n                var node = this.mind.insert_node_after(node_after, nodeid, topic, data);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_after', data: [afterid, nodeid, topic, data], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        remove_node: function remove_node(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.remove_node(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                if (node.isroot) {\n                    logger.error('fail, can not remove root node');\n                    return false;\n                }\n                var nodeid = node.id;\n                var parentid = node.parent.id;\n                var parent_node = this.get_node(parentid);\n                this.view.save_location(parent_node);\n                this.view.remove_node(node);\n                this.mind.remove_node(node);\n                this.layout.layout();\n                this.view.show(false);\n                this.view.restore_location(parent_node);\n                this.invoke_event_handle(jm.event_type.edit, { evt: 'remove_node', data: [nodeid], node: parentid });\n                return true;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return false;\n            }\n        },\n\n        update_node: function update_node(nodeid, topic) {\n            if (this.get_editable()) {\n                if (jm.util.text.is_empty(topic)) {\n                    logger.warn('fail, topic can not be empty');\n                    return;\n                }\n                var node = this.get_node(nodeid);\n                if (!!node) {\n                    if (node.topic === topic) {\n                        logger.info('nothing changed');\n                        this.view.update_node(node);\n                        return;\n                    }\n                    node.topic = topic;\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'update_node', data: [nodeid, topic], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        move_node: function move_node(nodeid, beforeid, parentid, direction) {\n            if (this.get_editable()) {\n                var node = this.mind.move_node(nodeid, beforeid, parentid, direction);\n                if (!!node) {\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'move_node', data: [nodeid, beforeid, parentid, direction], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        select_node: function select_node(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.select_node(the_node);\n                }\n            }\n            if (!this.layout.is_visible(node)) {\n                return;\n            }\n            this.mind.selected = node;\n            this.view.select_node(node);\n        },\n\n        get_selected_node: function get_selected_node() {\n            if (!!this.mind) {\n                return this.mind.selected;\n            } else {\n                return null;\n            }\n        },\n\n        select_clear: function select_clear() {\n            if (!!this.mind) {\n                this.mind.selected = null;\n                this.view.select_clear();\n            }\n        },\n\n        is_node_visible: function is_node_visible(node) {\n            return this.layout.is_visible(node);\n        },\n\n        find_node_before: function find_node_before(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_before(the_node);\n                }\n            }\n            if (node.isroot) {\n                return null;\n            }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var prev = null;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (node.id === ni.id) {\n                            n = prev;\n                        }\n                        prev = ni;\n                    }\n                }\n            } else {\n                n = this.mind.get_node_before(node);\n            }\n            return n;\n        },\n\n        find_node_after: function find_node_after(node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_after(the_node);\n                }\n            }\n            if (node.isroot) {\n                return null;\n            }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var getthis = false;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (getthis) {\n                            n = ni;\n                            break;\n                        }\n                        if (node.id === ni.id) {\n                            getthis = true;\n                        }\n                    }\n                }\n            } else {\n                n = this.mind.get_node_after(node);\n            }\n            return n;\n        },\n\n        set_node_color: function set_node_color(nodeid, bgcolor, fgcolor) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!bgcolor) {\n                        node.data['background-color'] = bgcolor;\n                    }\n                    if (!!fgcolor) {\n                        node.data['foreground-color'] = fgcolor;\n                    }\n                    this.view.reset_node_custom_style(node);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_font_style: function set_node_font_style(nodeid, size, weight, style) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!size) {\n                        node.data['font-size'] = size;\n                    }\n                    if (!!weight) {\n                        node.data['font-weight'] = weight;\n                    }\n                    if (!!style) {\n                        node.data['font-style'] = style;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_image: function set_node_background_image(nodeid, image, width, height, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!image) {\n                        node.data['background-image'] = image;\n                    }\n                    if (!!width) {\n                        node.data['width'] = width;\n                    }\n                    if (!!height) {\n                        node.data['height'] = height;\n                    }\n                    if (!!rotation) {\n                        node.data['background-rotation'] = rotation;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_rotation: function set_node_background_rotation(nodeid, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!node.data['background-image']) {\n                        logger.error('fail, only can change rotation angle of node with background image');\n                        return null;\n                    }\n                    node.data['background-rotation'] = rotation;\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        resize: function resize() {\n            this.view.resize();\n        },\n\n        add_event_listener: function add_event_listener(callback) {\n            if (typeof callback === 'function') {\n                this.event_handles.push(callback);\n            }\n        },\n\n        invoke_event_handle: function invoke_event_handle(type, data) {\n            var j = this;\n            $w.setTimeout(function () {\n                j._invoke_event_handle(type, data);\n            }, 0);\n        },\n\n        _invoke_event_handle: function _invoke_event_handle(type, data) {\n            var l = this.event_handles.length;\n            for (var i = 0; i < l; i++) {\n                this.event_handles[i](type, data);\n            }\n        }\n\n    };\n\n    jm.data_provider = function (jm) {\n        this.jm = jm;\n    };\n\n    jm.data_provider.prototype = {\n        init: function init() {\n            logger.debug('data.init');\n        },\n\n        reset: function reset() {\n            logger.debug('data.reset');\n        },\n\n        load: function load(mind_data) {\n            var df = null;\n            var mind = null;\n            if ((typeof mind_data === 'undefined' ? 'undefined' : __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(mind_data)) === 'object') {\n                if (!!mind_data.format) {\n                    df = mind_data.format;\n                } else {\n                    df = 'node_tree';\n                }\n            } else {\n                df = 'freemind';\n            }\n\n            if (df == 'node_array') {\n                mind = jm.format.node_array.get_mind(mind_data);\n            } else if (df == 'node_tree') {\n                mind = jm.format.node_tree.get_mind(mind_data);\n            } else if (df == 'freemind') {\n                mind = jm.format.freemind.get_mind(mind_data);\n            } else {\n                logger.warn('unsupported format');\n            }\n            return mind;\n        },\n\n        get_data: function get_data(data_format) {\n            var data = null;\n            if (data_format == 'node_array') {\n                data = jm.format.node_array.get_data(this.jm.mind);\n            } else if (data_format == 'node_tree') {\n                data = jm.format.node_tree.get_data(this.jm.mind);\n            } else if (data_format == 'freemind') {\n                data = jm.format.freemind.get_data(this.jm.mind);\n            } else {\n                logger.error('unsupported ' + data_format + ' format');\n            }\n            return data;\n        }\n    };\n\n    jm.layout_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.isside = this.opts.mode == 'side';\n        this.bounds = null;\n\n        this.cache_valid = false;\n    };\n\n    jm.layout_provider.prototype = {\n        init: function init() {\n            logger.debug('layout.init');\n        },\n        reset: function reset() {\n            logger.debug('layout.reset');\n            this.bounds = { n: 0, s: 0, w: 0, e: 0 };\n        },\n        layout: function layout() {\n            logger.debug('layout.layout');\n            this.layout_direction();\n            this.layout_offset();\n        },\n\n        layout_direction: function layout_direction() {\n            this._layout_direction_root();\n        },\n\n        _layout_direction_root: function _layout_direction_root() {\n            var node = this.jm.mind.root;\n\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n            layout_data.direction = jm.direction.center;\n            layout_data.side_index = 0;\n            if (this.isside) {\n                var i = children_count;\n                while (i--) {\n                    this._layout_direction_side(children[i], jm.direction.right, i);\n                }\n            } else {\n                var i = children_count;\n                var subnode = null;\n                while (i--) {\n                    subnode = children[i];\n                    if (subnode.direction == jm.direction.left) {\n                        this._layout_direction_side(subnode, jm.direction.left, i);\n                    } else {\n                        this._layout_direction_side(subnode, jm.direction.right, i);\n                    }\n                }\n            }\n        },\n\n        _layout_direction_side: function _layout_direction_side(node, direction, side_index) {\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n\n            layout_data.direction = direction;\n            layout_data.side_index = side_index;\n            var i = children_count;\n            while (i--) {\n                this._layout_direction_side(children[i], direction, i);\n            }\n        },\n\n        layout_offset: function layout_offset() {\n            var node = this.jm.mind.root;\n            var layout_data = node._data.layout;\n            layout_data.offset_x = 0;\n            layout_data.offset_y = 0;\n            layout_data.outer_height = 0;\n            var children = node.children;\n            var i = children.length;\n            var left_nodes = [];\n            var right_nodes = [];\n            var subnode = null;\n            while (i--) {\n                subnode = children[i];\n                if (subnode._data.layout.direction == jm.direction.right) {\n                    right_nodes.unshift(subnode);\n                } else {\n                    left_nodes.unshift(subnode);\n                }\n            }\n            layout_data.left_nodes = left_nodes;\n            layout_data.right_nodes = right_nodes;\n            layout_data.outer_height_left = this._layout_offset_subnodes(left_nodes);\n            layout_data.outer_height_right = this._layout_offset_subnodes(right_nodes);\n            this.bounds.e = node._data.view.width / 2;\n            this.bounds.w = 0 - this.bounds.e;\n\n            this.bounds.n = 0;\n            this.bounds.s = Math.max(layout_data.outer_height_left, layout_data.outer_height_right);\n        },\n\n        _layout_offset_subnodes: function _layout_offset_subnodes(nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null;\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                    this.set_visible(node.children, false);\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                layout_data.offset_x = this.opts.hspace * layout_data.direction + pd.view.width * (pd.layout.direction + layout_data.direction) / 2;\n                if (!node.parent.isroot) {\n                    layout_data.offset_x += this.opts.pspace * layout_data.direction;\n                }\n\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n            }\n            return total_height;\n        },\n\n        _layout_offset_subnodes_height: function _layout_offset_subnodes_height(nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null;\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes_height(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n            }\n            return total_height;\n        },\n\n        get_node_offset: function get_node_offset(node) {\n            var layout_data = node._data.layout;\n            var offset_cache = null;\n            if ('_offset_' in layout_data && this.cache_valid) {\n                offset_cache = layout_data._offset_;\n            } else {\n                offset_cache = { x: -1, y: -1 };\n                layout_data._offset_ = offset_cache;\n            }\n            if (offset_cache.x == -1 || offset_cache.y == -1) {\n                var x = layout_data.offset_x;\n                var y = layout_data.offset_y;\n                if (!node.isroot) {\n                    var offset_p = this.get_node_offset(node.parent);\n                    x += offset_p.x;\n                    y += offset_p.y;\n                }\n                offset_cache.x = x;\n                offset_cache.y = y;\n            }\n            return offset_cache;\n        },\n\n        get_node_point: function get_node_point(node) {\n            var view_data = node._data.view;\n            var offset_p = this.get_node_offset(node);\n\n            var p = {};\n            p.x = offset_p.x + view_data.width * (node._data.layout.direction - 1) / 2;\n            p.y = offset_p.y - view_data.height / 2;\n\n            return p;\n        },\n\n        get_node_point_in: function get_node_point_in(node) {\n            var p = this.get_node_offset(node);\n            return p;\n        },\n\n        get_node_point_out: function get_node_point_out(node) {\n            var layout_data = node._data.layout;\n            var pout_cache = null;\n            if ('_pout_' in layout_data && this.cache_valid) {\n                pout_cache = layout_data._pout_;\n            } else {\n                pout_cache = { x: -1, y: -1 };\n                layout_data._pout_ = pout_cache;\n            }\n            if (pout_cache.x == -1 || pout_cache.y == -1) {\n                if (node.isroot) {\n                    pout_cache.x = 0;\n                    pout_cache.y = 0;\n                } else {\n                    var view_data = node._data.view;\n                    var offset_p = this.get_node_offset(node);\n                    pout_cache.x = offset_p.x + (view_data.width + this.opts.pspace) * node._data.layout.direction;\n                    pout_cache.y = offset_p.y;\n                }\n            }\n            return pout_cache;\n        },\n\n        get_expander_point: function get_expander_point(node) {\n            var p = this.get_node_point_out(node);\n            var ex_p = {};\n            if (node._data.layout.direction == jm.direction.right) {\n                ex_p.x = p.x - this.opts.pspace;\n            } else {\n                ex_p.x = p.x;\n            }\n            ex_p.y = p.y - Math.ceil(this.opts.pspace / 2);\n            return ex_p;\n        },\n\n        get_min_size: function get_min_size() {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pout = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                pout = this.get_node_point_out(node);\n\n                if (pout.x > this.bounds.e) {\n                    this.bounds.e = pout.x;\n                }\n                if (pout.x < this.bounds.w) {\n                    this.bounds.w = pout.x;\n                }\n            }\n            return {\n                w: this.bounds.e - this.bounds.w,\n                h: this.bounds.s - this.bounds.n\n            };\n        },\n\n        toggle_node: function toggle_node(node) {\n            if (node.isroot) {\n                return;\n            }\n            if (node.expanded) {\n                this.collapse_node(node);\n            } else {\n                this.expand_node(node);\n            }\n        },\n\n        expand_node: function expand_node(node) {\n            node.expanded = true;\n            this.part_layout(node);\n            this.set_visible(node.children, true);\n        },\n\n        collapse_node: function collapse_node(node) {\n            node.expanded = false;\n            this.part_layout(node);\n            this.set_visible(node.children, false);\n        },\n\n        expand_all: function expand_all() {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!node.expanded) {\n                    node.expanded = true;\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        collapse_all: function collapse_all() {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (node.expanded && !node.isroot) {\n                    node.expanded = false;\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        expand_to_depth: function expand_to_depth(target_depth, curr_nodes, curr_depth) {\n            if (target_depth < 1) {\n                return;\n            }\n            var nodes = curr_nodes || this.jm.mind.root.children;\n            var depth = curr_depth || 1;\n            var i = nodes.length;\n            var node = null;\n            while (i--) {\n                node = nodes[i];\n                if (depth < target_depth) {\n                    if (!node.expanded) {\n                        this.expand_node(node);\n                    }\n                    this.expand_to_depth(target_depth, node.children, depth + 1);\n                }\n                if (depth == target_depth) {\n                    if (node.expanded) {\n                        this.collapse_node(node);\n                    }\n                }\n            }\n        },\n\n        part_layout: function part_layout(node) {\n            var root = this.jm.mind.root;\n            if (!!root) {\n                var root_layout_data = root._data.layout;\n                if (node.isroot) {\n                    root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                } else {\n                    if (node._data.layout.direction == jm.direction.right) {\n                        root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    } else {\n                        root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                    }\n                }\n                this.bounds.s = Math.max(root_layout_data.outer_height_left, root_layout_data.outer_height_right);\n                this.cache_valid = false;\n            } else {\n                logger.warn('can not found root node');\n            }\n        },\n\n        set_visible: function set_visible(nodes, visible) {\n            var i = nodes.length;\n            var node = null;\n            var layout_data = null;\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (node.expanded) {\n                    this.set_visible(node.children, visible);\n                } else {\n                    this.set_visible(node.children, false);\n                }\n                if (!node.isroot) {\n                    node._data.layout.visible = visible;\n                }\n            }\n        },\n\n        is_expand: function is_expand(node) {\n            return node.expanded;\n        },\n\n        is_visible: function is_visible(node) {\n            var layout_data = node._data.layout;\n            if ('visible' in layout_data && !layout_data.visible) {\n                return false;\n            } else {\n                return true;\n            }\n        }\n    };\n\n    jm.view_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.layout = jm.layout;\n\n        this.container = null;\n        this.e_panel = null;\n        this.e_nodes = null;\n        this.e_canvas = null;\n\n        this.canvas_ctx = null;\n        this.size = { w: 0, h: 0 };\n\n        this.selected_node = null;\n        this.editing_node = null;\n    };\n\n    jm.view_provider.prototype = {\n        init: function init() {\n            logger.debug('view.init');\n\n            this.container = $i(this.opts.container) ? this.opts.container : $g(this.opts.container);\n            if (!this.container) {\n                logger.error('the options.view.container was not be found in dom');\n                return;\n            }\n            this.e_panel = $c('div');\n            this.e_canvas = $c('canvas');\n            this.e_nodes = $c('jmnodes');\n            this.e_editor = $c('input');\n\n            this.e_panel.className = 'jsmind-inner';\n            this.e_panel.appendChild(this.e_canvas);\n            this.e_panel.appendChild(this.e_nodes);\n\n            this.e_editor.className = 'jsmind-editor';\n            this.e_editor.type = 'text';\n\n            this.actualZoom = 1;\n            this.zoomStep = 0.1;\n            this.minZoom = 0.5;\n            this.maxZoom = 2;\n\n            var v = this;\n            jm.util.dom.add_event(this.e_editor, 'keydown', function (e) {\n                var evt = e || event;\n                if (evt.keyCode == 13) {\n                    v.edit_node_end();evt.stopPropagation();\n                }\n            });\n            jm.util.dom.add_event(this.e_editor, 'blur', function (e) {\n                v.edit_node_end();\n            });\n\n            this.container.appendChild(this.e_panel);\n\n            this.init_canvas();\n        },\n\n        add_event: function add_event(obj, event_name, event_handle) {\n            jm.util.dom.add_event(this.e_nodes, event_name, function (e) {\n                var evt = e || event;\n                event_handle.call(obj, evt);\n            });\n        },\n\n        get_binded_nodeid: function get_binded_nodeid(element) {\n            if (element == null) {\n                return null;\n            }\n            var tagName = element.tagName.toLowerCase();\n            if (tagName == 'jmnodes' || tagName == 'body' || tagName == 'html') {\n                return null;\n            }\n            if (tagName == 'jmnode' || tagName == 'jmexpander') {\n                return element.getAttribute('nodeid');\n            } else {\n                return this.get_binded_nodeid(element.parentElement);\n            }\n        },\n\n        is_expander: function is_expander(element) {\n            return element.tagName.toLowerCase() == 'jmexpander';\n        },\n\n        reset: function reset() {\n            logger.debug('view.reset');\n            this.selected_node = null;\n            this.clear_lines();\n            this.clear_nodes();\n            this.reset_theme();\n        },\n\n        reset_theme: function reset_theme() {\n            var theme_name = this.jm.options.theme;\n            if (!!theme_name) {\n                this.e_nodes.className = 'theme-' + theme_name;\n            } else {\n                this.e_nodes.className = '';\n            }\n        },\n\n        reset_custom_style: function reset_custom_style() {\n            var nodes = this.jm.mind.nodes;\n            for (var nodeid in nodes) {\n                this.reset_node_custom_style(nodes[nodeid]);\n            }\n        },\n\n        load: function load() {\n            logger.debug('view.load');\n            this.init_nodes();\n        },\n\n        expand_size: function expand_size() {\n            var min_size = this.layout.get_min_size();\n            var min_width = min_size.w + this.opts.hmargin * 2;\n            var min_height = min_size.h + this.opts.vmargin * 2;\n            var client_w = this.e_panel.clientWidth;\n            var client_h = this.e_panel.clientHeight;\n            if (client_w < min_width) {\n                client_w = min_width;\n            }\n            if (client_h < min_height) {\n                client_h = min_height;\n            }\n            this.size.w = client_w;\n            this.size.h = client_h;\n        },\n\n        init_canvas: function init_canvas() {\n            var ctx = this.e_canvas.getContext('2d');\n            this.canvas_ctx = ctx;\n        },\n\n        init_nodes_size: function init_nodes_size(node) {\n            var view_data = node._data.view;\n            view_data.width = view_data.element.clientWidth;\n            view_data.height = view_data.element.clientHeight;\n        },\n\n        init_nodes: function init_nodes() {\n            var nodes = this.jm.mind.nodes;\n            var doc_frag = $d.createDocumentFragment();\n            for (var nodeid in nodes) {\n                this.create_node_element(nodes[nodeid], doc_frag);\n            }\n            this.e_nodes.appendChild(doc_frag);\n            for (var nodeid in nodes) {\n                this.init_nodes_size(nodes[nodeid]);\n            }\n        },\n\n        add_node: function add_node(node) {\n            this.create_node_element(node, this.e_nodes);\n            this.init_nodes_size(node);\n        },\n\n        create_node_element: function create_node_element(node, parent_node) {\n            var view_data = null;\n            if ('view' in node._data) {\n                view_data = node._data.view;\n            } else {\n                view_data = {};\n                node._data.view = view_data;\n            }\n\n            var d = $c('jmnode');\n            if (node.isroot) {\n                d.className = 'root';\n            } else {\n                var d_e = $c('jmexpander');\n                $t(d_e, '-');\n                d_e.setAttribute('nodeid', node.id);\n                d_e.style.visibility = 'hidden';\n                parent_node.appendChild(d_e);\n                view_data.expander = d_e;\n            }\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(d, node.topic);\n                } else {\n                    $t(d, node.topic);\n                }\n            }\n            d.setAttribute('nodeid', node.id);\n            d.style.visibility = 'hidden';\n            this._reset_node_custom_style(d, node.data);\n\n            parent_node.appendChild(d);\n            view_data.element = d;\n        },\n\n        remove_node: function remove_node(node) {\n            if (this.selected_node != null && this.selected_node.id == node.id) {\n                this.selected_node = null;\n            }\n            if (this.editing_node != null && this.editing_node.id == node.id) {\n                node._data.view.element.removeChild(this.e_editor);\n                this.editing_node = null;\n            }\n            var children = node.children;\n            var i = children.length;\n            while (i--) {\n                this.remove_node(children[i]);\n            }\n            if (node._data.view) {\n                var element = node._data.view.element;\n                var expander = node._data.view.expander;\n                this.e_nodes.removeChild(element);\n                this.e_nodes.removeChild(expander);\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n        },\n\n        update_node: function update_node(node) {\n            var view_data = node._data.view;\n            var element = view_data.element;\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(element, node.topic);\n                } else {\n                    $t(element, node.topic);\n                }\n            }\n            view_data.width = element.clientWidth;\n            view_data.height = element.clientHeight;\n        },\n\n        select_node: function select_node(node) {\n            if (!!this.selected_node) {\n                this.selected_node._data.view.element.className = this.selected_node._data.view.element.className.replace(/\\s*selected\\s*/i, '');\n                this.reset_node_custom_style(this.selected_node);\n            }\n            if (!!node) {\n                this.selected_node = node;\n                node._data.view.element.className += ' selected';\n                this.clear_node_custom_style(node);\n            }\n        },\n\n        select_clear: function select_clear() {\n            this.select_node(null);\n        },\n\n        get_editing_node: function get_editing_node() {\n            return this.editing_node;\n        },\n\n        is_editing: function is_editing() {\n            return !!this.editing_node;\n        },\n\n        edit_node_begin: function edit_node_begin(node) {\n            if (!node.topic) {\n                logger.warn(\"don't edit image nodes\");\n                return;\n            }\n            if (this.editing_node != null) {\n                this.edit_node_end();\n            }\n            this.editing_node = node;\n            var view_data = node._data.view;\n            var element = view_data.element;\n            var topic = node.topic;\n            var ncs = getComputedStyle(element);\n            this.e_editor.value = topic;\n            this.e_editor.style.width = element.clientWidth - parseInt(ncs.getPropertyValue('padding-left')) - parseInt(ncs.getPropertyValue('padding-right')) + 'px';\n            element.innerHTML = '';\n            element.appendChild(this.e_editor);\n            element.style.zIndex = 5;\n            this.e_editor.focus();\n            this.e_editor.select();\n        },\n\n        edit_node_end: function edit_node_end() {\n            if (this.editing_node != null) {\n                var node = this.editing_node;\n                this.editing_node = null;\n                var view_data = node._data.view;\n                var element = view_data.element;\n                var topic = this.e_editor.value;\n                element.style.zIndex = 'auto';\n                element.removeChild(this.e_editor);\n                if (jm.util.text.is_empty(topic) || node.topic === topic) {\n                    if (this.opts.support_html) {\n                        $h(element, node.topic);\n                    } else {\n                        $t(element, node.topic);\n                    }\n                } else {\n                    this.jm.update_node(node.id, topic);\n                }\n            }\n        },\n\n        get_view_offset: function get_view_offset() {\n            var bounds = this.layout.bounds;\n            var _x = (this.size.w - bounds.e - bounds.w) / 2;\n            var _y = this.size.h / 2;\n            return { x: _x, y: _y };\n        },\n\n        resize: function resize() {\n            this.e_canvas.width = 1;\n            this.e_canvas.height = 1;\n            this.e_nodes.style.width = '1px';\n            this.e_nodes.style.height = '1px';\n\n            this.expand_size();\n            this._show();\n        },\n\n        _show: function _show() {\n            this.e_canvas.width = this.size.w;\n            this.e_canvas.height = this.size.h;\n            this.e_nodes.style.width = this.size.w + 'px';\n            this.e_nodes.style.height = this.size.h + 'px';\n            this.show_nodes();\n            this.show_lines();\n\n            this.jm.invoke_event_handle(jm.event_type.resize, { data: [] });\n        },\n\n        zoomIn: function zoomIn() {\n            return this.setZoom(this.actualZoom + this.zoomStep);\n        },\n\n        zoomOut: function zoomOut() {\n            return this.setZoom(this.actualZoom - this.zoomStep);\n        },\n\n        setZoom: function setZoom(zoom) {\n            if (zoom < this.minZoom || zoom > this.maxZoom) {\n                return false;\n            }\n            this.actualZoom = zoom;\n            for (var i = 0; i < this.e_panel.children.length; i++) {\n                this.e_panel.children[i].style.transform = 'scale(' + zoom + ')';\n            };\n            this.show(true);\n            return true;\n        },\n\n        _center_root: function _center_root() {\n            var outer_w = this.e_panel.clientWidth;\n            var outer_h = this.e_panel.clientHeight;\n            if (this.size.w > outer_w) {\n                var _offset = this.get_view_offset();\n                this.e_panel.scrollLeft = _offset.x - outer_w / 2;\n            }\n            if (this.size.h > outer_h) {\n                this.e_panel.scrollTop = (this.size.h - outer_h) / 2;\n            }\n        },\n\n        show: function show(keep_center) {\n            logger.debug('view.show');\n            this.expand_size();\n            this._show();\n            if (!!keep_center) {\n                this._center_root();\n            }\n        },\n\n        relayout: function relayout() {\n            this.expand_size();\n            this._show();\n        },\n\n        save_location: function save_location(node) {\n            var vd = node._data.view;\n            vd._saved_location = {\n                x: parseInt(vd.element.style.left) - this.e_panel.scrollLeft,\n                y: parseInt(vd.element.style.top) - this.e_panel.scrollTop\n            };\n        },\n\n        restore_location: function restore_location(node) {\n            var vd = node._data.view;\n            this.e_panel.scrollLeft = parseInt(vd.element.style.left) - vd._saved_location.x;\n            this.e_panel.scrollTop = parseInt(vd.element.style.top) - vd._saved_location.y;\n        },\n\n        clear_nodes: function clear_nodes() {\n            var mind = this.jm.mind;\n            if (mind == null) {\n                return;\n            }\n            var nodes = mind.nodes;\n            var node = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n            this.e_nodes.innerHTML = '';\n        },\n\n        show_nodes: function show_nodes() {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var node_element = null;\n            var expander = null;\n            var p = null;\n            var p_expander = null;\n            var expander_text = '-';\n            var view_data = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                view_data = node._data.view;\n                node_element = view_data.element;\n                expander = view_data.expander;\n                if (!this.layout.is_visible(node)) {\n                    node_element.style.display = 'none';\n                    expander.style.display = 'none';\n                    continue;\n                }\n                this.reset_node_custom_style(node);\n                p = this.layout.get_node_point(node);\n                view_data.abs_x = _offset.x + p.x;\n                view_data.abs_y = _offset.y + p.y;\n                node_element.style.left = _offset.x + p.x + 'px';\n                node_element.style.top = _offset.y + p.y + 'px';\n                node_element.style.display = '';\n                node_element.style.visibility = 'visible';\n                if (!node.isroot && node.children.length > 0) {\n                    expander_text = node.expanded ? '-' : '+';\n                    p_expander = this.layout.get_expander_point(node);\n                    expander.style.left = _offset.x + p_expander.x + 'px';\n                    expander.style.top = _offset.y + p_expander.y + 'px';\n                    expander.style.display = '';\n                    expander.style.visibility = 'visible';\n                    $t(expander, expander_text);\n                }\n\n                if (!node.isroot && node.children.length == 0) {\n                    expander.style.display = 'none';\n                    expander.style.visibility = 'hidden';\n                }\n            }\n        },\n\n        reset_node_custom_style: function reset_node_custom_style(node) {\n            this._reset_node_custom_style(node._data.view.element, node.data);\n        },\n\n        _reset_node_custom_style: function _reset_node_custom_style(node_element, node_data) {\n            if ('background-color' in node_data) {\n                node_element.style.backgroundColor = node_data['background-color'];\n            }\n            if ('foreground-color' in node_data) {\n                node_element.style.color = node_data['foreground-color'];\n            }\n            if ('width' in node_data) {\n                node_element.style.width = node_data['width'] + 'px';\n            }\n            if ('height' in node_data) {\n                node_element.style.height = node_data['height'] + 'px';\n            }\n            if ('font-size' in node_data) {\n                node_element.style.fontSize = node_data['font-size'] + 'px';\n            }\n            if ('font-weight' in node_data) {\n                node_element.style.fontWeight = node_data['font-weight'];\n            }\n            if ('font-style' in node_data) {\n                node_element.style.fontStyle = node_data['font-style'];\n            }\n            if ('background-image' in node_data) {\n                var backgroundImage = node_data['background-image'];\n                if (backgroundImage.startsWith('data') && node_data['width'] && node_data['height']) {\n                    var img = new Image();\n\n                    img.onload = function () {\n                        var c = $c('canvas');\n                        c.width = node_element.clientWidth;\n                        c.height = node_element.clientHeight;\n                        var img = this;\n                        if (c.getContext) {\n                            var ctx = c.getContext('2d');\n                            ctx.drawImage(img, 2, 2, node_element.clientWidth, node_element.clientHeight);\n                            var scaledImageData = c.toDataURL();\n                            node_element.style.backgroundImage = 'url(' + scaledImageData + ')';\n                        }\n                    };\n                    img.src = backgroundImage;\n                } else {\n                    node_element.style.backgroundImage = 'url(' + backgroundImage + ')';\n                }\n                node_element.style.backgroundSize = '99%';\n\n                if ('background-rotation' in node_data) {\n                    node_element.style.transform = 'rotate(' + node_data['background-rotation'] + 'deg)';\n                }\n            }\n        },\n\n        clear_node_custom_style: function clear_node_custom_style(node) {\n            var node_element = node._data.view.element;\n            node_element.style.backgroundColor = \"\";\n            node_element.style.color = \"\";\n        },\n\n        clear_lines: function clear_lines(canvas_ctx) {\n            var ctx = canvas_ctx || this.canvas_ctx;\n            jm.util.canvas.clear(ctx, 0, 0, this.size.w, this.size.h);\n        },\n\n        show_lines: function show_lines(canvas_ctx) {\n            this.clear_lines(canvas_ctx);\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pin = null;\n            var pout = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!!node.isroot) {\n                    continue;\n                }\n                if ('visible' in node._data.layout && !node._data.layout.visible) {\n                    continue;\n                }\n                pin = this.layout.get_node_point_in(node);\n                pout = this.layout.get_node_point_out(node.parent);\n                this.draw_line(pout, pin, _offset, canvas_ctx);\n            }\n        },\n\n        draw_line: function draw_line(pin, pout, offset, canvas_ctx) {\n            var ctx = canvas_ctx || this.canvas_ctx;\n            ctx.strokeStyle = this.opts.line_color;\n            ctx.lineWidth = this.opts.line_width;\n            ctx.lineCap = 'round';\n\n            jm.util.canvas.bezierto(ctx, pin.x + offset.x, pin.y + offset.y, pout.x + offset.x, pout.y + offset.y);\n        }\n    };\n\n    jm.shortcut_provider = function (jm, options) {\n        this.jm = jm;\n        this.opts = options;\n        this.mapping = options.mapping;\n        this.handles = options.handles;\n        this._mapping = {};\n    };\n\n    jm.shortcut_provider.prototype = {\n        init: function init() {\n            jm.util.dom.add_event($d, 'keydown', this.handler.bind(this));\n\n            this.handles['addchild'] = this.handle_addchild;\n            this.handles['addbrother'] = this.handle_addbrother;\n            this.handles['editnode'] = this.handle_editnode;\n            this.handles['delnode'] = this.handle_delnode;\n            this.handles['toggle'] = this.handle_toggle;\n            this.handles['up'] = this.handle_up;\n            this.handles['down'] = this.handle_down;\n            this.handles['left'] = this.handle_left;\n            this.handles['right'] = this.handle_right;\n\n            for (var handle in this.mapping) {\n                if (!!this.mapping[handle] && handle in this.handles) {\n                    this._mapping[this.mapping[handle]] = this.handles[handle];\n                }\n            }\n        },\n\n        enable_shortcut: function enable_shortcut() {\n            this.opts.enable = true;\n        },\n\n        disable_shortcut: function disable_shortcut() {\n            this.opts.enable = false;\n        },\n\n        handler: function handler(e) {\n            if (this.jm.view.is_editing()) {\n                return;\n            }\n            var evt = e || event;\n            if (!this.opts.enable) {\n                return true;\n            }\n            var kc = evt.keyCode;\n            if (kc in this._mapping) {\n                this._mapping[kc].call(this, this.jm, e);\n            }\n        },\n\n        handle_addchild: function handle_addchild(_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var nodeid = jm.util.uuid.newid();\n                var node = _jm.add_node(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_addbrother: function handle_addbrother(_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                var nodeid = jm.util.uuid.newid();\n                var node = _jm.insert_node_after(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_editnode: function handle_editnode(_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.begin_edit(selected_node);\n            }\n        },\n        handle_delnode: function handle_delnode(_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                _jm.select_node(selected_node.parent);\n                _jm.remove_node(selected_node);\n            }\n        },\n        handle_toggle: function handle_toggle(_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.toggle_node(selected_node.id);\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n        handle_up: function handle_up(_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var up_node = _jm.find_node_before(selected_node);\n                if (!up_node) {\n                    var np = _jm.find_node_before(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        up_node = np.children[np.children.length - 1];\n                    }\n                }\n                if (!!up_node) {\n                    _jm.select_node(up_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_down: function handle_down(_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var down_node = _jm.find_node_after(selected_node);\n                if (!down_node) {\n                    var np = _jm.find_node_after(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        down_node = np.children[0];\n                    }\n                }\n                if (!!down_node) {\n                    _jm.select_node(down_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_left: function handle_left(_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.left);\n        },\n        handle_right: function handle_right(_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.right);\n        },\n        _handle_direction: function _handle_direction(_jm, e, d) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            var node = null;\n            if (!!selected_node) {\n                if (selected_node.isroot) {\n                    var c = selected_node.children;\n                    var children = [];\n                    for (var i = 0; i < c.length; i++) {\n                        if (c[i].direction === d) {\n                            children.push(i);\n                        }\n                    }\n                    node = c[children[Math.floor((children.length - 1) / 2)]];\n                } else if (selected_node.direction === d) {\n                    var children = selected_node.children;\n                    var childrencount = children.length;\n                    if (childrencount > 0) {\n                        node = children[Math.floor((childrencount - 1) / 2)];\n                    }\n                } else {\n                    node = selected_node.parent;\n                }\n                if (!!node) {\n                    _jm.select_node(node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        }\n    };\n\n    jm.plugin = function (name, init) {\n        this.name = name;\n        this.init = init;\n    };\n\n    jm.plugins = [];\n\n    jm.register_plugin = function (plugin) {\n        if (plugin instanceof jm.plugin) {\n            jm.plugins.push(plugin);\n        }\n    };\n\n    jm.init_plugins = function (sender) {\n        $w.setTimeout(function () {\n            jm._init_plugins(sender);\n        }, 0);\n    };\n\n    jm._init_plugins = function (sender) {\n        var l = jm.plugins.length;\n        var fn_init = null;\n        for (var i = 0; i < l; i++) {\n            fn_init = jm.plugins[i].init;\n            if (typeof fn_init === 'function') {\n                fn_init(sender);\n            }\n        }\n    };\n\n    jm.show = function (options, mind) {\n        var _jm = new jm(options);\n        _jm.show(mind);\n        return _jm;\n    };\n\n    return jm;\n})());\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(75)))\n\n/***/ }),\n\n/***/ 118:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_element_ui__ = __webpack_require__(89);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_element_ui___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_element_ui__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_element_ui_lib_theme_default_index_css__ = __webpack_require__(90);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_element_ui_lib_theme_default_index_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_element_ui_lib_theme_default_index_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__App__ = __webpack_require__(91);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__App___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__App__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__router__ = __webpack_require__(88);\n\n\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"default\"].config.productionTip = false;\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"default\"].use(__WEBPACK_IMPORTED_MODULE_1_element_ui___default.a);\n\nnew __WEBPACK_IMPORTED_MODULE_0_vue__[\"default\"]({\n  el: '#app',\n  router: __WEBPACK_IMPORTED_MODULE_4__router__[\"a\" /* default */],\n  template: '<App/>',\n  components: { App: __WEBPACK_IMPORTED_MODULE_3__App___default.a }\n});\n\n/***/ }),\n\n/***/ 119:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty__ = __webpack_require__(130);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vue__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_vuex__ = __webpack_require__(85);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_socket_io_client__ = __webpack_require__(205);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_socket_io_client___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_socket_io_client__);\n\n\nvar _mutations;\n\n\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_1_vue__[\"default\"].use(__WEBPACK_IMPORTED_MODULE_2_vuex__[\"a\" /* default */]);\n\nvar LOGIN = 'LOGIN';\nvar LOGIN_SUCCESS = 'LOGIN_SUCCESS';\nvar LOGOUT = 'LOGOUT';\n\nvar socket = null;\n\nvar state = {\n  username: 'test_username',\n  connection_status: false,\n  login_toggle: false,\n  is_logged_in: !!localStorage.getItem('token'),\n  login_pending: false,\n  token: '',\n  account: '',\n  message_history: []\n};\n\nvar mutations = (_mutations = {\n  TOGGLE_LOGIN_BOX: function TOGGLE_LOGIN_BOX(state, status) {\n    state.login_toggle = status;\n  },\n  CHANGE_CONNECTION_STATUS: function CHANGE_CONNECTION_STATUS(state, status) {\n    state.connection_status = status;\n  }\n}, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default()(_mutations, LOGIN, function (state) {\n  state.login_pending = true;\n}), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default()(_mutations, LOGIN_SUCCESS, function (state, username) {\n  state.is_logged_in = true;\n  state.login_pending = false;\n  state.username = username;\n}), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default()(_mutations, LOGOUT, function (state) {\n  state.is_logged_in = false;\n}), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default()(_mutations, 'PUT_MESSAGE', function PUT_MESSAGE(state, message) {\n  state.message_history.unshift(message);\n}), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default()(_mutations, 'CLICK_PLUS_ONE', function CLICK_PLUS_ONE(state, id) {\n  var index = state.message_history.length - 1 - id;\n  var click = 255 - 2 * (++state.message_history[index].clicks < 200 ? state.message_history[index].clicks : 200);\n  state.message_history[index].bg_color = 'rgb(' + click + ',' + click + ',' + click + ')';\n}), _mutations);\n\nvar actions = {\n  connect: function connect(_ref) {\n    var commit = _ref.commit,\n        state = _ref.state;\n\n    if (state.connection_status === false) {\n      socket = __WEBPACK_IMPORTED_MODULE_3_socket_io_client___default()('barrage.jtwang.me');\n      socket.on('connect', function () {\n        commit('CHANGE_CONNECTION_STATUS', true);\n      });\n    }\n\n    if (state.username === '') {\n      if (localStorage.getItem('token') !== null && localStorage.getItem('username') !== null) {\n        commit(LOGIN_SUCCESS, localStorage.getItem('username'));\n      }\n    }\n\n    socket.on('disconnect', function () {\n      commit('CHANGE_CONNECTION_STATUS', false);\n    });\n    socket.on('server_message', function (message) {\n      commit('PUT_MESSAGE', message);\n    });\n  },\n  login: function login(_ref2, _ref3) {\n    var commit = _ref2.commit;\n    var username = _ref3.username,\n        password = _ref3.password;\n\n    commit(LOGIN);\n\n    socket.emit('login', { 'username': username, 'password': password });\n    socket.on('login_success', function () {\n      localStorage.setItem('token', 'JWT');\n      localStorage.setItem('username', username);\n      commit(LOGIN_SUCCESS, username);\n    });\n  },\n  logout: function logout(_ref4) {\n    var commit = _ref4.commit;\n\n    localStorage.removeItem('token');\n    commit(LOGOUT);\n  },\n  send_message: function send_message(_ref5, content) {\n    var commit = _ref5.commit,\n        state = _ref5.state;\n\n    var index = state.message_history.length;\n    var complete_message = { id: index, content: content, clicks: 0, bg_color: 'rgb(255,255,255)' };\n    socket.emit('client_message', complete_message);\n    commit('PUT_MESSAGE', complete_message);\n  },\n  click_plus: function click_plus(_ref6, id) {\n    var commit = _ref6.commit,\n        state = _ref6.state;\n\n    commit('CLICK_PLUS_ONE', id);\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (new __WEBPACK_IMPORTED_MODULE_2_vuex__[\"a\" /* default */].Store({\n  state: state,\n  mutations: mutations,\n  actions: actions,\n  getters: {\n    connection_status: function connection_status() {\n      return state.connection_status;\n    },\n    is_logged_in: function is_logged_in() {\n      return state.is_logged_in;\n    },\n    login_pending: function login_pending() {\n      return state.login_pending;\n    },\n    username: function username() {\n      return state.username;\n    },\n    message_history: function message_history() {\n      return state.message_history;\n    }\n  },\n\n  strict: \"production\" !== 'production'\n}));\n\n/***/ }),\n\n/***/ 120:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__vuex_store__ = __webpack_require__(119);\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'app', store: __WEBPACK_IMPORTED_MODULE_0__vuex_store__[\"a\" /* default */]\n});\n\n/***/ }),\n\n/***/ 121:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__ = __webpack_require__(131);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vuex__ = __webpack_require__(85);\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'barrage',\n  data: function data() {\n    return {\n      message_content: ''\n    };\n  },\n\n  computed: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({}, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1_vuex__[\"b\" /* mapGetters */])(['message_history'])),\n\n  methods: {\n    clear: function clear() {\n      if (this.message_content.trim() === '') {\n        this.message_content = '';\n      }\n    },\n    send: function send() {\n      if (this.message_content.trim() === '') {\n        this.message_content = '';\n        return;\n      } else {\n        this.message_content = this.message_content.trim();\n        this.$store.dispatch('send_message', this.message_content);\n        this.message_content = '';\n      }\n    },\n    clickPlusOne: function clickPlusOne(id) {\n      this.$store.dispatch('click_plus', id);\n    }\n  },\n  mounted: function mounted() {\n    this.$store.dispatch('connect');\n  }\n});\n\n/***/ }),\n\n/***/ 122:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'hello',\n  data: function data() {\n    return {\n      msg: 'Welcome to Your Vue.js App'\n    };\n  }\n});\n\n/***/ }),\n\n/***/ 123:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function($) {Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__MindMap_jsmind_style_jsmind_css__ = __webpack_require__(195);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__MindMap_jsmind_style_jsmind_css___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__MindMap_jsmind_style_jsmind_css__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__MindMap_jsmind_js_jsmind_js__ = __webpack_require__(117);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__MindMap_jsmind_js_jsmind_draggable_js__ = __webpack_require__(116);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Sidebar_vue__ = __webpack_require__(217);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__Sidebar_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__Sidebar_vue__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Barrage_vue__ = __webpack_require__(214);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__Barrage_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4__Barrage_vue__);\n\n\n\n\n\n\n\n\n\nvar teacherList = ['teacher1', 'teacher2'];\nvar studentList = ['student1', 'student2', 'student3'];\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'mind-map',\n  components: {\n    Sidebar: __WEBPACK_IMPORTED_MODULE_3__Sidebar_vue___default.a,\n    Barrage: __WEBPACK_IMPORTED_MODULE_4__Barrage_vue___default.a\n  },\n  data: function data() {\n    return {\n      sidebarShow: true,\n      isTeacher: true,\n      teacherList: teacherList,\n      studentList: studentList,\n      jm: null\n    };\n  },\n  mounted: function mounted() {\n    __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2__MindMap_jsmind_js_jsmind_draggable_js__[\"a\" /* default */])(__WEBPACK_IMPORTED_MODULE_1__MindMap_jsmind_js_jsmind_js__[\"a\" /* default */]);\n\n    var mind = {\n      'meta': {\n        'name': 'jsMind-demo-tree',\n        'author': 'hizzgdev@163.com',\n        'version': '0.2'\n      },\n\n      'format': 'node_tree',\n\n      'data': { 'id': 'root',\n        'topic': 'jsMind',\n        'children': [{ 'id': 'easy',\n          'topic': 'Easy',\n          'direction': 'left',\n          'expanded': false,\n          'children': [{ 'id': 'easy1', 'topic': 'Easy to show' }, { 'id': 'easy2', 'topic': 'Easy to edit' }, { 'id': 'easy3', 'topic': 'Easy to store' }, { 'id': 'easy4', 'topic': 'Easy to embed' }] }, { 'id': 'open',\n          'topic': 'Open Source',\n          'direction': 'right',\n          'expanded': true,\n          'children': [{ 'id': 'open1', 'topic': 'on GitHub' }, { 'id': 'open2', 'topic': 'BSD License' }] }, { 'id': 'powerful',\n          'topic': 'Powerful',\n          'direction': 'right',\n          'children': [{ 'id': 'powerful1', 'topic': 'Base on Javascript' }, { 'id': 'powerful2', 'topic': 'Base on HTML5' }, { 'id': 'powerful3', 'topic': 'Depends on you' }] }, { 'id': 'other',\n          'topic': 'test node',\n          'direction': 'left',\n          'children': [{ 'id': 'other1', 'topic': \"I'm from local variable\" }, { 'id': 'other2', 'topic': 'I can do everything' }] }] }\n    };\n\n    var options = {\n      container: 'jsmind_container',\n      editable: true,\n      theme: 'orange'\n    };\n\n    var that = this;\n    that.jm = new __WEBPACK_IMPORTED_MODULE_1__MindMap_jsmind_js_jsmind_js__[\"a\" /* default */](options);\n    that.jm.show(mind);\n\n    var $menu = $('#contextMenu');\n    $menu.on('click', 'li', function (e) {\n      $menu.hide();\n      console.log('Context selection: ' + $(this).text());\n      that.sidebarShow = !that.sidebarShow;\n    });\n  }\n});\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(75)))\n\n/***/ }),\n\n/***/ 124:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  name: 'sidebar'\n});\n\n/***/ }),\n\n/***/ 195:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 196:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 197:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 198:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 199:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 200:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 214:\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(199)\n\nvar Component = __webpack_require__(17)(\n  /* script */\n  __webpack_require__(121),\n  /* template */\n  __webpack_require__(221),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 215:\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(197)\n\nvar Component = __webpack_require__(17)(\n  /* script */\n  __webpack_require__(122),\n  /* template */\n  __webpack_require__(219),\n  /* scopeId */\n  \"data-v-2cab8cad\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 216:\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(200)\n\nvar Component = __webpack_require__(17)(\n  /* script */\n  __webpack_require__(123),\n  /* template */\n  __webpack_require__(222),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 217:\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(196)\n\nvar Component = __webpack_require__(17)(\n  /* script */\n  __webpack_require__(124),\n  /* template */\n  __webpack_require__(218),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 218:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('el-menu', {\n    staticClass: \"sidebar\",\n    attrs: {\n      \"default-active\": \"2\"\n    }\n  }, [_c('el-submenu', {\n    attrs: {\n      \"index\": \"1\"\n    }\n  }, [_c('template', {\n    slot: \"title\"\n  }, [_c('i', {\n    staticClass: \"el-icon-message\"\n  }), _vm._v(\"\")]), _vm._v(\" \"), _c('el-menu-item-group', [_c('template', {\n    slot: \"title\"\n  }, [_vm._v(\"\")]), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"1-1\"\n    }\n  }, [_vm._v(\"1\")]), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"1-2\"\n    }\n  }, [_vm._v(\"2\")])], 2), _vm._v(\" \"), _c('el-menu-item-group', {\n    attrs: {\n      \"title\": \"2\"\n    }\n  }, [_c('el-menu-item', {\n    attrs: {\n      \"index\": \"1-3\"\n    }\n  }, [_vm._v(\"3\")])], 1), _vm._v(\" \"), _c('el-submenu', {\n    attrs: {\n      \"index\": \"1-4\"\n    }\n  }, [_c('template', {\n    slot: \"title\"\n  }, [_vm._v(\"4\")]), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"1-4-1\"\n    }\n  }, [_vm._v(\"1\")])], 2)], 2), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"2\"\n    }\n  }, [_c('i', {\n    staticClass: \"el-icon-menu\"\n  }), _vm._v(\"\")]), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"3\"\n    }\n  }, [_c('i', {\n    staticClass: \"el-icon-setting\"\n  }), _vm._v(\"\")])], 1)\n},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 219:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"hello\"\n  }, [_c('h1', [_vm._v(_vm._s(_vm.msg))]), _vm._v(\" \"), _c('h2', [_vm._v(\"Essential Links\")]), _vm._v(\" \"), _vm._m(0), _vm._v(\" \"), _c('h2', [_vm._v(\"Ecosystem\")]), _vm._v(\" \"), _vm._m(1)])\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', [_c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://vuejs.org\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Core Docs\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://forum.vuejs.org\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Forum\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://gitter.im/vuejs/vue\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Gitter Chat\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://twitter.com/vuejs\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Twitter\")])]), _vm._v(\" \"), _c('br'), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vuejs-templates.github.io/webpack/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Docs for This Template\")])])])\n},function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', [_c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://router.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vue-router\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vuex.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vuex\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vue-loader.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vue-loader\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://github.com/vuejs/awesome-vue\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"awesome-vue\")])])])\n}]}\n\n/***/ }),\n\n/***/ 220:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [_c('router-view')], 1)\n},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 221:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"barrage_wrapper\"\n    }\n  }, [_c('ul', {\n    attrs: {\n      \"id\": \"messages\"\n    }\n  }, _vm._l((_vm.message_history), function(message) {\n    return _c('li', {\n      style: ({\n        backgroundColor: message.bg_color\n      }),\n      on: {\n        \"click\": function($event) {\n          _vm.clickPlusOne(message.id)\n        }\n      }\n    }, [_vm._v(_vm._s(message.content))])\n  })), _vm._v(\" \"), _c('form', {\n    attrs: {\n      \"action\": \"\"\n    }\n  }, [_c('textarea', {\n    directives: [{\n      name: \"model\",\n      rawName: \"v-model\",\n      value: (_vm.message_content),\n      expression: \"message_content\"\n    }],\n    attrs: {\n      \"name\": \"message-to-send\",\n      \"id\": \"message-to-send\",\n      \"placeholder\": \"\",\n      \"rows\": \"3\"\n    },\n    domProps: {\n      \"value\": (_vm.message_content)\n    },\n    on: {\n      \"keydown\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.send($event)\n      },\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.clear($event)\n      },\n      \"input\": function($event) {\n        if ($event.target.composing) { return; }\n        _vm.message_content = $event.target.value\n      }\n    }\n  })])])\n},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 222:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('el-row', {\n    staticClass: \"tac\"\n  }, [_c('el-col', {\n    attrs: {\n      \"span\": 3\n    }\n  }, [_c('sidebar')], 1), _vm._v(\" \"), _c('el-col', {\n    attrs: {\n      \"span\": 18\n    }\n  }, [_c('div', {\n    attrs: {\n      \"id\": \"jsmind_container\"\n    }\n  })]), _vm._v(\" \"), _c('el-col', {\n    attrs: {\n      \"span\": 3\n    }\n  }, [_c('barrage')], 1)], 1)], 1)\n},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 227:\n/***/ (function(module, exports) {\n\n/* (ignored) */\n\n/***/ }),\n\n/***/ 88:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vue_router__ = __webpack_require__(223);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__components_Hello__ = __webpack_require__(215);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__components_Hello___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__components_Hello__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__components_MindMap__ = __webpack_require__(216);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__components_MindMap___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__components_MindMap__);\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"default\"].use(__WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (new __WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]({\n  routes: [{\n    path: '/',\n    name: 'Hello',\n    component: __WEBPACK_IMPORTED_MODULE_2__components_Hello___default.a\n  }, {\n    path: '/mindmap',\n    name: 'MindMap',\n    component: __WEBPACK_IMPORTED_MODULE_3__components_MindMap___default.a\n  }]\n}));\n\n/***/ }),\n\n/***/ 90:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 91:\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(198)\n\nvar Component = __webpack_require__(17)(\n  /* script */\n  __webpack_require__(120),\n  /* template */\n  __webpack_require__(220),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ })\n\n},[118]);\n\n\n// WEBPACK FOOTER //\n// static/js/app.fbd5a78cd7468d028472.js","/*\n * Released under BSD License\n * Copyright (c) 2014-2015 hizzgdev@163.com\n * \n * Project Home:\n *   https://github.com/hizzgdev/jsmind/\n */\n\nexport default function(jsMind){\n    'use strict';\n    var $w = window;\n\n    var $d = $w.document;\n    var __name__ = 'jsMind';\n\n    if(!jsMind){return;}\n    if(typeof jsMind.draggable != 'undefined'){return;}\n\n    var jdom = jsMind.util.dom;\n    var jcanvas = jsMind.util.canvas;\n\n    var clear_selection = 'getSelection' in $w ? function(){\n         $w.getSelection().removeAllRanges();\n    } : function(){\n         $d.selection.empty();\n    };\n\n    var options = {\n        line_width : 5,\n        lookup_delay : 500,\n        lookup_interval : 80\n    };\n\n    jsMind.draggable = function(jm){\n        this.jm = jm;\n        this.e_canvas = null;\n        this.canvas_ctx = null;\n        this.shadow = null;\n        this.shadow_w = 0;\n        this.shadow_h = 0;\n        this.active_node = null;\n        this.target_node = null;\n        this.target_direct = null;\n        this.client_w = 0;\n        this.client_h = 0;\n        this.offset_x = 0;\n        this.offset_y = 0;\n        this.hlookup_delay = 0;\n        this.hlookup_timer = 0;\n        this.capture = false;\n        this.moved = false;\n    };\n\n    jsMind.draggable.prototype = {\n        init:function(){\n            this._create_canvas();\n            this._create_shadow();\n            this._event_bind();\n        },\n\n        resize:function(){\n            this.jm.view.e_nodes.appendChild(this.shadow);\n            this.e_canvas.width=this.jm.view.size.w;\n            this.e_canvas.height=this.jm.view.size.h;\n        },\n\n        _create_canvas:function(){\n            var c = $d.createElement('canvas');\n            this.jm.view.e_panel.appendChild(c);\n            var ctx = c.getContext('2d');\n            this.e_canvas = c;\n            this.canvas_ctx = ctx;\n        },\n\n        _create_shadow:function(){\n            var s = $d.createElement('jmnode');\n            s.style.visibility = 'hidden';\n            s.style.zIndex = '3';\n            s.style.cursor = 'move';\n            s.style.opacity= '0.7';\n            this.shadow = s;\n        },\n\n        reset_shadow:function(el){\n            var s = this.shadow.style;\n            this.shadow.innerHTML = el.innerHTML;\n            s.left = el.style.left;\n            s.top = el.style.top;\n            s.width = el.style.width;\n            s.height = el.style.height;\n            s.backgroundImage = el.style.backgroundImage;\n            s.backgroundSize = el.style.backgroundSize;\n            s.transform = el.style.transform;\n            this.shadow_w = this.shadow.clientWidth;\n            this.shadow_h = this.shadow.clientHeight;\n\n        },\n\n        show_shadow:function(){\n            if(!this.moved){\n                this.shadow.style.visibility = 'visible';\n            }\n        },\n\n        hide_shadow:function(){\n            this.shadow.style.visibility = 'hidden';\n        },\n\n        clear_lines:function(){\n            jcanvas.clear(this.canvas_ctx, 0, 0, this.jm.view.size.w, this.jm.view.size.h);\n        },\n\n        _magnet_shadow:function(node){\n            if(!!node){\n                this.canvas_ctx.lineWidth = options.line_width;\n                this.canvas_ctx.strokeStyle = 'rgba(0,0,0,0.3)';\n                this.canvas_ctx.lineCap = 'round';\n                this.clear_lines();\n                jcanvas.lineto(this.canvas_ctx,\n                    node.sp.x,\n                    node.sp.y,\n                    node.np.x,\n                    node.np.y);\n            }\n        },\n\n        _lookup_close_node:function(){\n            var root = this.jm.get_root();\n            var root_location = root.get_location();\n            var root_size = root.get_size();\n            var root_x = root_location.x + root_size.w/2;\n\n            var sw = this.shadow_w;\n            var sh = this.shadow_h;\n            var sx = this.shadow.offsetLeft;\n            var sy = this.shadow.offsetTop;\n\n            var ns,nl;\n\n            var direct = (sx + sw/2)>=root_x ?\n                            jsMind.direction.right : jsMind.direction.left;\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var min_distance = Number.MAX_VALUE;\n            var distance = 0;\n            var closest_node = null;\n            var closest_p = null;\n            var shadow_p = null;\n            for(var nodeid in nodes){\n                var np,sp;\n                node = nodes[nodeid];\n                if(node.isroot || node.direction == direct){\n                    if(node.id == this.active_node.id){\n                        continue;\n                    }\n                    ns = node.get_size();\n                    nl = node.get_location();\n                    if(direct == jsMind.direction.right){\n                        if(sx-nl.x-ns.w<=0){continue;}\n                        distance = Math.abs(sx-nl.x-ns.w) + Math.abs(sy+sh/2-nl.y-ns.h/2);\n                        np = {x:nl.x+ns.w-options.line_width,y:nl.y+ns.h/2};\n                        sp = {x:sx+options.line_width,y:sy+sh/2};\n                    }else{\n                        if(nl.x-sx-sw<=0){continue;}\n                        distance = Math.abs(sx+sw-nl.x) + Math.abs(sy+sh/2-nl.y-ns.h/2);\n                        np = {x:nl.x+options.line_width,y:nl.y+ns.h/2};\n                        sp = {x:sx+sw-options.line_width,y:sy+sh/2};\n                    }\n                    if(distance < min_distance){\n                        closest_node = node;\n                        closest_p = np;\n                        shadow_p = sp;\n                        min_distance = distance;\n                    }\n                }\n            }\n            var result_node = null;\n            if(!!closest_node){\n                result_node = {\n                    node:closest_node,\n                    direction:direct,\n                    sp:shadow_p,\n                    np:closest_p\n                };\n            }\n            return result_node;\n        },\n\n        lookup_close_node:function(){\n            var node_data = this._lookup_close_node();\n            if(!!node_data){\n                this._magnet_shadow(node_data);\n                this.target_node = node_data.node;\n                this.target_direct = node_data.direction;\n            }\n        },\n\n        _event_bind:function(){\n            var jd = this;\n            var container = this.jm.view.container;\n            jdom.add_event(container,'mousedown',function(e){\n                var evt = e || event;\n                jd.dragstart.call(jd,evt);\n            });\n            jdom.add_event(container,'mousemove',function(e){\n                var evt = e || event;\n                jd.drag.call(jd,evt);\n            });\n            jdom.add_event(container,'mouseup',function(e){\n                var evt = e || event;\n                jd.dragend.call(jd,evt);\n            });\n            jdom.add_event(container,'touchstart',function(e){\n                var evt = e || event;\n                jd.dragstart.call(jd,evt);\n            });\n            jdom.add_event(container,'touchmove',function(e){\n                var evt = e || event;\n                jd.drag.call(jd,evt);\n            });\n            jdom.add_event(container,'touchend',function(e){\n                var evt = e || event;\n                jd.dragend.call(jd,evt);\n            });\n        },\n\n        dragstart:function(e){\n            if(!this.jm.get_editable()){return;}\n            if(this.capture){return;}\n            this.active_node = null;\n\n            var jview = this.jm.view;\n            var el = e.target || event.srcElement;\n            if(el.tagName.toLowerCase() != 'jmnode'){return;}\n            var nodeid = jview.get_binded_nodeid(el);\n            if(!!nodeid){\n                var node = this.jm.get_node(nodeid);\n                if(!node.isroot){\n                    this.reset_shadow(el);\n                    this.active_node = node;\n                    this.offset_x = (e.clientX || e.touches[0].clientX) - el.offsetLeft;\n                    this.offset_y = (e.clientY || e.touches[0].clientY) - el.offsetTop;\n                    this.client_hw = Math.floor(el.clientWidth/2);\n                    this.client_hh = Math.floor(el.clientHeight/2);\n                    if(this.hlookup_delay != 0){\n                        $w.clearTimeout(this.hlookup_delay);\n                    }\n                    if(this.hlookup_timer != 0){\n                        $w.clearInterval(this.hlookup_timer);\n                    }\n                    var jd = this;\n                    this.hlookup_delay = $w.setTimeout(function(){\n                        jd.hlookup_delay = 0;\n                        jd.hlookup_timer = $w.setInterval(function(){\n                            jd.lookup_close_node.call(jd);\n                        },options.lookup_interval);\n                    },options.lookup_delay);\n                    this.capture = true;\n                }\n            }\n        },\n\n        drag:function(e){\n            if(!this.jm.get_editable()){return;}\n            if(this.capture){\n                e.preventDefault();\n                this.show_shadow();\n                this.moved = true;\n                clear_selection();\n                var px = (e.clientX || e.touches[0].clientX) - this.offset_x;\n                var py = (e.clientY || e.touches[0].clientY) - this.offset_y;\n                var cx = px + this.client_hw;\n                var cy = py + this.client_hh;\n                this.shadow.style.left = px + 'px';\n                this.shadow.style.top = py + 'px';\n                clear_selection();\n            }\n        },\n\n        dragend:function(e){\n            if(!this.jm.get_editable()){return;}\n            if(this.capture){\n                if(this.hlookup_delay != 0){\n                    $w.clearTimeout(this.hlookup_delay);\n                    this.hlookup_delay = 0;\n                    this.clear_lines();\n                }\n                if(this.hlookup_timer != 0){\n                    $w.clearInterval(this.hlookup_timer);\n                    this.hlookup_timer = 0;\n                    this.clear_lines();\n                }\n                if(this.moved){\n                    var src_node = this.active_node;\n                    var target_node = this.target_node;\n                    var target_direct = this.target_direct;\n                    this.move_node(src_node,target_node,target_direct);\n                }\n                this.hide_shadow();\n            }\n            this.moved = false;\n            this.capture = false;\n        },\n\n        move_node:function(src_node,target_node,target_direct){\n            var shadow_h = this.shadow.offsetTop;\n            if(!!target_node && !!src_node && !jsMind.node.inherited(src_node, target_node)){\n                // lookup before_node\n                var sibling_nodes = target_node.children;\n                var sc = sibling_nodes.length;\n                var node = null;\n                var delta_y = Number.MAX_VALUE;\n                var node_before = null;\n                var beforeid = '_last_';\n                while(sc--){\n                    node = sibling_nodes[sc];\n                    if(node.direction == target_direct && node.id != src_node.id){\n                        var dy = node.get_location().y - shadow_h;\n                        if(dy > 0 && dy < delta_y){\n                            delta_y = dy;\n                            node_before = node;\n                            beforeid = '_first_';\n                        }\n                    }\n                }\n                if(!!node_before){beforeid = node_before.id;}\n                this.jm.move_node(src_node.id, beforeid, target_node.id, target_direct);\n            }\n            this.active_node = null;\n            this.target_node = null;\n            this.target_direct = null;\n        },\n\n        jm_event_handle:function(type,data){\n            if(type === jsMind.event_type.resize){\n                this.resize();\n            }\n        }\n    };\n\n    var draggable_plugin = new jsMind.plugin('draggable',function(jm){\n        var jd = new jsMind.draggable(jm);\n        jd.init();\n        jm.add_event_listener(function(type,data){\n            jd.jm_event_handle.call(jd,type,data);\n        });\n    });\n\n    jsMind.register_plugin(draggable_plugin);\n\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/MindMap/jsmind/js/jsmind.draggable.js","/*\n * Released under BSD License\n * Copyright (c) 2014-2016 hizzgdev@163.com\n *\n * Project Home:\n *   https://github.com/hizzgdev/jsmind/\n */\n\nexport default (function(){\n    'use strict';\n    var $w = window;\n\n\n    // set 'jsMind' as the library name.\n    // __name__ should be a const value, Never try to change it easily.\n    var __name__ = 'jsMind';\n    // library version\n    var __version__ = '0.4.3';\n    // author\n    var __author__ = 'hizzgdev@163.com';\n\n    // an noop function define\n    var _noop = function(){};\n    var logger = (typeof console === 'undefined')?{\n            log:_noop, debug:_noop, error:_noop, warn:_noop, info:_noop\n        }:console;\n\n    // check global variables\n    if(typeof $w[__name__] != 'undefined'){\n        logger.log(__name__+' has been already exist.');\n        return;\n    }\n\n    // shortcut of methods in dom\n    var $d = $w.document;\n    var $g = function(id){return $d.getElementById(id);};\n    var $c = function(tag){return $d.createElement(tag);};\n    var $t = function(n,t){if(n.hasChildNodes()){n.firstChild.nodeValue = t;}else{n.appendChild($d.createTextNode(t));}};\n    var $h = function(n,t){n.innerHTML = t;};\n    // detect isElement\n    var $i = function(el){return !!el&&(typeof el==='object')&&(el.nodeType===1)&&(typeof el.style==='object')&&(typeof el.ownerDocument==='object');};\n    if(typeof String.prototype.startsWith != 'function'){String.prototype.startsWith=function(p){return this.slice(0,p.length)===p;};}\n\n    var DEFAULT_OPTIONS = {\n        container : '',   // id of the container\n        editable : false, // you can change it in your options\n        theme : null,\n        mode :'full',     // full or side\n        support_html : true,\n\n        view:{\n            hmargin:100,\n            vmargin:50,\n            line_width:2,\n            line_color:'#555'\n        },\n        layout:{\n            hspace:30,\n            vspace:20,\n            pspace:13\n        },\n        default_event_handle:{\n            enable_mousedown_handle:true,\n            enable_click_handle:true,\n            enable_dblclick_handle:true,\n            enable_contextmenu_handle:true\n        },\n        shortcut:{\n            enable:true,\n            handles:{\n            },\n            mapping:{\n                addchild   : 45, // Insert\n                addbrother : 13, // Enter\n                editnode   : 113,// F2\n                delnode    : 46, // Delete\n                toggle     : 32, // Space\n                left       : 37, // Left\n                up         : 38, // Up\n                right      : 39, // Right\n                down       : 40, // Down\n            }\n        },\n    };\n\n    // core object\n    var jm = function(options){\n        jm.current = this;\n\n        this.version = __version__;\n        var opts = {};\n        jm.util.json.merge(opts, DEFAULT_OPTIONS);\n        jm.util.json.merge(opts, options);\n\n        if(!opts.container){\n            logger.error('the options.container should not be null or empty.');\n            return;\n        }\n        this.options = opts;\n        this.inited = false;\n        this.mind = null;\n        this.event_handles = [];\n        this.init();\n    };\n\n    // ============= static object =============================================\n    jm.direction = {left:-1,center:0,right:1};\n    jm.event_type = {show:1,resize:2,edit:3,select:4};\n\n    jm.node = function(sId,iIndex,sTopic,oData,bIsRoot,oParent,eDirection,bExpanded){\n        if(!sId){logger.error('invalid nodeid');return;}\n        if(typeof iIndex != 'number'){logger.error('invalid node index');return;}\n        if(typeof bExpanded === 'undefined'){bExpanded = true;}\n        this.id = sId;\n        this.index = iIndex;\n        this.topic = sTopic;\n        this.data = oData || {};\n        this.isroot = bIsRoot;\n        this.parent = oParent;\n        this.direction = eDirection;\n        this.expanded = !!bExpanded;\n        this.children = [];\n        this._data = {};\n    };\n\n    jm.node.compare=function(node1,node2){\n        // '-1' is alwary the last\n        var r = 0;\n        var i1 = node1.index;\n        var i2 = node2.index;\n        if(i1>=0 && i2>=0){\n            r = i1-i2;\n        }else if(i1==-1 && i2==-1){\n            r = 0;\n        }else if(i1==-1){\n            r = 1;\n        }else if(i2==-1){\n            r = -1;\n        }else{\n            r = 0;\n        }\n        //logger.debug(i1+' <> '+i2+'  =  '+r);\n        return r;\n    };\n\n    jm.node.inherited=function(pnode,node){\n        if(!!pnode && !!node){\n            if(pnode.id === node.id){\n                return true;\n            }\n            if(pnode.isroot){\n                return true;\n            }\n            var pid = pnode.id;\n            var p = node;\n            while(!p.isroot){\n                p = p.parent;\n                if(p.id === pid){\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    jm.node.prototype = {\n        get_location:function(){\n            var vd = this._data.view;\n            return {\n                x:vd.abs_x,\n                y:vd.abs_y\n            };\n        },\n        get_size:function(){\n            var vd = this._data.view;\n            return {\n                w:vd.width,\n                h:vd.height\n            }\n        }\n    };\n\n\n    jm.mind = function(){\n        this.name = null;\n        this.author = null;\n        this.version = null;\n        this.root = null;\n        this.selected = null;\n        this.nodes = {};\n    };\n\n    jm.mind.prototype = {\n        get_node:function(nodeid){\n            if(nodeid in this.nodes){\n                return this.nodes[nodeid];\n            }else{\n                logger.warn('the node[id='+nodeid+'] can not be found');\n                return null;\n            }\n        },\n\n        set_root:function(nodeid, topic, data){\n            if(this.root == null){\n                this.root = new jm.node(nodeid, 0, topic, data, true);\n                this._put_node(this.root);\n            }else{\n                logger.error('root node is already exist');\n            }\n        },\n\n        add_node:function(parent_node, nodeid, topic, data, idx, direction, expanded){\n            if(!jm.util.is_node(parent_node)){\n                var the_parent_node = this.get_node(parent_node);\n                if(!the_parent_node){\n                    logger.error('the parent_node[id='+parent_node+'] can not be found.');\n                    return null;\n                }else{\n                    return this.add_node(the_parent_node, nodeid, topic, data, idx, direction, expanded);\n                }\n            }\n            var nodeindex = idx || -1;\n            var node = null;\n            if(parent_node.isroot){\n                var d = jm.direction.right;\n                if(isNaN(direction)){\n                    var children = parent_node.children;\n                    var children_len = children.length;\n                    var r = 0;\n                    for(var i=0;i<children_len;i++){if(children[i].direction === jm.direction.left){r--;}else{r++;}}\n                    d = (children_len > 1 && r > 0) ? jm.direction.left : jm.direction.right\n                }else{\n                    d = (direction != jm.direction.left) ? jm.direction.right : jm.direction.left;\n                }\n                node = new jm.node(nodeid,nodeindex,topic,data,false,parent_node,d,expanded);\n            }else{\n                node = new jm.node(nodeid,nodeindex,topic,data,false,parent_node,parent_node.direction,expanded);\n            }\n            if(this._put_node(node)){\n                parent_node.children.push(node);\n                this._reindex(parent_node);\n            }else{\n                logger.error('fail, the nodeid \\''+node.id+'\\' has been already exist.');\n                node = null;\n            }\n            return node;\n        },\n\n        insert_node_before:function(node_before, nodeid, topic, data){\n            if(!jm.util.is_node(node_before)){\n                var the_node_before = this.get_node(node_before);\n                if(!the_node_before){\n                    logger.error('the node_before[id='+node_before+'] can not be found.');\n                    return null;\n                }else{\n                    return this.insert_node_before(the_node_before, nodeid, topic, data);\n                }\n            }\n            var node_index = node_before.index-0.5;\n            return this.add_node(node_before.parent, nodeid, topic, data, node_index);\n        },\n\n        get_node_before:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return null;\n                }else{\n                    return this.get_node_before(the_node);\n                }\n            }\n            if(node.isroot){return null;}\n            var idx = node.index - 2;\n            if(idx >= 0){\n                return node.parent.children[idx];\n            }else{\n                return null;\n            }\n        },\n\n        insert_node_after:function(node_after, nodeid, topic, data){\n            if(!jm.util.is_node(node_after)){\n                var the_node_after = this.get_node(node_before);\n                if(!the_node_after){\n                    logger.error('the node_after[id='+node_after+'] can not be found.');\n                    return null;\n                }else{\n                    return this.insert_node_after(the_node_after, nodeid, topic, data);\n                }\n            }\n            var node_index = node_after.index + 0.5;\n            return this.add_node(node_after.parent, nodeid, topic, data, node_index);\n        },\n\n        get_node_after:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return null;\n                }else{\n                    return this.get_node_after(the_node);\n                }\n            }\n            if(node.isroot){return null;}\n            var idx = node.index;\n            var brothers = node.parent.children;\n            if(brothers.length >= idx){\n                return node.parent.children[idx];\n            }else{\n                return null;\n            }\n        },\n\n        move_node:function(node, beforeid, parentid, direction){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return null;\n                }else{\n                    return this.move_node(the_node, beforeid, parentid, direction);\n                }\n            }\n            if(!parentid){\n                parentid = node.parent.id;\n            }\n            return this._move_node(node, beforeid, parentid, direction);\n        },\n\n        _flow_node_direction:function(node,direction){\n            if(typeof direction === 'undefined'){\n                direction = node.direction;\n            }else{\n                node.direction = direction;\n            }\n            var len = node.children.length;\n            while(len--){\n                this._flow_node_direction(node.children[len],direction);\n            }\n        },\n\n        _move_node_internal:function(node, beforeid){\n            if(!!node && !!beforeid){\n                if(beforeid == '_last_'){\n                    node.index = -1;\n                    this._reindex(node.parent);\n                }else if(beforeid == '_first_'){\n                    node.index = 0;\n                    this._reindex(node.parent);\n                }else{\n                    var node_before = (!!beforeid)?this.get_node(beforeid):null;\n                    if(node_before!=null && node_before.parent!=null && node_before.parent.id==node.parent.id){\n                        node.index = node_before.index - 0.5;\n                        this._reindex(node.parent);\n                    }\n                }\n            }\n            return node;\n        },\n\n        _move_node:function(node, beforeid, parentid, direction){\n            if(!!node && !!parentid){\n                if(node.parent.id != parentid){\n                    // remove from parent's children\n                    var sibling = node.parent.children;\n                    var si = sibling.length;\n                    while(si--){\n                        if(sibling[si].id == node.id){\n                            sibling.splice(si,1);\n                            break;\n                        }\n                    }\n                    node.parent = this.get_node(parentid);\n                    node.parent.children.push(node);\n                }\n\n                if(node.parent.isroot){\n                    if(direction == jm.direction.left){\n                        node.direction = direction;\n                    }else{\n                        node.direction = jm.direction.right;\n                    }\n                }else{\n                    node.direction = node.parent.direction;\n                }\n                this._move_node_internal(node, beforeid);\n                this._flow_node_direction(node);\n            }\n            return node;\n        },\n\n        remove_node:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return false;\n                }else{\n                    return this.remove_node(the_node);\n                }\n            }\n            if(!node){\n                logger.error('fail, the node can not be found');\n                return false;\n            }\n            if(node.isroot){\n                logger.error('fail, can not remove root node');\n                return false;\n            }\n            if(this.selected!=null && this.selected.id == node.id){\n                this.selected = null;\n            }\n            // clean all subordinate nodes\n            var children = node.children;\n            var ci = children.length;\n            while(ci--){\n                this.remove_node(children[ci]);\n            }\n            // clean all children\n            children.length = 0;\n            // remove from parent's children\n            var sibling = node.parent.children;\n            var si = sibling.length;\n            while(si--){\n                if(sibling[si].id == node.id){\n                    sibling.splice(si,1);\n                    break;\n                }\n            }\n            // remove from global nodes\n            delete this.nodes[node.id];\n            // clean all properties\n            for(var k in node){\n                delete node[k];\n            }\n            // remove it's self\n            node = null;\n            //delete node;\n            return true;\n        },\n\n        _put_node:function(node){\n            if(node.id in this.nodes){\n                logger.warn('the nodeid \\''+node.id+'\\' has been already exist.');\n                return false;\n            }else{\n                this.nodes[node.id] = node;\n                return true;\n            }\n        },\n\n        _reindex:function(node){\n            if(node instanceof jm.node){\n                node.children.sort(jm.node.compare);\n                for(var i=0;i<node.children.length;i++){\n                    node.children[i].index = i+1;\n                }\n            }\n        },\n    };\n\n    jm.format = {\n        node_tree:{\n            example:{\n                \"meta\":{\n                    \"name\":__name__,\n                    \"author\":__author__,\n                    \"version\":__version__\n                },\n                \"format\":\"node_tree\",\n                \"data\":{\"id\":\"root\",\"topic\":\"jsMind Example\"}\n            },\n            get_mind:function(source){\n                var df = jm.format.node_tree;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind,source.data);\n                return mind;\n            },\n            get_data:function(mind){\n                var df = jm.format.node_tree;\n                var json = {};\n                json.meta = {\n                    name : mind.name,\n                    author : mind.author,\n                    version : mind.version\n                };\n                json.format = 'node_tree';\n                json.data = df._buildnode(mind.root);\n                return json;\n            },\n\n            _parse:function(mind, node_root){\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_root);\n                mind.set_root(node_root.id, node_root.topic, data);\n                if('children' in node_root){\n                    var children = node_root.children;\n                    for(var i=0;i<children.length;i++){\n                        df._extract_subnode(mind, mind.root, children[i]);\n                    }\n                }\n            },\n\n            _extract_data:function(node_json){\n                var data = {};\n                for(var k in node_json){\n                    if(k == 'id' || k=='topic' || k=='children' || k=='direction' || k=='expanded'){\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _extract_subnode:function(mind, node_parent, node_json){\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_json);\n                var d = null;\n                if(node_parent.isroot){\n                    d = node_json.direction == 'left'?jm.direction.left:jm.direction.right;\n                }\n                var node = mind.add_node(node_parent, node_json.id, node_json.topic, data, null, d, node_json.expanded);\n                if('children' in node_json){\n                    var children = node_json.children;\n                    for(var i=0;i<children.length;i++){\n                        df._extract_subnode(mind, node, children[i]);\n                    }\n                }\n            },\n\n            _buildnode:function(node){\n                var df = jm.format.node_tree;\n                if(!(node instanceof jm.node)){return;}\n                var o = {\n                    id : node.id,\n                    topic : node.topic,\n                    expanded : node.expanded\n                };\n                if(!!node.parent && node.parent.isroot){\n                    o.direction = node.direction == jm.direction.left?'left':'right';\n                }\n                if(node.data != null){\n                    var node_data = node.data;\n                    for(var k in node_data){\n                        o[k] = node_data[k];\n                    }\n                }\n                var children = node.children;\n                if(children.length > 0){\n                    o.children = [];\n                    for(var i=0;i<children.length;i++){\n                        o.children.push(df._buildnode(children[i]));\n                    }\n                }\n                return o;\n            }\n        },\n\n        node_array:{\n            example:{\n                \"meta\":{\n                    \"name\":__name__,\n                    \"author\":__author__,\n                    \"version\":__version__\n                },\n                \"format\":\"node_array\",\n                \"data\":[\n                    {\"id\":\"root\",\"topic\":\"jsMind Example\", \"isroot\":true}\n                ]\n            },\n\n            get_mind:function(source){\n                var df = jm.format.node_array;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind,source.data);\n                return mind;\n            },\n\n            get_data:function(mind){\n                var df = jm.format.node_array;\n                var json = {};\n                json.meta = {\n                    name : mind.name,\n                    author : mind.author,\n                    version : mind.version\n                };\n                json.format = 'node_array';\n                json.data = [];\n                df._array(mind,json.data);\n                return json;\n            },\n\n            _parse:function(mind, node_array){\n                var df = jm.format.node_array;\n                var narray = node_array.slice(0);\n                // reverse array for improving looping performance\n                narray.reverse();\n                var root_id = df._extract_root(mind, narray);\n                if(!!root_id){\n                    df._extract_subnode(mind, root_id, narray);\n                }else{\n                    logger.error('root node can not be found');\n                }\n            },\n\n            _extract_root:function(mind, node_array){\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                while(i--){\n                    if('isroot' in node_array[i] && node_array[i].isroot){\n                        var root_json = node_array[i];\n                        var data = df._extract_data(root_json);\n                        mind.set_root(root_json.id,root_json.topic,data);\n                        node_array.splice(i,1);\n                        return root_json.id;\n                    }\n                }\n                return null;\n            },\n\n            _extract_subnode:function(mind, parentid, node_array){\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                var node_json = null;\n                var data = null;\n                var extract_count = 0;\n                while(i--){\n                    node_json = node_array[i];\n                    if(node_json.parentid == parentid){\n                        data = df._extract_data(node_json);\n                        var d = null;\n                        var node_direction = node_json.direction;\n                        if(!!node_direction){\n                            d = node_direction == 'left'?jm.direction.left:jm.direction.right;\n                        }\n                        mind.add_node(parentid, node_json.id, node_json.topic, data, null, d, node_json.expanded);\n                        node_array.splice(i,1);\n                        extract_count ++;\n                        var sub_extract_count = df._extract_subnode(mind, node_json.id, node_array);\n                        if(sub_extract_count > 0){\n                            // reset loop index after extract subordinate node\n                            i = node_array.length;\n                            extract_count += sub_extract_count;\n                        }\n                    }\n                }\n                return extract_count;\n            },\n\n            _extract_data:function(node_json){\n                var data = {};\n                for(var k in node_json){\n                    if(k == 'id' || k=='topic' || k=='parentid' || k=='isroot' || k=='direction' || k=='expanded'){\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _array:function(mind, node_array){\n                var df = jm.format.node_array;\n                df._array_node(mind.root, node_array);\n            },\n\n            _array_node:function(node, node_array){\n                var df = jm.format.node_array;\n                if(!(node instanceof jm.node)){return;}\n                var o = {\n                    id : node.id,\n                    topic : node.topic,\n                    expanded : node.expanded\n                };\n                if(!!node.parent){\n                    o.parentid = node.parent.id;\n                }\n                if(node.isroot){\n                    o.isroot = true;\n                }\n                if(!!node.parent && node.parent.isroot){\n                    o.direction = node.direction == jm.direction.left?'left':'right';\n                }\n                if(node.data != null){\n                    var node_data = node.data;\n                    for(var k in node_data){\n                        o[k] = node_data[k];\n                    }\n                }\n                node_array.push(o);\n                var ci = node.children.length;\n                for(var i=0;i<ci;i++){\n                    df._array_node(node.children[i], node_array);\n                }\n            },\n        },\n\n        freemind:{\n            example:{\n                \"meta\":{\n                    \"name\":__name__,\n                    \"author\":__author__,\n                    \"version\":__version__\n                },\n                \"format\":\"freemind\",\n                \"data\":\"<map version=\\\"1.0.1\\\"><node ID=\\\"root\\\" TEXT=\\\"freemind Example\\\"/></map>\"\n            },\n            get_mind:function(source){\n                var df = jm.format.freemind;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                var xml = source.data;\n                var xml_doc = df._parse_xml(xml);\n                var xml_root = df._find_root(xml_doc);\n                df._load_node(mind, null, xml_root);\n                return mind;\n            },\n\n            get_data:function(mind){\n                var df = jm.format.freemind;\n                var json = {};\n                json.meta = {\n                    name : mind.name,\n                    author : mind.author,\n                    version : mind.version\n                };\n                json.format = 'freemind';\n                var xmllines = [];\n                xmllines.push('<map version=\\\"1.0.1\\\">');\n                df._buildmap(mind.root, xmllines);\n                xmllines.push('</map>');\n                json.data = xmllines.join(' ');\n                return json;\n            },\n\n            _parse_xml:function(xml){\n                var xml_doc = null;\n                if (window.DOMParser){\n                    var parser = new DOMParser();\n                    xml_doc = parser.parseFromString(xml,'text/xml');\n                }else{ // Internet Explorer\n                    xml_doc = new ActiveXObject('Microsoft.XMLDOM');\n                    xml_doc.async = false;\n                    xml_doc.loadXML(xml);\n                }\n                return xml_doc;\n            },\n\n            _find_root:function(xml_doc){\n                var nodes = xml_doc.childNodes;\n                var node = null;\n                var root = null;\n                var n = null;\n                for(var i=0;i<nodes.length;i++){\n                    n = nodes[i];\n                    if(n.nodeType == 1 && n.tagName == 'map'){\n                        node = n;\n                        break;\n                    }\n                }\n                if(!!node){\n                    var ns = node.childNodes;\n                    node = null;\n                    for(var i=0;i<ns.length;i++){\n                        n = ns[i];\n                        if(n.nodeType == 1 && n.tagName == 'node'){\n                            node = n;\n                            break;\n                        }\n                    }\n                }\n                return node;\n            },\n\n            _load_node:function(mind, parent_id, xml_node){\n                var df = jm.format.freemind;\n                var node_id = xml_node.getAttribute('ID');\n                var node_topic = xml_node.getAttribute('TEXT');\n                // look for richcontent\n                if(node_topic == null){\n                    var topic_children = xml_node.childNodes;\n                    var topic_child = null;\n                    for(var i=0;i<topic_children.length;i++){\n                        topic_child = topic_children[i];\n                        //logger.debug(topic_child.tagName);\n                        if(topic_child.nodeType == 1 && topic_child.tagName === 'richcontent'){\n                            node_topic = topic_child.textContent;\n                            break;\n                        }\n                    }\n                }\n                var node_data = df._load_attributes(xml_node);\n                var node_expanded = ('expanded' in node_data)?(node_data.expanded == 'true') : true;\n                delete node_data.expanded;\n\n                var node_position = xml_node.getAttribute('POSITION');\n                var node_direction = null;\n                if(!!node_position){\n                    node_direction = node_position=='left'?jm.direction.left:jm.direction.right;\n                }\n                //logger.debug(node_position +':'+ node_direction);\n                if(!!parent_id){\n                    mind.add_node(parent_id, node_id, node_topic, node_data, null, node_direction, node_expanded);\n                }else{\n                    mind.set_root(node_id, node_topic, node_data);\n                }\n                var children = xml_node.childNodes;\n                var child = null;\n                for(var i=0;i<children.length;i++){\n                    child = children[i];\n                    if(child.nodeType == 1 && child.tagName == 'node'){\n                        df._load_node(mind, node_id, child);\n                    }\n                }\n            },\n\n            _load_attributes:function(xml_node){\n                var children = xml_node.childNodes;\n                var attr = null;\n                var attr_data = {};\n                for(var i=0;i<children.length;i++){\n                    attr = children[i];\n                    if(attr.nodeType == 1 && attr.tagName === 'attribute'){\n                        attr_data[attr.getAttribute('NAME')] = attr.getAttribute('VALUE');\n                    }\n                }\n                return attr_data;\n            },\n\n            _buildmap:function(node, xmllines){\n                var df = jm.format.freemind;\n                var pos = null;\n                if(!!node.parent && node.parent.isroot){\n                    pos = node.direction === jm.direction.left?'left':'right';\n                }\n                xmllines.push('<node');\n                xmllines.push('ID=\\\"'+node.id+'\\\"');\n                if(!!pos){\n                    xmllines.push('POSITION=\\\"'+pos+'\\\"');\n                }\n                xmllines.push('TEXT=\\\"'+node.topic+'\\\">');\n\n                // store expanded status as an attribute\n                xmllines.push('<attribute NAME=\\\"expanded\\\" VALUE=\\\"'+node.expanded+'\\\"/>');\n\n                // for attributes\n                var node_data = node.data;\n                if(node_data != null){\n                    for(var k in node_data){\n                        xmllines.push('<attribute NAME=\\\"'+k+'\\\" VALUE=\\\"'+node_data[k]+'\\\"/>');\n                    }\n                }\n\n                // for children\n                var children = node.children;\n                for(var i=0;i<children.length;i++){\n                    df._buildmap(children[i], xmllines);\n                }\n\n                xmllines.push('</node>');\n            },\n        },\n    };\n\n    // ============= utility object =============================================\n\n    jm.util = {\n        is_node: function(node){\n            return !!node && node instanceof jm.node;\n        },\n        ajax:{\n            _xhr:function(){\n                var xhr = null;\n                if(window.XMLHttpRequest){\n                    xhr = new XMLHttpRequest();\n                }else{\n                    try{\n                        xhr = new ActiveXObject('Microsoft.XMLHTTP');\n                    }catch(e){}\n                }\n                return xhr;\n            },\n            _eurl:function(url){\n                return encodeURIComponent(url);\n            },\n            request:function(url,param,method,callback,fail_callback){\n                var a = jm.util.ajax;\n                var p = null;\n                var tmp_param = [];\n                for(var k in param){\n                    tmp_param.push(a._eurl(k)+'='+a._eurl(param[k]));\n                }\n                if(tmp_param.length>0){\n                    p = tmp_param.join('&');\n                }\n                var xhr = a._xhr();\n                if(!xhr){return;}\n                xhr.onreadystatechange = function(){\n                    if(xhr.readyState == 4){\n                        if(xhr.status == 200 || xhr.status == 0){\n                            if(typeof callback === 'function'){\n                                var data = jm.util.json.string2json(xhr.responseText);\n                                if(data != null){\n                                    callback(data);\n                                }else{\n                                    callback(xhr.responseText);\n                                }\n                            }\n                        }else{\n                            if(typeof fail_callback === 'function'){\n                                fail_callback(xhr);\n                            }else{\n                                logger.error('xhr request failed.',xhr);\n                            }\n                        }\n                    }\n                }\n                method = method || 'GET';\n                xhr.open(method,url,true);\n                xhr.setRequestHeader('If-Modified-Since','0');\n                if(method == 'POST'){\n                    xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded;charset=utf-8');\n                    xhr.send(p);\n                }else{\n                    xhr.send();\n                }\n            },\n            get:function(url,callback){\n                return jm.util.ajax.request(url,{},'GET',callback);\n            },\n            post:function(url,param,callback){\n                return jm.util.ajax.request(url,param,'POST',callback);\n            }\n        },\n\n        dom:{\n            //target,eventType,handler\n            add_event:function(t,e,h){\n                if(!!t.addEventListener){\n                    t.addEventListener(e,h,false);\n                }else{\n                    t.attachEvent('on'+e,h);\n                }\n            }\n        },\n\n        canvas:{\n            bezierto: function(ctx,x1,y1,x2,y2){\n                ctx.beginPath();\n                ctx.moveTo(x1,y1);\n                ctx.bezierCurveTo(x1+(x2-x1)*2/3,y1,x1,y2,x2,y2);\n                ctx.stroke();\n            },\n            lineto : function(ctx,x1,y1,x2,y2){\n                ctx.beginPath();\n                ctx.moveTo(x1,y1);\n                ctx.lineTo(x2,y2);\n                ctx.stroke();\n            },\n            clear:function(ctx,x,y,w,h){\n                ctx.clearRect(x,y,w,h);\n            }\n        },\n\n        file:{\n            read:function(file_data,fn_callback){\n                var reader = new FileReader();\n                reader.onload = function(){\n                    if(typeof fn_callback === 'function'){\n                        fn_callback(this.result, file_data.name);\n                    }\n                };\n                reader.readAsText(file_data);\n            },\n\n            save:function(file_data, type, name) {\n                var blob;\n                if (typeof $w.Blob === 'function') {\n                    blob = new Blob([file_data], {type: type});\n                } else {\n                    var BlobBuilder = $w.BlobBuilder || $w.MozBlobBuilder || $w.WebKitBlobBuilder || $w.MSBlobBuilder;\n                    var bb = new BlobBuilder();\n                    bb.append(file_data);\n                    blob = bb.getBlob(type);\n                }\n                if (navigator.msSaveBlob) {\n                    navigator.msSaveBlob(blob, name);\n                } else {\n                    var URL = $w.URL || $w.webkitURL;\n                    var bloburl = URL.createObjectURL(blob);\n                    var anchor = $c('a');\n                    if ('download' in anchor) {\n                        anchor.style.visibility = 'hidden';\n                        anchor.href = bloburl;\n                        anchor.download = name;\n                        $d.body.appendChild(anchor);\n                        var evt = $d.createEvent('MouseEvents');\n                        evt.initEvent('click', true, true);\n                        anchor.dispatchEvent(evt);\n                        $d.body.removeChild(anchor);\n                    } else {\n                        location.href = bloburl;\n                    }\n                }\n            }\n        },\n\n        json:{\n            json2string:function(json){\n                if(!!JSON){\n                    try{\n                        var json_str = JSON.stringify(json);\n                        return json_str;\n                    }catch(e){\n                        logger.warn(e);\n                        logger.warn('can not convert to string');\n                        return null;\n                    }\n                }\n            },\n            string2json:function(json_str){\n                if(!!JSON){\n                    try{\n                        var json = JSON.parse(json_str);\n                        return json;\n                    }catch(e){\n                        logger.warn(e);\n                        logger.warn('can not parse to json');\n                        return null;\n                    }\n                }\n            },\n            merge:function(b,a){\n                for(var o in a){\n                    if(o in b){\n                        if(typeof b[o] === 'object' &&\n                            Object.prototype.toString.call(b[o]).toLowerCase() == '[object object]' &&\n                            !b[o].length){\n                            jm.util.json.merge(b[o], a[o]);\n                        }else{\n                            b[o] = a[o];\n                        }\n                    }else{\n                        b[o] = a[o];\n                    }\n                }\n                return b;\n            }\n        },\n\n        uuid:{\n            newid:function(){\n                return (new Date().getTime().toString(16)+Math.random().toString(16).substr(2)).substr(2,16);\n            }\n        },\n\n        text:{\n            is_empty:function(s){\n                if(!s){return true;}\n                return s.replace(/\\s*/,'').length == 0;\n            }\n        }\n    };\n\n    jm.prototype={\n        init : function(){\n            if(this.inited){return;}\n            this.inited = true;\n\n            var opts = this.options;\n\n            var opts_layout = {\n                mode:opts.mode,\n                hspace:opts.layout.hspace,\n                vspace:opts.layout.vspace,\n                pspace:opts.layout.pspace\n            }\n            var opts_view = {\n                container:opts.container,\n                support_html:opts.support_html,\n                hmargin:opts.view.hmargin,\n                vmargin:opts.view.vmargin,\n                line_width:opts.view.line_width,\n                line_color:opts.view.line_color\n            };\n            // create instance of function provider\n            this.data = new jm.data_provider(this);\n            this.layout = new jm.layout_provider(this, opts_layout);\n            this.view = new jm.view_provider(this, opts_view);\n            this.shortcut = new jm.shortcut_provider(this, opts.shortcut);\n\n            this.data.init();\n            this.layout.init();\n            this.view.init();\n            this.shortcut.init();\n\n            this._event_bind();\n\n            jm.init_plugins(this);\n        },\n\n        enable_edit:function(){\n            this.options.editable = true;\n        },\n\n        disable_edit:function(){\n            this.options.editable = false;\n        },\n\n        // call enable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        enable_event_handle: function(event_handle){\n            this.options.default_event_handle['enable_'+event_handle+'_handle'] = true;\n        },\n\n        // call disable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        disable_event_handle: function(event_handle){\n            this.options.default_event_handle['enable_'+event_handle+'_handle'] = false;\n        },\n\n        get_editable:function(){\n            return this.options.editable;\n        },\n\n        set_theme:function(theme){\n            var theme_old = this.options.theme;\n            this.options.theme = (!!theme) ? theme : null;\n            if(theme_old != this.options.theme){\n                this.view.reset_theme();\n                this.view.reset_custom_style();\n            }\n        },\n        _event_bind:function(){\n            this.view.add_event(this,'mousedown',this.mousedown_handle);\n            this.view.add_event(this,'click',this.click_handle);\n            this.view.add_event(this,'dblclick',this.dblclick_handle);\n            this.view.add_event(this, 'contextmenu', this.contextmenu_handle);\n        },\n\n        mousedown_handle:function(e){\n            if (!this.options.default_event_handle['enable_mousedown_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var nodeid = this.view.get_binded_nodeid(element);\n            if(!!nodeid){\n                this.select_node(nodeid);\n            }else{\n                this.select_clear();\n\n                let $menu = $('#contextMenu')\n                if($menu.is(\":visible\")){\n                    $menu.hide()\n                }\n            }\n        },\n\n        click_handle:function(e){\n            if (!this.options.default_event_handle['enable_click_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var isexpander = this.view.is_expander(element);\n            if(isexpander){\n                var nodeid = this.view.get_binded_nodeid(element);\n                if(!!nodeid){\n                    this.toggle_node(nodeid);\n                }\n            }\n        },\n\n        dblclick_handle:function(e){\n            if (!this.options.default_event_handle['enable_dblclick_handle']) {\n                return;\n            }\n            if(this.get_editable()){\n                var element = e.target || event.srcElement;\n                var nodeid = this.view.get_binded_nodeid(element);\n                if(!!nodeid){\n                    this.begin_edit(nodeid);\n                }\n            }\n        },\n\n        contextmenu_handle: function(e){\n\n          if (!this.options.default_event_handle['enable_contextmenu_handle']) {\n            return;\n          }\n          // tell the browser we're handling this event\n          e.preventDefault()\n          e.stopPropagation()\n\n          var element = e.target || event.srcElement;\n          var nodeid = this.view.get_binded_nodeid(element);\n\n          let offsetX = 0\n          let offsetY = 0\n          let canvas = this.view.e_canvas\n\n          if(!!nodeid){\n\n             let reOffset = function () {\n              let BB = canvas.getBoundingClientRect()\n              offsetX = BB.left\n              offsetY = BB.top\n            }\n\n            let showContextMenu = function (r, x, y) {\n              let $menu = $('#contextMenu')\n              if (!r) { $menu.hide(); return }\n              $menu.show()\n\n              // $menu.empty()\n              $menu.css({left: x, top: y, 'z-index': 99999})\n\n              // for (let i = 0; i < 3; i++) {\n              //   $('<li>', { text: '' + i, 'data-fn': i }).appendTo($menu[0])\n              // }\n            }\n\n\n            reOffset()\n\n            window.onscroll = function (e) { reOffset() }\n            window.onresize = function (e) { reOffset() }\n\n\n            this.select_node(nodeid);\n\n\n            let selected_node = this.get_node(nodeid)\n\n\n            // get mouse position relative to the canvas\n            let x = parseInt(e.clientX - offsetX)\n            let y = parseInt(e.clientY - offsetY)\n\n            // hide the context menu\n            showContextMenu()\n\n            // check each rect for hits\n\n            let rect = selected_node\n            let rectRight = rect.get_location().x + rect.get_size().w\n            let rectBottom = rect.get_location().y + rect.get_size().h\n\n            // check each rect for hits\n            if (x >= rect.get_location().x && x <= rectRight && y >= rect.get_location().y && y <= rectBottom) {\n              showContextMenu(rect, x, y)\n            }\n\n\n            return false\n\n\n\n\n\n\n          }else{\n            this.select_clear();\n            $('#contextMenu').hide();\n          }\n        },\n\n        begin_edit:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return false;\n                }else{\n                    return this.begin_edit(the_node);\n                }\n            }\n            if(this.get_editable()){\n                this.view.edit_node_begin(node);\n            }else{\n                logger.error('fail, this mind map is not editable.');\n                return;\n            }\n        },\n\n        end_edit:function(){\n            this.view.edit_node_end();\n        },\n\n        toggle_node:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return;\n                }else{\n                    return this.toggle_node(the_node);\n                }\n            }\n            if(node.isroot){return;}\n            this.view.save_location(node);\n            this.layout.toggle_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_node:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return;\n                }else{\n                    return this.expand_node(the_node);\n                }\n            }\n            if(node.isroot){return;}\n            this.view.save_location(node);\n            this.layout.expand_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        collapse_node:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return;\n                }else{\n                    return this.collapse_node(the_node);\n                }\n            }\n            if(node.isroot){return;}\n            this.view.save_location(node);\n            this.layout.collapse_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_all:function(){\n            this.layout.expand_all();\n            this.view.relayout();\n        },\n\n        collapse_all:function(){\n            this.layout.collapse_all();\n            this.view.relayout();\n        },\n\n        expand_to_depth:function(depth){\n            this.layout.expand_to_depth(depth);\n            this.view.relayout();\n        },\n\n        _reset:function(){\n            this.view.reset();\n            this.layout.reset();\n            this.data.reset();\n        },\n\n        _show:function(mind){\n            var m = mind || jm.format.node_array.example;\n\n            this.mind = this.data.load(m);\n            if(!this.mind){\n                logger.error('data.load error');\n                return;\n            }else{\n                logger.debug('data.load ok');\n            }\n\n            this.view.load();\n            logger.debug('view.load ok');\n\n            this.layout.layout();\n            logger.debug('layout.layout ok');\n\n            this.view.show(true);\n            logger.debug('view.show ok');\n\n            this.invoke_event_handle(jm.event_type.show,{data:[mind]});\n        },\n\n        show : function(mind){\n            this._reset();\n            this._show(mind);\n        },\n\n        get_meta: function(){\n            return {\n                name : this.mind.name,\n                author : this.mind.author,\n                version : this.mind.version\n            };\n        },\n\n        get_data: function(data_format){\n            var df = data_format || 'node_tree';\n            return this.data.get_data(df);\n        },\n\n        get_root:function(){\n            return this.mind.root;\n        },\n\n        get_node:function(nodeid){\n            return this.mind.get_node(nodeid);\n        },\n\n        add_node:function(parent_node, nodeid, topic, data){\n            if(this.get_editable()){\n                var node = this.mind.add_node(parent_node, nodeid, topic, data);\n                if(!!node){\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.view.reset_node_custom_style(node);\n                    this.expand_node(parent_node);\n                    this.invoke_event_handle(jm.event_type.edit,{evt:'add_node',data:[parent_node.id,nodeid,topic,data],node:nodeid});\n                }\n                return node;\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_before:function(node_before, nodeid, topic, data){\n            if(this.get_editable()){\n                var beforeid = jm.util.is_node(node_before) ? node_before.id : node_before;\n                var node = this.mind.insert_node_before(node_before, nodeid, topic, data);\n                if(!!node){\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit,{evt:'insert_node_before',data:[beforeid,nodeid,topic,data],node:nodeid});\n                }\n                return node;\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_after:function(node_after, nodeid, topic, data){\n            if(this.get_editable()){\n                var afterid = jm.util.is_node(node_after) ? node_after.id : node_after;\n                var node = this.mind.insert_node_after(node_after, nodeid, topic, data);\n                if(!!node){\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit,{evt:'insert_node_after',data:[afterid,nodeid,topic,data],node:nodeid});\n                }\n                return node;\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        remove_node:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return false;\n                }else{\n                    return this.remove_node(the_node);\n                }\n            }\n            if(this.get_editable()){\n                if(node.isroot){\n                    logger.error('fail, can not remove root node');\n                    return false;\n                }\n                var nodeid = node.id;\n                var parentid = node.parent.id;\n                var parent_node = this.get_node(parentid);\n                this.view.save_location(parent_node);\n                this.view.remove_node(node);\n                this.mind.remove_node(node);\n                this.layout.layout();\n                this.view.show(false);\n                this.view.restore_location(parent_node);\n                this.invoke_event_handle(jm.event_type.edit,{evt:'remove_node',data:[nodeid],node:parentid});\n                return true;\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return false;\n            }\n        },\n\n        update_node:function(nodeid, topic){\n            if(this.get_editable()){\n                if(jm.util.text.is_empty(topic)){\n                    logger.warn('fail, topic can not be empty');\n                    return;\n                }\n                var node = this.get_node(nodeid);\n                if(!!node){\n                    if(node.topic === topic){\n                        logger.info('nothing changed');\n                        this.view.update_node(node);\n                        return;\n                    }\n                    node.topic = topic;\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit,{evt:'update_node',data:[nodeid,topic],node:nodeid});\n                }\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        move_node:function(nodeid, beforeid, parentid, direction){\n            if(this.get_editable()){\n                var node = this.mind.move_node(nodeid,beforeid,parentid,direction);\n                if(!!node){\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit,{evt:'move_node',data:[nodeid,beforeid,parentid,direction],node:nodeid});\n                }\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        select_node:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return;\n                }else{\n                    return this.select_node(the_node);\n                }\n            }\n            if(!this.layout.is_visible(node)){\n                return;\n            }\n            this.mind.selected = node;\n            this.view.select_node(node);\n        },\n\n        get_selected_node:function(){\n            if(!!this.mind){\n                return this.mind.selected;\n            }else{\n                return null;\n            }\n        },\n\n        select_clear:function(){\n            if(!!this.mind){\n                this.mind.selected = null;\n                this.view.select_clear();\n            }\n        },\n\n        is_node_visible:function(node){\n            return this.layout.is_visible(node);\n        },\n\n        find_node_before:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return;\n                }else{\n                    return this.find_node_before(the_node);\n                }\n            }\n            if(node.isroot){return null;}\n            var n = null;\n            if(node.parent.isroot){\n                var c = node.parent.children;\n                var prev = null;\n                var ni = null;\n                for(var i=0;i<c.length;i++){\n                    ni = c[i];\n                    if(node.direction === ni.direction){\n                        if(node.id === ni.id){\n                            n = prev;\n                        }\n                        prev = ni;\n                    }\n                }\n            }else{\n                n = this.mind.get_node_before(node);\n            }\n            return n;\n        },\n\n        find_node_after:function(node){\n            if(!jm.util.is_node(node)){\n                var the_node = this.get_node(node);\n                if(!the_node){\n                    logger.error('the node[id='+node+'] can not be found.');\n                    return;\n                }else{\n                    return this.find_node_after(the_node);\n                }\n            }\n            if(node.isroot){return null;}\n            var n = null;\n            if(node.parent.isroot){\n                var c = node.parent.children;\n                var getthis = false;\n                var ni = null;\n                for(var i=0;i<c.length;i++){\n                    ni = c[i];\n                    if(node.direction === ni.direction){\n                        if(getthis){\n                            n = ni;\n                            break;\n                        }\n                        if(node.id === ni.id){\n                            getthis = true;\n                        }\n                    }\n                }\n            }else{\n                n = this.mind.get_node_after(node);\n            }\n            return n;\n        },\n\n        set_node_color:function(nodeid, bgcolor, fgcolor){\n            if(this.get_editable()){\n                var node = this.mind.get_node(nodeid);\n                if(!!node){\n                    if(!!bgcolor){\n                        node.data['background-color'] = bgcolor;\n                    }\n                    if(!!fgcolor){\n                        node.data['foreground-color'] = fgcolor;\n                    }\n                    this.view.reset_node_custom_style(node);\n                }\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_font_style:function(nodeid, size, weight, style){\n            if(this.get_editable()){\n                var node = this.mind.get_node(nodeid);\n                if(!!node){\n                    if(!!size){\n                        node.data['font-size'] = size;\n                    }\n                    if(!!weight){\n                        node.data['font-weight'] = weight;\n                    }\n                    if(!!style){\n                        node.data['font-style'] = style;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_image:function(nodeid, image, width, height, rotation){\n            if(this.get_editable()){\n                var node = this.mind.get_node(nodeid);\n                if(!!node){\n                    if(!!image){\n                        node.data['background-image'] = image;\n                    }\n                    if(!!width){\n                        node.data['width'] = width;\n                    }\n                    if(!!height){\n                        node.data['height'] = height;\n                    }\n                    if(!!rotation){\n                        node.data['background-rotation'] = rotation;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_rotation:function(nodeid, rotation){\n            if(this.get_editable()){\n                var node = this.mind.get_node(nodeid);\n                if(!!node){\n                    if(!node.data['background-image']) {\n                        logger.error('fail, only can change rotation angle of node with background image');\n                        return null;\n                    }\n                    node.data['background-rotation'] = rotation;\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            }else{\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        resize:function(){\n            this.view.resize();\n        },\n\n        // callback(type ,data)\n        add_event_listener:function(callback){\n            if(typeof callback === 'function'){\n                this.event_handles.push(callback);\n            }\n        },\n\n        invoke_event_handle:function(type, data){\n            var j = this;\n            $w.setTimeout(function(){\n                j._invoke_event_handle(type,data);\n            },0);\n        },\n\n        _invoke_event_handle:function(type,data){\n            var l = this.event_handles.length;\n            for(var i=0;i<l;i++){\n                this.event_handles[i](type,data);\n            }\n        }\n\n    };\n\n// ============= data provider =============================================\n\n    jm.data_provider = function(jm){\n        this.jm = jm;\n    };\n\n    jm.data_provider.prototype={\n        init:function(){\n            logger.debug('data.init');\n        },\n\n        reset:function(){\n            logger.debug('data.reset');\n        },\n\n        load:function(mind_data){\n            var df = null;\n            var mind = null;\n            if(typeof mind_data === 'object'){\n                if(!!mind_data.format){\n                    df = mind_data.format;\n                }else{\n                    df = 'node_tree';\n                }\n            }else{\n                df = 'freemind';\n            }\n\n            if(df == 'node_array'){\n                mind = jm.format.node_array.get_mind(mind_data);\n            }else if(df == 'node_tree'){\n                mind = jm.format.node_tree.get_mind(mind_data);\n            }else if(df == 'freemind'){\n                mind = jm.format.freemind.get_mind(mind_data);\n            }else{\n                logger.warn('unsupported format');\n            }\n            return mind;\n        },\n\n        get_data:function(data_format){\n            var data = null;\n            if(data_format == 'node_array'){\n                data = jm.format.node_array.get_data(this.jm.mind);\n            }else if(data_format == 'node_tree'){\n                data = jm.format.node_tree.get_data(this.jm.mind);\n            }else if(data_format == 'freemind'){\n                data = jm.format.freemind.get_data(this.jm.mind);\n            }else{\n                logger.error('unsupported '+data_format+' format');\n            }\n            return data;\n        },\n    };\n\n    // ============= layout provider ===========================================\n\n    jm.layout_provider = function(jm, options){\n        this.opts = options;\n        this.jm = jm;\n        this.isside = (this.opts.mode == 'side');\n        this.bounds = null;\n\n        this.cache_valid = false;\n    };\n\n    jm.layout_provider.prototype={\n        init:function(){\n            logger.debug('layout.init');\n        },\n        reset:function(){\n            logger.debug('layout.reset');\n            this.bounds = {n:0,s:0,w:0,e:0};\n        },\n        layout:function(){\n            logger.debug('layout.layout');\n            this.layout_direction();\n            this.layout_offset();\n        },\n\n        layout_direction:function(){\n            this._layout_direction_root();\n        },\n\n        _layout_direction_root:function(){\n            var node = this.jm.mind.root;\n            // logger.debug(node);\n            var layout_data = null;\n            if('layout' in node._data){\n                layout_data = node._data.layout;\n            }else{\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n            layout_data.direction = jm.direction.center;\n            layout_data.side_index = 0;\n            if(this.isside){\n                var i = children_count;\n                while(i--){\n                    this._layout_direction_side(children[i], jm.direction.right, i);\n                }\n            }else{\n                var i = children_count;\n                var subnode = null;\n                while(i--){\n                    subnode = children[i];\n                    if(subnode.direction == jm.direction.left){\n                        this._layout_direction_side(subnode,jm.direction.left, i);\n                    }else{\n                        this._layout_direction_side(subnode,jm.direction.right, i);\n                    }\n                }\n                /*\n                var boundary = Math.ceil(children_count/2);\n                var i = children_count;\n                while(i--){\n                    if(i>=boundary){\n                        this._layout_direction_side(children[i],jm.direction.left, children_count-i-1);\n                    }else{\n                        this._layout_direction_side(children[i],jm.direction.right, i);\n                    }\n                }*/\n\n            }\n        },\n\n        _layout_direction_side:function(node, direction, side_index){\n            var layout_data = null;\n            if('layout' in node._data){\n                layout_data = node._data.layout;\n            }else{\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n\n            layout_data.direction = direction;\n            layout_data.side_index = side_index;\n            var i = children_count;\n            while(i--){\n                this._layout_direction_side(children[i], direction, i);\n            }\n        },\n\n        layout_offset:function(){\n            var node = this.jm.mind.root;\n            var layout_data = node._data.layout;\n            layout_data.offset_x = 0;\n            layout_data.offset_y = 0;\n            layout_data.outer_height = 0;\n            var children = node.children;\n            var i = children.length;\n            var left_nodes = [];\n            var right_nodes = [];\n            var subnode = null;\n            while(i--){\n                subnode = children[i];\n                if(subnode._data.layout.direction == jm.direction.right){\n                    right_nodes.unshift(subnode);\n                }else{\n                    left_nodes.unshift(subnode);\n                }\n            }\n            layout_data.left_nodes = left_nodes;\n            layout_data.right_nodes = right_nodes;\n            layout_data.outer_height_left = this._layout_offset_subnodes(left_nodes);\n            layout_data.outer_height_right = this._layout_offset_subnodes(right_nodes);\n            this.bounds.e=node._data.view.width/2;\n            this.bounds.w=0-this.bounds.e;\n            //logger.debug(this.bounds.w);\n            this.bounds.n=0;\n            this.bounds.s = Math.max(layout_data.outer_height_left,layout_data.outer_height_right);\n        },\n\n        // layout both the x and y axis\n        _layout_offset_subnodes:function(nodes){\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while(i--){\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if(pd == null){\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes(node.children);\n                if(!node.expanded){\n                    node_outer_height=0;\n                    this.set_visible(node.children,false);\n                }\n                node_outer_height = Math.max(node._data.view.height,node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height/2;\n                layout_data.offset_x = this.opts.hspace * layout_data.direction + pd.view.width * (pd.layout.direction + layout_data.direction)/2;\n                if(!node.parent.isroot){\n                    layout_data.offset_x += this.opts.pspace * layout_data.direction;\n                }\n\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if(nodes_count>1){\n                total_height += this.opts.vspace * (nodes_count-1);\n            }\n            i = nodes_count;\n            var middle_height = total_height/2;\n            while(i--){\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n            }\n            return total_height;\n        },\n\n        // layout the y axis only, for collapse/expand a node\n        _layout_offset_subnodes_height:function(nodes){\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while(i--){\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if(pd == null){\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes_height(node.children);\n                if(!node.expanded){\n                    node_outer_height=0;\n                }\n                node_outer_height = Math.max(node._data.view.height,node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height/2;\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if(nodes_count>1){\n                total_height += this.opts.vspace * (nodes_count-1);\n            }\n            i = nodes_count;\n            var middle_height = total_height/2;\n            while(i--){\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n                //logger.debug(node.topic);\n                //logger.debug(node._data.layout.offset_y);\n            }\n            return total_height;\n        },\n\n        get_node_offset:function(node){\n            var layout_data = node._data.layout;\n            var offset_cache = null;\n            if(('_offset_' in layout_data) && this.cache_valid){\n                offset_cache = layout_data._offset_;\n            }else{\n                offset_cache = {x:-1, y:-1};\n                layout_data._offset_ = offset_cache;\n            }\n            if(offset_cache.x == -1 || offset_cache.y == -1){\n                var x = layout_data.offset_x;\n                var y = layout_data.offset_y;\n                if(!node.isroot){\n                    var offset_p = this.get_node_offset(node.parent);\n                    x += offset_p.x;\n                    y += offset_p.y;\n                }\n                offset_cache.x = x;\n                offset_cache.y = y;\n            }\n            return offset_cache;\n        },\n\n        get_node_point:function(node){\n            var view_data = node._data.view;\n            var offset_p = this.get_node_offset(node);\n            //logger.debug(offset_p);\n            var p = {};\n            p.x = offset_p.x + view_data.width*(node._data.layout.direction-1)/2;\n            p.y = offset_p.y-view_data.height/2;\n            //logger.debug(p);\n            return p;\n        },\n\n        get_node_point_in:function(node){\n            var p = this.get_node_offset(node);\n            return p;\n        },\n\n        get_node_point_out:function(node){\n            var layout_data = node._data.layout;\n            var pout_cache = null;\n            if(('_pout_' in layout_data) && this.cache_valid){\n                pout_cache = layout_data._pout_;\n            }else{\n                pout_cache = {x:-1, y:-1};\n                layout_data._pout_ = pout_cache;\n            }\n            if(pout_cache.x == -1 || pout_cache.y == -1){\n                if(node.isroot){\n                    pout_cache.x = 0;\n                    pout_cache.y = 0;\n                }else{\n                    var view_data = node._data.view;\n                    var offset_p = this.get_node_offset(node);\n                    pout_cache.x = offset_p.x + (view_data.width+this.opts.pspace)*node._data.layout.direction;\n                    pout_cache.y = offset_p.y;\n                    //logger.debug('pout');\n                    //logger.debug(pout_cache);\n                }\n            }\n            return pout_cache;\n        },\n\n        get_expander_point:function(node){\n            var p = this.get_node_point_out(node);\n            var ex_p = {};\n            if(node._data.layout.direction == jm.direction.right){\n                ex_p.x = p.x - this.opts.pspace;\n            }else{\n                ex_p.x = p.x;\n            }\n            ex_p.y = p.y - Math.ceil(this.opts.pspace/2);\n            return ex_p;\n        },\n\n        get_min_size:function(){\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pout = null;\n            for(var nodeid in nodes){\n                node = nodes[nodeid];\n                pout = this.get_node_point_out(node);\n                //logger.debug(pout.x);\n                if(pout.x > this.bounds.e){this.bounds.e = pout.x;}\n                if(pout.x < this.bounds.w){this.bounds.w = pout.x;}\n            }\n            return {\n                w:this.bounds.e - this.bounds.w,\n                h:this.bounds.s - this.bounds.n\n            }\n        },\n\n        toggle_node:function(node){\n            if(node.isroot){\n                return;\n            }\n            if(node.expanded){\n                this.collapse_node(node);\n            }else{\n                this.expand_node(node);\n            }\n        },\n\n        expand_node:function(node){\n            node.expanded = true;\n            this.part_layout(node);\n            this.set_visible(node.children,true);\n        },\n\n        collapse_node:function(node){\n            node.expanded = false;\n            this.part_layout(node);\n            this.set_visible(node.children,false);\n        },\n\n        expand_all:function(){\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for(var nodeid in nodes){\n                node = nodes[nodeid];\n                if(!node.expanded){\n                    node.expanded = true;\n                    c++;\n                }\n            }\n            if(c>0){\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children,true);\n            }\n        },\n\n        collapse_all:function(){\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for(var nodeid in nodes){\n                node = nodes[nodeid];\n                if(node.expanded && !node.isroot){\n                    node.expanded = false\n                    c++;\n                }\n            }\n            if(c>0){\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children,true);\n            }\n        },\n\n        expand_to_depth:function(target_depth,curr_nodes,curr_depth){\n            if(target_depth < 1){return;}\n            var nodes = curr_nodes || this.jm.mind.root.children;\n            var depth = curr_depth || 1;\n            var i = nodes.length;\n            var node = null;\n            while(i--){\n                node = nodes[i];\n                if(depth < target_depth){\n                    if(!node.expanded){\n                        this.expand_node(node);\n                    }\n                    this.expand_to_depth(target_depth, node.children, depth+1);\n                }\n                if(depth == target_depth){\n                    if(node.expanded){\n                        this.collapse_node(node);\n                    }\n                }\n            }\n        },\n\n        part_layout:function(node){\n            var root = this.jm.mind.root;\n            if(!!root){\n                var root_layout_data = root._data.layout;\n                if(node.isroot){\n                    root_layout_data.outer_height_right=this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    root_layout_data.outer_height_left=this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                }else{\n                    if(node._data.layout.direction == jm.direction.right){\n                        root_layout_data.outer_height_right=this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    }else{\n                        root_layout_data.outer_height_left=this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                    }\n                }\n                this.bounds.s = Math.max(root_layout_data.outer_height_left,root_layout_data.outer_height_right);\n                this.cache_valid = false;\n            }else{\n                logger.warn('can not found root node');\n            }\n        },\n\n        set_visible:function(nodes,visible){\n            var i = nodes.length;\n            var node = null;\n            var layout_data = null;\n            while(i--){\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if(node.expanded){\n                    this.set_visible(node.children,visible);\n                }else{\n                    this.set_visible(node.children,false);\n                }\n                if(!node.isroot){\n                    node._data.layout.visible = visible;\n                }\n            }\n        },\n\n        is_expand:function(node){\n            return node.expanded;\n        },\n\n        is_visible:function(node){\n            var layout_data = node._data.layout;\n            if(('visible' in layout_data) && !layout_data.visible){\n                return false;\n            }else{\n                return true;\n            }\n        },\n    };\n\n    // view provider\n    jm.view_provider= function(jm, options){\n        this.opts = options;\n        this.jm = jm;\n        this.layout = jm.layout;\n\n        this.container = null;\n        this.e_panel = null;\n        this.e_nodes= null;\n        this.e_canvas = null;\n\n        this.canvas_ctx = null;\n        this.size = {w:0,h:0};\n\n        this.selected_node = null;\n        this.editing_node = null;\n    };\n\n    jm.view_provider.prototype={\n        init:function(){\n            logger.debug('view.init');\n\n            this.container = $i(this.opts.container) ? this.opts.container : $g(this.opts.container);\n            if(!this.container){\n                logger.error('the options.view.container was not be found in dom');\n                return;\n            }\n            this.e_panel = $c('div');\n            this.e_canvas = $c('canvas');\n            this.e_nodes = $c('jmnodes');\n            this.e_editor = $c('input');\n\n            this.e_panel.className = 'jsmind-inner';\n            this.e_panel.appendChild(this.e_canvas);\n            this.e_panel.appendChild(this.e_nodes);\n\n            this.e_editor.className = 'jsmind-editor';\n            this.e_editor.type = 'text';\n\n            this.actualZoom = 1;\n            this.zoomStep = 0.1;\n            this.minZoom = 0.5;\n            this.maxZoom = 2;\n\n            var v = this;\n            jm.util.dom.add_event(this.e_editor,'keydown',function(e){\n                var evt = e || event;\n                if(evt.keyCode == 13){v.edit_node_end();evt.stopPropagation();}\n            });\n            jm.util.dom.add_event(this.e_editor,'blur',function(e){\n                v.edit_node_end();\n            });\n\n            this.container.appendChild(this.e_panel);\n\n            this.init_canvas();\n        },\n\n        add_event:function(obj,event_name,event_handle){\n            jm.util.dom.add_event(this.e_nodes,event_name,function(e){\n                var evt = e || event;\n                event_handle.call(obj,evt);\n            });\n        },\n\n        get_binded_nodeid:function(element){\n            if(element == null){\n                return null;\n            }\n            var tagName = element.tagName.toLowerCase();\n            if(tagName == 'jmnodes' || tagName == 'body' || tagName == 'html'){\n                return null;\n            }\n            if(tagName == 'jmnode' || tagName == 'jmexpander'){\n                return element.getAttribute('nodeid');\n            }else{\n                return this.get_binded_nodeid(element.parentElement);\n            }\n        },\n\n        is_expander:function(element){\n            return (element.tagName.toLowerCase() == 'jmexpander');\n        },\n\n        reset:function(){\n            logger.debug('view.reset');\n            this.selected_node = null;\n            this.clear_lines();\n            this.clear_nodes();\n            this.reset_theme();\n        },\n\n        reset_theme:function(){\n            var theme_name = this.jm.options.theme;\n            if(!!theme_name){\n                this.e_nodes.className = 'theme-' + theme_name;\n            }else{\n                this.e_nodes.className = '';\n            }\n        },\n\n        reset_custom_style:function(){\n            var nodes = this.jm.mind.nodes;\n            for(var nodeid in nodes){\n                this.reset_node_custom_style(nodes[nodeid]);\n            }\n        },\n\n        load:function(){\n            logger.debug('view.load');\n            this.init_nodes();\n        },\n\n        expand_size:function(){\n            var min_size = this.layout.get_min_size();\n            var min_width = min_size.w + this.opts.hmargin*2;\n            var min_height = min_size.h + this.opts.vmargin*2;\n            var client_w = this.e_panel.clientWidth;\n            var client_h = this.e_panel.clientHeight;\n            if(client_w < min_width){client_w = min_width;}\n            if(client_h < min_height){client_h = min_height;}\n            this.size.w = client_w;\n            this.size.h = client_h;\n        },\n\n        init_canvas:function(){\n            var ctx = this.e_canvas.getContext('2d');\n            this.canvas_ctx = ctx;\n        },\n\n        init_nodes_size:function(node){\n            var view_data = node._data.view;\n            view_data.width = view_data.element.clientWidth;\n            view_data.height = view_data.element.clientHeight;\n        },\n\n        init_nodes:function(){\n            var nodes = this.jm.mind.nodes;\n            var doc_frag = $d.createDocumentFragment();\n            for(var nodeid in nodes){\n                this.create_node_element(nodes[nodeid],doc_frag);\n            }\n            this.e_nodes.appendChild(doc_frag);\n            for(var nodeid in nodes){\n                this.init_nodes_size(nodes[nodeid]);\n            }\n        },\n\n        add_node:function(node){\n            this.create_node_element(node,this.e_nodes);\n            this.init_nodes_size(node);\n        },\n\n        create_node_element:function(node,parent_node){\n            var view_data = null;\n            if('view' in node._data){\n                view_data = node._data.view;\n            }else{\n                view_data = {};\n                node._data.view = view_data;\n            }\n\n            var d = $c('jmnode');\n            if(node.isroot){\n                d.className = 'root';\n            }else{\n                var d_e = $c('jmexpander');\n                $t(d_e,'-');\n                d_e.setAttribute('nodeid',node.id);\n                d_e.style.visibility = 'hidden';\n                parent_node.appendChild(d_e);\n                view_data.expander = d_e;\n            }\n            if (!!node.topic) {\n                if(this.opts.support_html){\n                    $h(d,node.topic);\n                }else{\n                    $t(d,node.topic);\n                }\n            }\n            d.setAttribute('nodeid',node.id);\n            d.style.visibility='hidden';\n            this._reset_node_custom_style(d, node.data);\n\n            parent_node.appendChild(d);\n            view_data.element = d;\n        },\n\n        remove_node:function(node){\n            if(this.selected_node != null && this.selected_node.id == node.id){\n                this.selected_node = null;\n            }\n            if(this.editing_node != null && this.editing_node.id == node.id){\n                node._data.view.element.removeChild(this.e_editor);\n                this.editing_node = null;\n            }\n            var children = node.children;\n            var i = children.length;\n            while(i--){\n                this.remove_node(children[i]);\n            }\n            if(node._data.view){\n                var element = node._data.view.element;\n                var expander = node._data.view.expander;\n                this.e_nodes.removeChild(element);\n                this.e_nodes.removeChild(expander);\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n        },\n\n        update_node:function(node){\n            var view_data = node._data.view;\n            var element = view_data.element;\n            if (!!node.topic) {\n                if(this.opts.support_html){\n                    $h(element,node.topic);\n                }else{\n                    $t(element,node.topic);\n                }\n            }\n            view_data.width = element.clientWidth;\n            view_data.height = element.clientHeight;\n        },\n\n        select_node:function(node){\n            if(!!this.selected_node){\n                this.selected_node._data.view.element.className =\n                this.selected_node._data.view.element.className.replace(/\\s*selected\\s*/i,'');\n                this.reset_node_custom_style(this.selected_node);\n            }\n            if(!!node){\n                this.selected_node = node;\n                node._data.view.element.className += ' selected';\n                this.clear_node_custom_style(node);\n            }\n        },\n\n        select_clear:function(){\n            this.select_node(null);\n        },\n\n        get_editing_node:function(){\n            return this.editing_node;\n        },\n\n        is_editing:function(){\n            return (!!this.editing_node);\n        },\n\n        edit_node_begin:function(node){\n            if(!node.topic) {\n                logger.warn(\"don't edit image nodes\");\n                return;\n            }\n            if(this.editing_node != null){\n                this.edit_node_end();\n            }\n            this.editing_node = node;\n            var view_data = node._data.view;\n            var element = view_data.element;\n            var topic = node.topic;\n            var ncs = getComputedStyle(element);\n            this.e_editor.value = topic;\n            this.e_editor.style.width = (element.clientWidth-parseInt(ncs.getPropertyValue('padding-left'))-parseInt(ncs.getPropertyValue('padding-right')))+'px';\n            element.innerHTML = '';\n            element.appendChild(this.e_editor);\n            element.style.zIndex = 5;\n            this.e_editor.focus();\n            this.e_editor.select();\n        },\n\n        edit_node_end:function(){\n            if(this.editing_node != null){\n                var node = this.editing_node;\n                this.editing_node = null;\n                var view_data = node._data.view;\n                var element = view_data.element;\n                var topic = this.e_editor.value;\n                element.style.zIndex = 'auto';\n                element.removeChild(this.e_editor);\n                if(jm.util.text.is_empty(topic) || node.topic === topic){\n                    if(this.opts.support_html){\n                        $h(element,node.topic);\n                    }else{\n                        $t(element,node.topic);\n                    }\n                }else{\n                    this.jm.update_node(node.id,topic);\n                }\n            }\n        },\n\n        get_view_offset:function(){\n            var bounds = this.layout.bounds;\n            var _x = (this.size.w - bounds.e - bounds.w)/2;\n            var _y = this.size.h / 2;\n            return{x:_x, y:_y};\n        },\n\n        resize:function(){\n            this.e_canvas.width = 1;\n            this.e_canvas.height = 1;\n            this.e_nodes.style.width = '1px';\n            this.e_nodes.style.height = '1px';\n\n            this.expand_size();\n            this._show();\n        },\n\n        _show:function(){\n            this.e_canvas.width = this.size.w;\n            this.e_canvas.height = this.size.h;\n            this.e_nodes.style.width = this.size.w+'px';\n            this.e_nodes.style.height = this.size.h+'px';\n            this.show_nodes();\n            this.show_lines();\n            //this.layout.cache_valid = true;\n            this.jm.invoke_event_handle(jm.event_type.resize,{data:[]});\n        },\n\n        zoomIn: function() {\n            return this.setZoom(this.actualZoom + this.zoomStep);\n        },\n\n        zoomOut: function() {\n            return this.setZoom(this.actualZoom - this.zoomStep);\n        },\n\n        setZoom: function(zoom) {\n            if ((zoom < this.minZoom) || (zoom > this.maxZoom)) {\n                return false;\n            }\n            this.actualZoom = zoom;\n            for (var i=0; i < this.e_panel.children.length; i++) {\n                this.e_panel.children[i].style.transform = 'scale(' + zoom + ')';\n            };\n            this.show(true);\n            return true;\n\n        },\n\n        _center_root:function(){\n            // center root node\n            var outer_w = this.e_panel.clientWidth;\n            var outer_h = this.e_panel.clientHeight;\n            if(this.size.w > outer_w){\n                var _offset = this.get_view_offset();\n                this.e_panel.scrollLeft = _offset.x - outer_w/2;\n            }\n            if(this.size.h > outer_h){\n                this.e_panel.scrollTop = (this.size.h - outer_h)/2;\n            }\n        },\n\n        show:function(keep_center){\n            logger.debug('view.show');\n            this.expand_size();\n            this._show();\n            if(!!keep_center){\n                this._center_root();\n            }\n        },\n\n        relayout:function(){\n            this.expand_size();\n            this._show();\n        },\n\n        save_location:function(node){\n            var vd = node._data.view;\n            vd._saved_location={\n                x:parseInt(vd.element.style.left)-this.e_panel.scrollLeft,\n                y:parseInt(vd.element.style.top)-this.e_panel.scrollTop,\n            };\n        },\n\n        restore_location:function(node){\n            var vd = node._data.view;\n            this.e_panel.scrollLeft = parseInt(vd.element.style.left)-vd._saved_location.x;\n            this.e_panel.scrollTop = parseInt(vd.element.style.top)-vd._saved_location.y;\n        },\n\n        clear_nodes:function(){\n            var mind = this.jm.mind;\n            if(mind == null){\n                return;\n            }\n            var nodes = mind.nodes;\n            var node = null;\n            for(var nodeid in nodes){\n                node = nodes[nodeid];\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n            this.e_nodes.innerHTML = '';\n        },\n\n        show_nodes:function(){\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var node_element = null;\n            var expander = null;\n            var p = null;\n            var p_expander= null;\n            var expander_text = '-';\n            var view_data = null;\n            var _offset = this.get_view_offset();\n            for(var nodeid in nodes){\n                node = nodes[nodeid];\n                view_data = node._data.view;\n                node_element = view_data.element;\n                expander = view_data.expander;\n                if(!this.layout.is_visible(node)){\n                    node_element.style.display = 'none';\n                    expander.style.display = 'none';\n                    continue;\n                }\n                this.reset_node_custom_style(node);\n                p = this.layout.get_node_point(node);\n                view_data.abs_x = _offset.x + p.x;\n                view_data.abs_y = _offset.y + p.y;\n                node_element.style.left = (_offset.x+p.x) + 'px';\n                node_element.style.top = (_offset.y+p.y) + 'px';\n                node_element.style.display = '';\n                node_element.style.visibility = 'visible';\n                if(!node.isroot && node.children.length>0){\n                    expander_text = node.expanded?'-':'+';\n                    p_expander= this.layout.get_expander_point(node);\n                    expander.style.left = (_offset.x + p_expander.x) + 'px';\n                    expander.style.top = (_offset.y + p_expander.y) + 'px';\n                    expander.style.display = '';\n                    expander.style.visibility = 'visible';\n                    $t(expander,expander_text);\n                }\n                // hide expander while all children have been removed\n                if(!node.isroot && node.children.length==0){\n                    expander.style.display = 'none';\n                    expander.style.visibility = 'hidden';\n                }\n            }\n        },\n\n        reset_node_custom_style:function(node){\n            this._reset_node_custom_style(node._data.view.element, node.data);\n        },\n\n        _reset_node_custom_style:function(node_element, node_data){\n            if('background-color' in node_data){\n                node_element.style.backgroundColor = node_data['background-color'];\n            }\n            if('foreground-color' in node_data){\n                node_element.style.color = node_data['foreground-color'];\n            }\n            if('width' in node_data){\n                node_element.style.width = node_data['width']+'px';\n            }\n            if('height' in node_data){\n                node_element.style.height = node_data['height']+'px';\n            }\n            if('font-size' in node_data){\n                node_element.style.fontSize = node_data['font-size']+'px';\n            }\n            if('font-weight' in node_data){\n                node_element.style.fontWeight = node_data['font-weight'];\n            }\n            if('font-style' in node_data){\n                node_element.style.fontStyle = node_data['font-style'];\n            }\n            if('background-image' in node_data) {\n                var backgroundImage = node_data['background-image'];\n                if (backgroundImage.startsWith('data') && node_data['width'] && node_data['height']) {\n                    var img = new Image();\n\n                    img.onload = function() {\n                        var c = $c('canvas');\n                        c.width = node_element.clientWidth;\n                        c.height = node_element.clientHeight;\n                        var img = this;\n                        if(c.getContext) {\n                            var ctx = c.getContext('2d');\n                            ctx.drawImage(img, 2, 2, node_element.clientWidth, node_element.clientHeight);\n                            var scaledImageData = c.toDataURL();\n                            node_element.style.backgroundImage='url('+scaledImageData+')';\n                        }\n                    };\n                    img.src = backgroundImage;\n\n                } else {\n                    node_element.style.backgroundImage='url('+backgroundImage+')';\n                }\n                node_element.style.backgroundSize='99%';\n\n                if('background-rotation' in node_data){\n                    node_element.style.transform = 'rotate(' + node_data['background-rotation'] + 'deg)';\n                }\n\n            }\n        },\n\n        clear_node_custom_style:function(node){\n            var node_element = node._data.view.element;\n            node_element.style.backgroundColor = \"\";\n            node_element.style.color = \"\";\n        },\n\n        clear_lines:function(canvas_ctx){\n            var ctx = canvas_ctx || this.canvas_ctx;\n            jm.util.canvas.clear(ctx,0,0,this.size.w,this.size.h);\n        },\n\n        show_lines:function(canvas_ctx){\n            this.clear_lines(canvas_ctx);\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pin = null;\n            var pout = null;\n            var _offset = this.get_view_offset();\n            for(var nodeid in nodes){\n                node = nodes[nodeid];\n                if(!!node.isroot){continue;}\n                if(('visible' in node._data.layout) && !node._data.layout.visible){continue;}\n                pin = this.layout.get_node_point_in(node);\n                pout = this.layout.get_node_point_out(node.parent);\n                this.draw_line(pout,pin,_offset,canvas_ctx);\n            }\n        },\n\n        draw_line:function(pin,pout,offset,canvas_ctx){\n            var ctx = canvas_ctx || this.canvas_ctx;\n            ctx.strokeStyle = this.opts.line_color;\n            ctx.lineWidth = this.opts.line_width;\n            ctx.lineCap = 'round';\n\n            jm.util.canvas.bezierto(\n                ctx,\n                pin.x + offset.x,\n                pin.y + offset.y,\n                pout.x + offset.x,\n                pout.y + offset.y);\n        },\n    };\n\n    // shortcut provider\n    jm.shortcut_provider= function(jm, options){\n        this.jm = jm;\n        this.opts = options;\n        this.mapping = options.mapping;\n        this.handles = options.handles;\n        this._mapping = {};\n    };\n\n    jm.shortcut_provider.prototype = {\n        init : function(){\n            jm.util.dom.add_event($d,'keydown',this.handler.bind(this));\n\n            this.handles['addchild'] = this.handle_addchild;\n            this.handles['addbrother'] = this.handle_addbrother;\n            this.handles['editnode'] = this.handle_editnode;\n            this.handles['delnode'] = this.handle_delnode;\n            this.handles['toggle'] = this.handle_toggle;\n            this.handles['up'] = this.handle_up;\n            this.handles['down'] = this.handle_down;\n            this.handles['left'] = this.handle_left;\n            this.handles['right'] = this.handle_right;\n\n            for(var handle in this.mapping){\n                if(!!this.mapping[handle] && (handle in this.handles)){\n                    this._mapping[this.mapping[handle]] = this.handles[handle];\n                }\n            }\n        },\n\n        enable_shortcut : function(){\n            this.opts.enable = true;\n        },\n\n        disable_shortcut : function(){\n            this.opts.enable = false;\n        },\n\n        handler : function(e){\n            if(this.jm.view.is_editing()){return;}\n            var evt = e || event;\n            if(!this.opts.enable){return true;}\n            var kc = evt.keyCode;\n            if(kc in this._mapping){\n                this._mapping[kc].call(this,this.jm,e);\n            }\n        },\n\n        handle_addchild: function(_jm,e){\n            var selected_node = _jm.get_selected_node();\n            if(!!selected_node){\n                var nodeid = jm.util.uuid.newid();\n                var node = _jm.add_node(selected_node, nodeid, 'New Node');\n                if(!!node){\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_addbrother:function(_jm,e){\n            var selected_node = _jm.get_selected_node();\n            if(!!selected_node && !selected_node.isroot){\n                var nodeid = jm.util.uuid.newid();\n                var node = _jm.insert_node_after(selected_node, nodeid, 'New Node');\n                if(!!node){\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_editnode:function(_jm,e){\n            var selected_node = _jm.get_selected_node();\n            if(!!selected_node){\n                _jm.begin_edit(selected_node);\n            }\n        },\n        handle_delnode:function(_jm,e){\n            var selected_node = _jm.get_selected_node();\n            if(!!selected_node && !selected_node.isroot){\n                _jm.select_node(selected_node.parent);\n                _jm.remove_node(selected_node);\n            }\n        },\n        handle_toggle:function(_jm,e){\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if(!!selected_node){\n                _jm.toggle_node(selected_node.id);\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n        handle_up:function(_jm,e){\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if(!!selected_node){\n                var up_node = _jm.find_node_before(selected_node);\n                if(!up_node){\n                    var np = _jm.find_node_before(selected_node.parent);\n                    if(!!np && np.children.length > 0){\n                        up_node = np.children[np.children.length-1];\n                    }\n                }\n                if(!!up_node){\n                    _jm.select_node(up_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_down:function(_jm,e){\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if(!!selected_node){\n                var down_node = _jm.find_node_after(selected_node);\n                if(!down_node){\n                    var np = _jm.find_node_after(selected_node.parent);\n                    if(!!np && np.children.length > 0){\n                        down_node = np.children[0];\n                    }\n                }\n                if(!!down_node){\n                    _jm.select_node(down_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_left:function(_jm,e){\n            this._handle_direction(_jm,e,jm.direction.left);\n        },\n        handle_right:function(_jm,e){\n            this._handle_direction(_jm,e,jm.direction.right);\n        },\n        _handle_direction:function(_jm,e,d){\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            var node = null;\n            if(!!selected_node){\n                if(selected_node.isroot){\n                    var c = selected_node.children;\n                    var children = [];\n                    for(var i=0;i<c.length;i++){\n                        if(c[i].direction === d){\n                            children.push(i)\n                        }\n                    }\n                    node = c[children[Math.floor((children.length-1)/2)]];\n                }\n                else if(selected_node.direction === d){\n                    var children = selected_node.children;\n                    var childrencount = children.length;\n                    if(childrencount > 0){\n                        node = children[Math.floor((childrencount-1)/2)]\n                    }\n                }else{\n                    node = selected_node.parent;\n                }\n                if(!!node){\n                    _jm.select_node(node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n    };\n\n\n    // plugin\n    jm.plugin = function(name,init){\n        this.name = name;\n        this.init = init;\n    };\n\n    jm.plugins = [];\n\n    jm.register_plugin = function(plugin){\n        if(plugin instanceof jm.plugin){\n            jm.plugins.push(plugin);\n        }\n    };\n\n    jm.init_plugins = function(sender){\n        $w.setTimeout(function(){\n            jm._init_plugins(sender);\n        },0);\n    };\n\n    jm._init_plugins = function(sender){\n        var l = jm.plugins.length;\n        var fn_init = null;\n        for(var i=0;i<l;i++){\n            fn_init = jm.plugins[i].init;\n            if(typeof fn_init === 'function'){\n                fn_init(sender);\n            }\n        }\n    };\n\n    // quick way\n    jm.show = function(options,mind){\n        var _jm = new jm(options);\n        _jm.show(mind);\n        return _jm;\n    };\n\n    // register global variables\n    // $w[__name__] = jm;\n  return jm;\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/MindMap/jsmind/js/jsmind.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport ElementUI from 'element-ui'\nimport 'element-ui/lib/theme-default/index.css'\nimport App from './App'\nimport router from './router'\n\nVue.config.productionTip = false\n\nVue.use(ElementUI)\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  router,\n  template: '<App/>',\n  components: { App }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","/* eslint-disable camelcase */\nimport Vue from 'vue'\nimport Vuex from 'vuex'\n// import moment from 'moment'\n// import _ from 'lodash'\n\nimport io from 'socket.io-client'\n\nVue.use(Vuex)\n\nconst LOGIN = 'LOGIN'\nconst LOGIN_SUCCESS = 'LOGIN_SUCCESS'\nconst LOGOUT = 'LOGOUT'\n\nlet socket = null\n\nconst state = {\n  username: 'test_username', // TODO: should use real login function to replace with it\n  connection_status: false,\n  login_toggle: false,\n  is_logged_in: !!localStorage.getItem('token'),\n  login_pending: false,\n  token: '',\n  account: '',\n  message_history: []\n}\n\nconst mutations = {\n  TOGGLE_LOGIN_BOX (state, status) {\n    state.login_toggle = status\n  },\n\n  CHANGE_CONNECTION_STATUS (state, status) {\n    state.connection_status = status\n  },\n\n  [LOGIN] (state) {\n    state.login_pending = true\n  },\n\n  [LOGIN_SUCCESS] (state, username) {\n    state.is_logged_in = true\n    state.login_pending = false\n    state.username = username\n  },\n\n  [LOGOUT] (state) {\n    state.is_logged_in = false\n  },\n\n  PUT_MESSAGE (state, message) {\n    state.message_history.unshift(message)\n  },\n\n  CLICK_PLUS_ONE (state, id) {\n    let index = state.message_history.length - 1 - id\n    let click = 255 - 2 * (++state.message_history[index].clicks < 200 ? state.message_history[index].clicks : 200)\n    state.message_history[index].bg_color = 'rgb(' + click + ',' + click + ',' + click + ')'\n  }\n}\n\nconst actions = {\n  connect ({commit, state}) {\n    if (state.connection_status === false) {\n      socket = io('barrage.jtwang.me')\n      socket.on('connect', () => {\n        commit('CHANGE_CONNECTION_STATUS', true)\n      })\n    }\n\n    if (state.username === '') {\n      if (localStorage.getItem('token') !== null && localStorage.getItem('username') !== null) {\n        commit(LOGIN_SUCCESS, localStorage.getItem('username'))\n      }\n    }\n\n    socket.on('disconnect', () => {\n      commit('CHANGE_CONNECTION_STATUS', false)\n    })\n    socket.on('server_message', (message) => {\n      commit('PUT_MESSAGE', message)\n    })\n    // socket.on('update_contacts', (people) => {\n    //   console.log('HERE!!!!!!!!')\n    //   commit('CLEAR_CONTACTS')\n    //   _.forEach(people, (person) => { commit('ADD_CONTACT', person) })\n    //   commit('SET_CURRENT_WITH', state.contacts[0])// should check if 0 in production mode\n    // })\n  },\n\n  login ({commit}, {username, password}) {\n    commit(LOGIN)\n    // console.log('store: ', username, password)\n    socket.emit('login', {'username': username, 'password': password})\n    socket.on('login_success', () => {\n      localStorage.setItem('token', 'JWT')\n      localStorage.setItem('username', username)\n      commit(LOGIN_SUCCESS, username)\n    })\n  },\n\n  logout ({commit}) {\n    localStorage.removeItem('token')\n    commit(LOGOUT)\n  },\n\n  send_message ({commit, state}, content) {\n    // let time = moment().calendar()\n    let index = state.message_history.length\n    let complete_message = {id: index, content: content, clicks: 0, bg_color: 'rgb(255,255,255)'}\n    socket.emit('client_message', complete_message)\n    commit('PUT_MESSAGE', complete_message)\n  },\n\n  click_plus ({commit, state}, id) {\n    commit('CLICK_PLUS_ONE', id)\n  }\n}\n\nexport default new Vuex.Store({\n  state: state,\n  mutations: mutations,\n  actions: actions,\n  getters: {\n    connection_status () {\n      return state.connection_status\n    },\n    is_logged_in () {\n      return state.is_logged_in\n    },\n    login_pending () {\n      return state.login_pending\n    },\n    username () {\n      return state.username\n    },\n    message_history () {\n      return state.message_history\n    }\n  },\n\n  strict: process.env.NODE_ENV !== 'production'\n})\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/vuex/store.js","<template>\n  <div id=\"app\">\n    <!--<img src=\"./assets/logo.png\">-->\n    <router-view></router-view>\n  </div>\n</template>\n\n<script>\n  import store from './vuex/store'\nexport default {\n    name: 'app', store: store\n}\n</script>\n\n<style>\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// App.vue?ba59f0fe","<template>\n  <div id=\"barrage_wrapper\">\n    <ul id=\"messages\">\n      <li v-for=\"message in message_history\" v-bind:style=\"{backgroundColor: message.bg_color}\" @click=\"clickPlusOne(message.id)\">{{ message.content }}</li>\n    </ul>\n    <form action=\"\">\n      <textarea v-model=\"message_content\" @keydown.enter=\"send\" @keyup.enter=\"clear\" name=\"message-to-send\" id=\"message-to-send\" placeholder =\"\" rows=\"3\"></textarea>\n    </form>\n  </div>\n</template>\n\n<script>\n  import { mapGetters } from 'vuex'\n\n  export default {\n    name: 'barrage',\n    data () {\n      return {\n        message_content: ''\n      }\n    },\n    computed: {\n      ...mapGetters([\n        'message_history'\n      ])\n    },\n\n    methods: {\n      clear () {\n        if (this.message_content.trim() === '') {\n          this.message_content = ''\n        }\n      },\n\n      send () {\n        if (this.message_content.trim() === '') {\n          this.message_content = ''\n          return\n        } else {\n          this.message_content = this.message_content.trim()\n          this.$store.dispatch('send_message', this.message_content)\n          this.message_content = ''\n        }\n      },\n\n      clickPlusOne (id) {\n        this.$store.dispatch('click_plus', id)\n      }\n    },\n    mounted () {\n      this.$store.dispatch('connect')\n    }\n  }\n</script>\n\n<style>\n  * { margin: 0; padding: 0; box-sizing: border-box; }\n  body { font: 13px Helvetica, Arial; }\n  #barrage_wrapper {}\n  form { background: #000; padding: 3px; position: fixed; bottom: 0; width: 100%; }\n  form textarea { border: 0; padding: 10px; width: 90%; margin-right: .5%; resize: none; }\n  form button { width: 9%; background: rgb(130, 224, 255); border: none; padding: 10px; }\n  #messages { list-style-type: none; margin: 0; padding: 0; }\n  #messages li { padding: 5px 10px; }\n  #messages li:nth-child(odd) { background: #eee; }\n  #messages { margin-bottom: 40px }\n\n\n  /*textarea {*/\n    /*width: 90%;*/\n    /*border: none;*/\n    /*padding: 10px 20px;*/\n    /*font: 14px/22px \"Lato\", Arial, sans-serif;*/\n    /*margin-bottom: 10px;*/\n    /*border-radius: 5px;*/\n    /*resize: none;*/\n  /*}*/\n</style>\n\n\n\n// WEBPACK FOOTER //\n// Barrage.vue?60ba1838","<template>\n  <div class=\"hello\">\n    <h1>{{ msg }}</h1>\n    <h2>Essential Links</h2>\n    <ul>\n      <li><a href=\"https://vuejs.org\" target=\"_blank\">Core Docs</a></li>\n      <li><a href=\"https://forum.vuejs.org\" target=\"_blank\">Forum</a></li>\n      <li><a href=\"https://gitter.im/vuejs/vue\" target=\"_blank\">Gitter Chat</a></li>\n      <li><a href=\"https://twitter.com/vuejs\" target=\"_blank\">Twitter</a></li>\n      <br>\n      <li><a href=\"http://vuejs-templates.github.io/webpack/\" target=\"_blank\">Docs for This Template</a></li>\n    </ul>\n    <h2>Ecosystem</h2>\n    <ul>\n      <li><a href=\"http://router.vuejs.org/\" target=\"_blank\">vue-router</a></li>\n      <li><a href=\"http://vuex.vuejs.org/\" target=\"_blank\">vuex</a></li>\n      <li><a href=\"http://vue-loader.vuejs.org/\" target=\"_blank\">vue-loader</a></li>\n      <li><a href=\"https://github.com/vuejs/awesome-vue\" target=\"_blank\">awesome-vue</a></li>\n    </ul>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'hello',\n  data () {\n    return {\n      msg: 'Welcome to Your Vue.js App'\n    }\n  }\n}\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh1, h2 {\n  font-weight: normal;\n}\n\nul {\n  list-style-type: none;\n  padding: 0;\n}\n\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\n\na {\n  color: #42b983;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// Hello.vue?8b4cb386","<template>\n  <div>\n    <el-row class=\"tac\">\n      <el-col :span=\"3\">\n        <sidebar></sidebar>\n      </el-col>\n      <el-col :span=\"18\">\n        <div id=\"jsmind_container\"></div>\n      </el-col>\n      <el-col :span=\"3\">\n        <barrage></barrage>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\n  /* eslint-disable new-cap */\n\n  import './MindMap/jsmind/style/jsmind.css'\n  import jsMind from './MindMap/jsmind/js/jsmind.js'\n  import jsMindDraggable from './MindMap/jsmind/js/jsmind.draggable.js'\n\n  import Sidebar from './Sidebar.vue'\n  import Barrage from './Barrage.vue'\n\n//  import _ from 'lodash'\n\n  let teacherList = ['teacher1', 'teacher2']\n  let studentList = ['student1', 'student2', 'student3']\n\n  export default {\n    name: 'mind-map',\n    components: {\n      Sidebar,\n      Barrage\n    },\n    data () {\n      return {\n        sidebarShow: true,\n        isTeacher: true,\n        teacherList: teacherList,\n        studentList: studentList,\n        jm: null\n      }\n    },\n    mounted () {\n      jsMindDraggable(jsMind)\n\n      let mind = {\n        /*  */\n        'meta': {\n          'name': 'jsMind-demo-tree',\n          'author': 'hizzgdev@163.com',\n          'version': '0.2'\n        },\n        /*  */\n        'format': 'node_tree',\n        /*  */\n        'data': {'id': 'root',\n          'topic': 'jsMind',\n          'children': [\n            {'id': 'easy',\n              'topic': 'Easy',\n              'direction': 'left',\n              'expanded': false,\n              'children': [\n                {'id': 'easy1', 'topic': 'Easy to show'},\n                {'id': 'easy2', 'topic': 'Easy to edit'},\n                {'id': 'easy3', 'topic': 'Easy to store'},\n                {'id': 'easy4', 'topic': 'Easy to embed'}\n              ]},\n            {'id': 'open',\n              'topic': 'Open Source',\n              'direction': 'right',\n              'expanded': true,\n              'children': [\n                {'id': 'open1', 'topic': 'on GitHub'},\n                {'id': 'open2', 'topic': 'BSD License'}\n              ]},\n            {'id': 'powerful',\n              'topic': 'Powerful',\n              'direction': 'right',\n              'children': [\n                {'id': 'powerful1', 'topic': 'Base on Javascript'},\n                {'id': 'powerful2', 'topic': 'Base on HTML5'},\n                {'id': 'powerful3', 'topic': 'Depends on you'}\n              ]},\n            {'id': 'other',\n              'topic': 'test node',\n              'direction': 'left',\n              'children': [\n                {'id': 'other1', 'topic': \"I'm from local variable\"},\n                {'id': 'other2', 'topic': 'I can do everything'}\n              ]}\n          ]}\n      }\n\n      let options = {\n        container: 'jsmind_container',\n        editable: true,\n        theme: 'orange'\n      }\n\n      let that = this\n      that.jm = new jsMind(options)\n      that.jm.show(mind)\n      /* below are the canvas contextmenu configuration */\n      let $menu = $('#contextMenu')\n      $menu.on('click', 'li', function (e) {\n        // hide the context menu\n        $menu.hide()\n        console.log('Context selection: ' + $(this).text())\n        that.sidebarShow = !that.sidebarShow\n      })\n    }\n  }\n\n</script>\n<style>\n  #contextMenu{position:absolute;}\n  #contextMenu{\n    border:1px solid green;\n    background:white;\n    list-style:none;\n    padding:3px;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// MindMap.vue?16fdc5c0","<template>\n  <el-menu default-active=\"2\" class=\"sidebar\">\n    <el-submenu index=\"1\">\n      <template slot=\"title\"><i class=\"el-icon-message\"></i></template>\n      <el-menu-item-group>\n        <template slot=\"title\"></template>\n        <el-menu-item index=\"1-1\">1</el-menu-item>\n        <el-menu-item index=\"1-2\">2</el-menu-item>\n      </el-menu-item-group>\n      <el-menu-item-group title=\"2\">\n        <el-menu-item index=\"1-3\">3</el-menu-item>\n      </el-menu-item-group>\n      <el-submenu index=\"1-4\">\n        <template slot=\"title\">4</template>\n        <el-menu-item index=\"1-4-1\">1</el-menu-item>\n      </el-submenu>\n    </el-submenu>\n    <el-menu-item index=\"2\"><i class=\"el-icon-menu\"></i></el-menu-item>\n    <el-menu-item index=\"3\"><i class=\"el-icon-setting\"></i></el-menu-item>\n  </el-menu>\n</template>\n\n<script>\n  export default {\n    name: 'sidebar'\n  }\n</script>\n<style>\n  .sidebar {\n    min-height: 100%;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// Sidebar.vue?6a4f1620","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-740f840a\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Barrage.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Barrage.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-740f840a\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Barrage.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Barrage.vue\n// module id = 214\n// module chunks = 1","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-2cab8cad\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Hello.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Hello.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2cab8cad\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Hello.vue\"),\n  /* scopeId */\n  \"data-v-2cab8cad\",\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Hello.vue\n// module id = 215\n// module chunks = 1","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-b9d2da76\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./MindMap.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./MindMap.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-b9d2da76\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./MindMap.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/MindMap.vue\n// module id = 216\n// module chunks = 1","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-14a6a577\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Sidebar.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Sidebar.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-14a6a577\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Sidebar.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Sidebar.vue\n// module id = 217\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('el-menu', {\n    staticClass: \"sidebar\",\n    attrs: {\n      \"default-active\": \"2\"\n    }\n  }, [_c('el-submenu', {\n    attrs: {\n      \"index\": \"1\"\n    }\n  }, [_c('template', {\n    slot: \"title\"\n  }, [_c('i', {\n    staticClass: \"el-icon-message\"\n  }), _vm._v(\"\")]), _vm._v(\" \"), _c('el-menu-item-group', [_c('template', {\n    slot: \"title\"\n  }, [_vm._v(\"\")]), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"1-1\"\n    }\n  }, [_vm._v(\"1\")]), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"1-2\"\n    }\n  }, [_vm._v(\"2\")])], 2), _vm._v(\" \"), _c('el-menu-item-group', {\n    attrs: {\n      \"title\": \"2\"\n    }\n  }, [_c('el-menu-item', {\n    attrs: {\n      \"index\": \"1-3\"\n    }\n  }, [_vm._v(\"3\")])], 1), _vm._v(\" \"), _c('el-submenu', {\n    attrs: {\n      \"index\": \"1-4\"\n    }\n  }, [_c('template', {\n    slot: \"title\"\n  }, [_vm._v(\"4\")]), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"1-4-1\"\n    }\n  }, [_vm._v(\"1\")])], 2)], 2), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"2\"\n    }\n  }, [_c('i', {\n    staticClass: \"el-icon-menu\"\n  }), _vm._v(\"\")]), _vm._v(\" \"), _c('el-menu-item', {\n    attrs: {\n      \"index\": \"3\"\n    }\n  }, [_c('i', {\n    staticClass: \"el-icon-setting\"\n  }), _vm._v(\"\")])], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-14a6a577\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Sidebar.vue\n// module id = 218\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"hello\"\n  }, [_c('h1', [_vm._v(_vm._s(_vm.msg))]), _vm._v(\" \"), _c('h2', [_vm._v(\"Essential Links\")]), _vm._v(\" \"), _vm._m(0), _vm._v(\" \"), _c('h2', [_vm._v(\"Ecosystem\")]), _vm._v(\" \"), _vm._m(1)])\n},staticRenderFns: [function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', [_c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://vuejs.org\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Core Docs\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://forum.vuejs.org\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Forum\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://gitter.im/vuejs/vue\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Gitter Chat\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://twitter.com/vuejs\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Twitter\")])]), _vm._v(\" \"), _c('br'), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vuejs-templates.github.io/webpack/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"Docs for This Template\")])])])\n},function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('ul', [_c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://router.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vue-router\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vuex.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vuex\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"http://vue-loader.vuejs.org/\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"vue-loader\")])]), _vm._v(\" \"), _c('li', [_c('a', {\n    attrs: {\n      \"href\": \"https://github.com/vuejs/awesome-vue\",\n      \"target\": \"_blank\"\n    }\n  }, [_vm._v(\"awesome-vue\")])])])\n}]}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-2cab8cad\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Hello.vue\n// module id = 219\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [_c('router-view')], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-4506cf06\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = 220\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"barrage_wrapper\"\n    }\n  }, [_c('ul', {\n    attrs: {\n      \"id\": \"messages\"\n    }\n  }, _vm._l((_vm.message_history), function(message) {\n    return _c('li', {\n      style: ({\n        backgroundColor: message.bg_color\n      }),\n      on: {\n        \"click\": function($event) {\n          _vm.clickPlusOne(message.id)\n        }\n      }\n    }, [_vm._v(_vm._s(message.content))])\n  })), _vm._v(\" \"), _c('form', {\n    attrs: {\n      \"action\": \"\"\n    }\n  }, [_c('textarea', {\n    directives: [{\n      name: \"model\",\n      rawName: \"v-model\",\n      value: (_vm.message_content),\n      expression: \"message_content\"\n    }],\n    attrs: {\n      \"name\": \"message-to-send\",\n      \"id\": \"message-to-send\",\n      \"placeholder\": \"\",\n      \"rows\": \"3\"\n    },\n    domProps: {\n      \"value\": (_vm.message_content)\n    },\n    on: {\n      \"keydown\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.send($event)\n      },\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.clear($event)\n      },\n      \"input\": function($event) {\n        if ($event.target.composing) { return; }\n        _vm.message_content = $event.target.value\n      }\n    }\n  })])])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-740f840a\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Barrage.vue\n// module id = 221\n// module chunks = 1","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_c('el-row', {\n    staticClass: \"tac\"\n  }, [_c('el-col', {\n    attrs: {\n      \"span\": 3\n    }\n  }, [_c('sidebar')], 1), _vm._v(\" \"), _c('el-col', {\n    attrs: {\n      \"span\": 18\n    }\n  }, [_c('div', {\n    attrs: {\n      \"id\": \"jsmind_container\"\n    }\n  })]), _vm._v(\" \"), _c('el-col', {\n    attrs: {\n      \"span\": 3\n    }\n  }, [_c('barrage')], 1)], 1)], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-b9d2da76\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/MindMap.vue\n// module id = 222\n// module chunks = 1","import Vue from 'vue'\nimport Router from 'vue-router'\nimport Hello from '@/components/Hello'\nimport MindMap from '@/components/MindMap'\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: '/',\n      name: 'Hello',\n      component: Hello\n    },\n    {\n      path: '/mindmap',\n      name: 'MindMap',\n      component: MindMap\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","\n/* styles */\nrequire(\"!!../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"id\\\":\\\"data-v-4506cf06\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n\nvar Component = require(\"!../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"),\n  /* template */\n  require(\"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4506cf06\\\"}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = 91\n// module chunks = 1"],"sourceRoot":""}